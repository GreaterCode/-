{
	"ID": "20230602191128-kn94x2f",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20230602191128-kn94x2f",
		"title": "smart",
		"updated": "20230602192210"
	},
	"Children": [
		{
			"ID": "20230602191128-3ho0j6q",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20230602191128-3ho0j6q",
				"updated": "20230602191144"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1. 概述"
				}
			]
		},
		{
			"ID": "20230602191144-dfzldi0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230602191144-dfzldi0",
				"updated": "20230602191159"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t随着硬盘容量、速度的快速发展，硬盘的可靠性问题越来越重要，今天的单块硬盘存储容量可轻松达到1TB，硬盘损坏带来的影响非常巨大。\n不同的文件系统(xfs,reiserfs,ext3)都有自己的检测和修复工具。检测之前可以先使用dmesg命令查看有没有硬件I/O故障的日志，如果有，先用fsck看看是不是文件系统有问题，如果不是则可以使用下面介绍硬盘检测和优化方法来修复它。 grep\"error\"/va/log/messages*;"
				}
			]
		},
		{
			"ID": "20230602191202-1ywlwna",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20230602191202-1ywlwna",
				"updated": "20230602191209"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2. "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "Linux检测硬盘坏道"
				}
			]
		},
		{
			"ID": "20230602191207-cxneph3",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230602191207-cxneph3",
				"updated": "20230602191912"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1 使用SMART检测硬盘"
				}
			]
		},
		{
			"ID": "20230602191920-s05ykmz",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230602191920-s05ykmz",
				"updated": "20230602191920"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tSMART是一种磁盘自我分析检测技术，早在90年代末就基本得到了普及每一块硬盘（包括IDE、SCSI），在运行的时候都会将自身的若干参数记录下来，这些参数包括型号、容量、温度、密度、扇区、寻道时间、传输、误码率等。硬盘运行了几千小时后，很多内在的物理参数都会发生变化，某一参数超过报警阈值，则说明硬盘接近损坏，此时硬盘依然在工作，如果用户不理睬这个报警继续使用，那么硬盘将变得非常不可靠，随时可能故障。"
				}
			]
		},
		{
			"ID": "20230602191923-bff3y20",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230602191923-bff3y20",
				"updated": "20230602191940"
			},
			"Children": [
				{
					"ID": "20230602191940-5h9b8tl",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230602191940-5h9b8tl",
						"updated": "20230602191940"
					},
					"Children": [
						{
							"ID": "20230602191940-kfiws68",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230602191940-kfiws68",
								"updated": "20230602191940"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": " 启用SMART"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230602191948-psgyjzx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230602191948-psgyjzx",
				"updated": "20230602191949"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tSMART是和主板BIOS上相应功能配合的，要使用SMART，必须先进入到主板BIOS设置里边启动相关设置。一般从Pentium2级别起的主板，都支持SMART，BIOS启动以后，就是操作系统级别的事情了（Windows没有内置SMART相关工具,需要安装第三方工具软件)，好在Linux上很早就有了SMART支持了,如果把Linux装在VMware等虚拟机上，在系统启动时候可以看到有个服务启动报错：smartd。这个服务器就是smart的daemon进程（因为vmware虚拟机的硬盘不支持SMART，所以报错）。smartd是一个守护进程（一个帮助程序）,它能监视拥有自我监视,分析和汇报技术(Self-Monitoring, Analysis, and Reporting Technology - SMART)的硬盘。SMART体系使得硬盘能监视并汇报自己的运行状况.它的一个重要特性是能够预测失败,使得系统管理员能避免数据丢失。"
				}
			]
		},
		{
			"ID": "20230602191952-99h8ltb",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230602191952-99h8ltb",
				"updated": "20230602192050"
			},
			"Children": [
				{
					"ID": "20230602191955-pyj2u2n",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230602191955-pyj2u2n",
						"updated": "20230602192050"
					},
					"Children": [
						{
							"ID": "20230602191955-pm188p1",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230602191955-pm188p1",
								"updated": "20230602192000"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "smartctl简单用法"
								}
							]
						},
						{
							"ID": "20230602192001-fvroxnr",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20230602192001-fvroxnr",
								"updated": "20230602192050"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker"
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "smartctl -a \u003cdevice\u003e 检查该设备是否已经打开SMART技术。 \nsmartctl -s on \u003cdevice\u003e 如果没有打开SMART技术，使用该命令打开SMART技术。 \nsmartctl -t short \u003cdevice\u003e 后台检测硬盘，消耗时间短； \nsmartctl -t long \u003cdevice\u003e 后台检测硬盘，消耗时间长；\nsmartctl -C -t short \u003cdevice\u003e 前台检测硬盘，消耗时间短；\nsmartctl -C -t long \u003cdevice\u003e 前台检测硬盘，消耗时间长。其实就是利用硬盘SMART的自检程序。 \nsmartctl -X \u003cdevice\u003e 中断后台检测硬盘。\nsmartctl -l selftest \u003cdevice\u003e 显示硬盘检测日志。 \nsmartctl -l error \u003cdevice\u003e 显示硬盘错误汇总。\n首先通过dmesg工具，确认一下硬盘的设备符号。例如一个IDE硬盘连接到Primary IDE 总线上的Slave位置，硬盘设备符号是/dev/hdb，hdb中的h代表IDE，如果显示为sdb，则代表SATA和SCSI，最后一个字幕b代表Primary总线，第二块硬盘即Slave位置，确认硬盘是否打开了SMART支持：\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230602192204-0mjqhgf",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230602192204-0mjqhgf",
				"updated": "20230602192210"
			},
			"Children": [
				{
					"ID": "20230602192208-sedalus",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230602192208-sedalus",
						"updated": "20230602192210"
					},
					"Children": [
						{
							"ID": "20230602192208-nguu9rw",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230602192208-nguu9rw",
								"updated": "20230602192210"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "使用案例"
								}
							]
						},
						{
							"ID": "20230602192210-4p59gch",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20230602192210-4p59gch",
								"updated": "20230602192226"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker"
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "# smartctl -i /dev/sda\nsmartctl 5.40 2010-10-16 r3189 [i386-redhat-linux-gnu] (local build)\nCopyright (C) 2002-10 by Bruce Allen, http://smartmontools.sourceforge.net\n\n=== START OF INFORMATION SECTION ===\nDevice Model:     HITACHI HTS543225L9SA00\nSerial Number:    090131FB2F32YLG28JEA\nFirmware Version: FBEZC48C\nUser Capacity:    250,059,350,016 bytes\nDevice is:        Not in smartctl database [for details use: -P showall]\nATA Version is:   8\nATA Standard is:  ATA-8-ACS revision 3f\nLocal Time is:    Wed May 25 10:10:39 2011 CST\nSMART support is: Available - device has SMART capability.\nSMART support is: Enabled                          //表示启用了smart支持 \n如果看到SMART support is: Disabled表示SMART未启用，执行如下命令，启动SMART\n\n# smartctl --smart=on --offlineauto=on --saveauto=on /dev/sda\nsmartctl 5.40 2010-10-16 r3189 [i386-redhat-linux-gnu] (local build)\nCopyright (C) 2002-10 by Bruce Allen, http://smartmontools.sourceforge.net\n\n=== START OF ENABLE/DISABLE COMMANDS SECTION ===\nSMART Enabled.\nSMART Attribute Autosave Enabled.\nSMART Automatic Offline Testing Enabled every four hours.\n\n现在硬盘的SMART功能已经被打开，执行如下命令查看硬盘的健康状况\n\n# smartctl -H /dev/sda\nsmartctl 5.40 2010-10-16 r3189 [i386-redhat-linux-gnu] (local build)\nCopyright (C) 2002-10 by Bruce Allen, http://smartmontools.sourceforge.net\n\n=== START OF READ SMART DATA SECTION ===\nSMART overall-health self-assessment test result: PASSED \n请注意result后边的结果：PASSED，这表示硬盘健康状态良好；如果这里显示FAILED，那么最好立刻给服务器更换硬盘。SMART只能报告磁盘已经不再健康，但是报警后还能继续运行多久是不确定的。通常，SMART报警参数是有预留的，磁盘报警后，不会当场坏掉，一般能坚持一段时间，有的硬盘SMART报警后还继续跑了好几年，有的硬盘SMART报错后几天就坏了。但是一旦出现报警，侥幸心里是万万不能的……\n#smartctl -A   /dev/sda  查看硬盘的详细信息 \n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				}
			]
		}
	]
}