{
	"ID": "20220816152203-lpptn29",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20220816152203-lpptn29",
		"scroll": "{\u0026quot;startId\u0026quot;:\u0026quot;20220816152203-ztko94p\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20230515232352-tv4m7ho\u0026quot;,\u0026quot;scrollTop\u0026quot;:1273,\u0026quot;focusId\u0026quot;:\u0026quot;20230515232231-vn46t9p\u0026quot;,\u0026quot;focusStart\u0026quot;:265,\u0026quot;focusEnd\u0026quot;:265}",
		"title": "nsenter",
		"updated": "20230515232354"
	},
	"Children": [
		{
			"ID": "20220816152203-ztko94p",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20220816152203-ztko94p",
				"updated": "20220816152626"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.简介"
				}
			]
		},
		{
			"ID": "20220816152634-fcw6icu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220816152634-fcw6icu",
				"updated": "20220816152634"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tnsenter命令是一个可以在指定进程的命令空间下运行指定程序的命令。它位于util-linux包中。"
				}
			]
		},
		{
			"ID": "20220816152634-2ynos3o",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20220816152634-2ynos3o",
				"updated": "20220816152656"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.安装"
				}
			]
		},
		{
			"ID": "20220816152252-wkw7gly",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220816152252-wkw7gly",
				"updated": "20220816152531"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t源码地址："
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://mirrors.edge.kernel.org/pub/linux/utils/util-linux/",
					"TextMarkTextContent": "https://mirrors.edge.kernel.org/pub/linux/utils/util-linux"
				}
			]
		},
		{
			"ID": "20220816153146-g6dbln7",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20220816153146-g6dbln7",
				"updated": "20220816153147"
			},
			"Children": [
				{
					"ID": "20220816153147-u2dqbuw",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816153147-u2dqbuw"
					},
					"Children": [
						{
							"ID": "20220816153147-vrma96k",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816153147-vrma96k"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "源码安装："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20220816153124-qj55qee",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20220816153124-qj55qee",
				"updated": "20220816153132"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Z28="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ wget https://www.kernel.org/pub/linux/utils/util-linux/v2.24/util-linux-2.24.tar.gz\n$ tar -xzvf util-linux-2.24.tar.gz\n$ cd util-linux-2.24/\n$ ./configure --without-ncurses\n$ make nsenter\n$ sudo cp nsenter /usr/local/bin\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20220816153120-3w06xqc",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20220816153120-3w06xqc",
				"updated": "20220816153159"
			},
			"Children": [
				{
					"ID": "20220816153156-2hxtgs4",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816153156-2hxtgs4",
						"updated": "20220816153159"
					},
					"Children": [
						{
							"ID": "20220816153156-fx39oga",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816153156-fx39oga",
								"updated": "20220816153159"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "yum安装"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20220816152243-iqy34cg",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20220816152243-iqy34cg",
				"updated": "20220816152243"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Z28="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "yum install util-linux -y"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20220816152224-m0tkltq",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20220816152224-m0tkltq",
				"updated": "20220816152712"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3. 原理"
				}
			]
		},
		{
			"ID": "20220816152727-vwk8811",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220816152727-vwk8811",
				"updated": "20220816152727"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "namespace是Linux中一些进程的属性的作用域，使用命名空间，可以隔离不同的进程。"
				}
			]
		},
		{
			"ID": "20220816152727-53c6q35",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220816152727-53c6q35",
				"updated": "20220816152727"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Linux在不断的添加命名空间，目前有："
				}
			]
		},
		{
			"ID": "20220816152727-vl4ycp5",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20220816152727-vl4ycp5",
				"updated": "20220816152727"
			},
			"Children": [
				{
					"ID": "20220816152727-frk3o34",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816152727-frk3o34"
					},
					"Children": [
						{
							"ID": "20220816152727-p9t634q",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816152727-p9t634q"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "mount：挂载命名空间，使进程有一个独立的挂载文件系统，始于Linux 2.4.19"
								}
							]
						}
					]
				},
				{
					"ID": "20220816152727-bqwxtfo",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816152727-bqwxtfo"
					},
					"Children": [
						{
							"ID": "20220816152727-nxrs5kf",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816152727-nxrs5kf"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "ipc：ipc命名空间，使进程有一个独立的ipc，包括消息队列，共享内存和信号量，始于Linux 2.6.19"
								}
							]
						}
					]
				},
				{
					"ID": "20220816152727-sn734o3",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816152727-sn734o3"
					},
					"Children": [
						{
							"ID": "20220816152727-avtqyhu",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816152727-avtqyhu"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "uts：uts命名空间，使进程有一个独立的hostname和domainname，始于Linux 2.6.19"
								}
							]
						}
					]
				},
				{
					"ID": "20220816152727-dafus88",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816152727-dafus88"
					},
					"Children": [
						{
							"ID": "20220816152727-q18mvb3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816152727-q18mvb3"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "net：network命令空间，使进程有一个独立的网络栈，始于Linux 2.6.24"
								}
							]
						}
					]
				},
				{
					"ID": "20220816152727-hbf3nvl",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816152727-hbf3nvl"
					},
					"Children": [
						{
							"ID": "20220816152727-o4c84nk",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816152727-o4c84nk"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "pid：pid命名空间，使进程有一个独立的pid空间，始于Linux 2.6.24"
								}
							]
						}
					]
				},
				{
					"ID": "20220816152727-ki11oeb",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816152727-ki11oeb"
					},
					"Children": [
						{
							"ID": "20220816152727-xbkw0gr",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816152727-xbkw0gr"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "user：user命名空间，是进程有一个独立的user空间，始于Linux 2.6.23，结束于Linux 3.8"
								}
							]
						}
					]
				},
				{
					"ID": "20220816152727-rk14wdz",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220816152727-rk14wdz"
					},
					"Children": [
						{
							"ID": "20220816152727-ns6vsee",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220816152727-ns6vsee"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "cgroup：cgroup命名空间，使进程有一个独立的cgroup控制组，始于Linux 4.6"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20220816152727-lefiw6f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220816152727-lefiw6f",
				"updated": "20220816152727"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Linux的每个进程都具有命名空间，可以在/proc/PID/ns目录中看到命名空间的文件描述符。"
				}
			]
		},
		{
			"ID": "20220816152609-899x3ac",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20220816152609-899x3ac",
				"updated": "20220816152739"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4. 基本使用"
				}
			]
		},
		{
			"ID": "20220816152543-3nnpbm0",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20220816152543-3nnpbm0",
				"updated": "20220816152548"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Z28="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "nsenter [options] [program [arguments]]\n\noptions:\n-t, --target pid：指定被进入命名空间的目标进程的pid\n-m, --mount[=file]：进入mount命令空间。如果指定了file，则进入file的命令空间\n-u, --uts[=file]：进入uts命令空间。如果指定了file，则进入file的命令空间\n-i, --ipc[=file]：进入ipc命令空间。如果指定了file，则进入file的命令空间\n-n, --net[=file]：进入net命令空间。如果指定了file，则进入file的命令空间\n-p, --pid[=file]：进入pid命令空间。如果指定了file，则进入file的命令空间\n-U, --user[=file]：进入user命令空间。如果指定了file，则进入file的命令空间\n-G, --setgid gid：设置运行程序的gid\n-S, --setuid uid：设置运行程序的uid\n-r, --root[=directory]：设置根目录\n-w, --wd[=directory]：设置工作目录\n\n如果没有给出program，则默认执行$SHELL。\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20220816152230-4unlyld",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20220816152230-4unlyld",
				"updated": "20230515232211"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5. 各种使用示例"
				}
			]
		},
		{
			"ID": "20230515232212-3bvliin",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230515232212-3bvliin",
				"updated": "20230515232222"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.1 docker"
				}
			]
		},
		{
			"ID": "20230515232231-vn46t9p",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230515232231-vn46t9p",
				"updated": "20230515232232"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl describe po xxx|grep 'Container ID’ // Container ID:  docker://32675b6981856985d87f8a5f1e2204e058a0d41f35ba39e946baea5ab478b612\n登录pod所在节点\ndocker inspect 32675b6981856985d87f8a5f1e2204e058a0d41f35ba39e946baea5ab478b612|grep \"NetworkMode\" // \"NetworkMode\": \"container:f32634b73e285ba8f70f3ed8a7a673bacc95b2be505bfc63e51447fe09d3ac88\",\ndocker inspect f32634b73e285ba8f70f3ed8a7a673bacc95b2be505bfc63e51447fe09d3ac88 |grep netns // \"SandboxKey\": \"/var/run/docker/netns/db22ae4487a0\",\nnsenter --net=\"/var/run/docker/netns/db22ae4487a0\" sh  // 至此进入了容器的网络命名空间，同时又可以使用宿主机的命令 \n使用完成后记得exit返回主机网络netns\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230515232159-m1rje0t",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230515232159-m1rje0t",
				"updated": "20230515232306"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.2 containerd"
				}
			]
		},
		{
			"ID": "20230515232315-yvkupsl",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230515232315-yvkupsl",
				"updated": "20230515232322"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "\nkubectl describe po xxx |grep 'Container ID' // Container ID:   containerd://8c4238f4336db782d3085ba859e2af32ae15c6e7c7b3642e3e8a0b5a198ab7d3\n登录pod所在节点\nctr --namespace k8s.io c  info 8c4238f4336db782d3085ba859e2af32ae15c6e7c7b3642e3e8a0b5a198ab7d3 |grep ns/net  // \"path\": \"/proc/67062/ns/net\"\nnsenter --net=\"/proc/67062/ns/net\" sh  // 至此进入了容器的网络命名空间，同时又可以使用宿主机的命令\n使用完成后记得exit返回主机网络netns\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230515232310-3lt26e4",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230515232310-3lt26e4",
				"updated": "20230515232342"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.3  crio"
				}
			]
		},
		{
			"ID": "20230515232352-tv4m7ho",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230515232352-tv4m7ho",
				"updated": "20230515232354"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "\nkubectl describe po xxx|grep 'Container ID' // Container ID:  cri-o://18362184e312245ddfaea39626e2c2b88d5162187f991cb5c47aadcb1f028e1f\n登录pod所在节点\ncrictl inspect 18362184e312245ddfaea39626e2c2b88d5162187f991cb5c47aadcb1f028e1f|grep netns // \"path\": \"/var/run/netns/44002d05-6855-4923-92e4-78aa06d823d6\"\nnsenter --net=\"/var/run/netns/44002d05-6855-4923-92e4-78aa06d823d6\" sh  // 至此进入了容器的网络命名空间，同时又可以使用宿主机的命令 \n使用完成后记得exit返回主机网络netns\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		}
	]
}