{
	"ID": "20221114180706-v2f3eeg",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20221114180706-v2f3eeg",
		"title": "OpenShift 4 - 配置OpenShift可使用的外部Image Registry和Mirror Registry",
		"updated": "20221114181946"
	},
	"Children": [
		{
			"ID": "20221114180705-tv6cd40",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20221114180705-tv6cd40"
			}
		},
		{
			"ID": "20221114180705-n4wbd2h",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221114180705-n4wbd2h"
			},
			"Children": [
				{
					"ID": "20221114180705-78bu96h",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221114180705-78bu96h"
					},
					"Children": [
						{
							"ID": "20221114180705-2yw97zt",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-2yw97zt"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://blog.csdn.net/weixin_43902588/article/details/107710166",
									"TextMarkTextContent": "https://blog.csdn.net/weixin_43902588/article/details/107710166"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-38sg8kc",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221114180705-38sg8kc"
					},
					"Children": [
						{
							"ID": "20221114180705-56rbnm1",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-56rbnm1"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "OpenShift 4把它能访问到的外部Registry的配置信息是保存在“image.config.openshift.io/cluster”对象中。当OpenShift的Machine Config Operator（MCO）发现image.config.openshift.io配置变化后，会将最新配置对送到所有Node并写入 /etc/containers/registries.conf 文件，然后重启对应的服务使其生效。通常OpenShift是有一个名为cluster的image.config."
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-n4dq62o",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221114180705-n4dq62o"
					},
					"Children": [
						{
							"ID": "20221114180705-oftoghg",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-oftoghg"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "2022-11-14 18:07:05"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221114180705-x3jwcpy",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20221114180705-x3jwcpy"
			}
		},
		{
			"ID": "20221114180705-rxubjvc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-rxubjvc"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "《"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://blog.csdn.net/weixin_43902588/article/details/105060359",
					"TextMarkTextContent": "OpenShift 4.x HOL教程汇总"
				},
				{
					"Type": "NodeText",
					"Data": "》"
				}
			]
		},
		{
			"ID": "20221114180705-83azhmz",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221114180705-83azhmz"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "文章目录"
				}
			]
		},
		{
			"ID": "20221114180705-4ajw2be",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221114180705-4ajw2be"
			},
			"Children": [
				{
					"ID": "20221114180705-xb9rtsa",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221114180705-xb9rtsa"
					},
					"Children": [
						{
							"ID": "20221114180705-70dkngn",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-70dkngn"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "#_2",
									"TextMarkTextContent": "概念"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-0s46ixw",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221114180705-0s46ixw"
					},
					"Children": [
						{
							"ID": "20221114180705-xg3yn3a",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-xg3yn3a"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "#OpenShiftImage_Registry_6",
									"TextMarkTextContent": "配置OpenShift的Image Registry"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-5fz19zh",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221114180705-5fz19zh"
					},
					"Children": [
						{
							"ID": "20221114180705-10n5uwr",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-10n5uwr"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "#OpenShiftMirror_Image_Registry_77",
									"TextMarkTextContent": "配置OpenShift的Mirror Image Registry"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-7a81yok",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221114180705-7a81yok"
					},
					"Children": [
						{
							"ID": "20221114180705-f2rdldt",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-f2rdldt"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "#_146",
									"TextMarkTextContent": "参考"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221114180705-db06msj",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221114180705-db06msj"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "概念"
				}
			]
		},
		{
			"ID": "20221114180705-a8l7fou",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-a8l7fou"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "OpenShift可访问的Image Registy包括其自身内部的Image Registry和其外部的Image Registry，而外部的Image Registry又可分为运行在远端的Image Registry，以及为了加速远端访问而运行在本地（或近地的）Mirror Image Registry。Mirror Image Registry除了可以用来加速访问外部Image外，我们在离线安装OpenShift的时候也会用到它。"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "在这里插入图片描述"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/20200801105119745-20221114180705-merdj5c.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "\n 以上OpenShift用到的Image Registry配置是以对象的方式存放在Etcd中。当OpenShift的Machine Config Operator发现这些对象变化后会自动将其推送到每个Node并写入 /etc/containers/registries.conf 文件，OpenShift然后会重启对应的Node使配置生效。"
				}
			]
		},
		{
			"ID": "20221114180705-nt0qgaz",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221114180705-nt0qgaz"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "配置OpenShift的Image Registry"
				}
			]
		},
		{
			"ID": "20221114180705-bjh1gf6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-bjh1gf6"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "OpenShift 4把它能访问到的外部Registry的配置信息是保存在“image.config.openshift.io/cluster”对象中。当OpenShift的Machine Config Operator（MCO）发现image.config.openshift.io配置变化后，会将最新配置对送到所有Node并写入 /etc/containers/registries.conf 文件，然后重启对应的Node使配置生效。\n "
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "在这里插入图片描述"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/20200731165810498-20221114180705-d7o6kjq.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221114180705-yt8r8ba",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-yt8r8ba"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "OpenShift使用一个名为cluster的image.config.openshift.io对象管理其能访问到的Image Registry目标和策略。"
				}
			]
		},
		{
			"ID": "20221114180705-nlm0v97",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-nlm0v97"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "YmFzaA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ oc get image.config.openshift.io\nNAME      AGE\ncluster   12d\n123\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-361109g",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-361109g"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看OpenShift可以访问到Registry的配置，其中“External Registry Hostnames”和“Internal Registry Hostname”定义了外部和内部Registry。"
				}
			]
		},
		{
			"ID": "20221114180705-h6isg2a",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-h6isg2a"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "YmFzaA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ oc describe image.config.openshift.io cluster\nName:         cluster\nNamespace:\nLabels:       \u003cnone\u003e\nAnnotations:  release.openshift.io/create-only: true\nAPI Version:  config.openshift.io/v1\nKind:         Image\nMetadata:\n  Creation Timestamp:  2020-07-18T09:54:27Z\n  Generation:          1\n  Resource Version:    25273\n  Self Link:           /apis/config.openshift.io/v1/images/cluster\n  UID:                 c94ebed4-684a-4c98-86aa-658a8685ef79\nSpec:\nStatus:\n  External Registry Hostnames:\n    default-route-openshift-image-registry.apps.cluster-beijing-959a.beijing-959a.example.opentlc.com\n  Internal Registry Hostname:  image-registry.openshift-image-registry.svc:5000\nEvents:                        \u003cnone\u003e\n12345678910111213141516171819\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-f2ozeor",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-f2ozeor"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "上面只是Registry的配置信息，其中OpenShift内部的Registry是通过以下的Cluster Operator运行的。"
				}
			]
		},
		{
			"ID": "20221114180705-7xp50eg",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-7xp50eg"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "YmFzaA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ oc get co image-registry\nNAME             VERSION   AVAILABLE   PROGRESSING   DEGRADED   SINCE\nimage-registry   4.5.4     True        False         False      2d2h\n123\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-nops2a4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-nops2a4"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果要修改OpenShift可访问的Registry目标，可先编辑image.config.openshift.io/cluster对象："
				}
			]
		},
		{
			"ID": "20221114180705-f7cqson",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-f7cqson"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "YmFzaA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ oc edit image.config.openshift.io/cluster\n1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-6o9cx2k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-6o9cx2k"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "增加“registrySources”部分内容。"
				}
			]
		},
		{
			"ID": "20221114180705-cwhvsmj",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-cwhvsmj"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "eWFtbA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "spec:\n  registrySources:\n    insecureRegistries:\n    - ocr.example.com\n    allowedRegistries:\n    - quay.io\n    - ocr.example.com\n1234567\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-58kc1us",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-58kc1us"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "保存后OpenShift会自动通过MCO将最新的配置同步到各个节点。可以从Node的Events查看节点的重启过程。\n "
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "在这里插入图片描述"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/20200731172043622-20221114180705-tup6qrk.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "\n 如果需要查看一个Node的Registry配置，可先通过debug进入该Node，然后查看/etc/containers/registries.conf（该文件是podman可以访问的registry的配置），确认最新的Registry配置已经加进去了。（如果使用非完整名称的Image，podman会去由“unqualified-search-registries”定义的Registry查找该镜像）"
				}
			]
		},
		{
			"ID": "20221114180705-jlfyc7d",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-jlfyc7d"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ oc debug node/\u003cNODE-NAME\u003e\nsh-4.2# chroot /host\nsh-4.2# cat /etc/containers/registries.conf\nunqualified-search-registries = ['registry.access.redhat.com', 'docker.io']\n[[registry]]\n  prefix = \"\"\n  location = \"ocr.example.com\"\n  insecure = true\n\n[[registry]]\n  prefix = \"\"\n  location = \"quay.io\"\n  allowed = true\n12345678910111213\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-8819rfs",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221114180705-8819rfs"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "配置OpenShift的Mirror Image Registry"
				}
			]
		},
		{
			"ID": "20221114180705-ck5ob2y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-ck5ob2y"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在一个受限的网络中（或访问远程Image Registry的网速比较慢），可以为OpenShift使用的外部Image Registry建一个Mirror，以加速OpenShift访问远程Registry上Image。Registry Mirror可以是运行在自己本地（或区域）的Docker Distribution、Quay等提供的Registry服务。\n "
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "在这里插入图片描述"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/20200731185128662-20221114180705-413tn0h.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "\n Image Registry Mirror的配置信息是保存在OpenShift集群范围的ImageContentSourcePolicy对象。当OpenShift的Machine Config Operator（MCO）发现ImageContentSourcePolicy配置变化后，会将最新配置对送到所有Node并写入 /etc/containers/registries.conf 文件，然后重启对应的Node使配置生效。"
				}
			]
		},
		{
			"ID": "20221114180705-bd9z6gd",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221114180705-bd9z6gd"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "注意"
				},
				{
					"Type": "NodeText",
					"Data": " ：本文只对说明如何将Mirror Image Registry的配置加到OpenShift中，而部署一套Mirror Image Registry可参见《"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://blog.csdn.net/weixin_43902588/article/details/107727804",
					"TextMarkTextContent": "OpenShift 4 - 部署Mirror Registry"
				},
				{
					"Type": "NodeText",
					"Data": "》。"
				}
			]
		},
		{
			"ID": "20221114180705-3kq9c2t",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20221114180705-3kq9c2t"
			},
			"Children": [
				{
					"ID": "20221114180705-rcto9zk",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20221114180705-rcto9zk"
					},
					"Children": [
						{
							"ID": "20221114180705-5nlaqrh",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-5nlaqrh"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "创建如下内容的registryrepomirror.yaml文件，其中为“registry.access.redhat.com/ubi8/ubi-minimal”镜像提供了2个Mirror，一个是“ example.io/example/ubi-minimal”，另一个是“example.com/example/ubi-minimal”，OpenShift会按照顺序访问Mirror的。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221114180705-5dtjyi8",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-5dtjyi8"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "eWFtbA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "apiVersion: operator.openshift.io/v1alpha1\nkind: ImageContentSourcePolicy\nmetadata:\n  name: ubi8repo\nspec:\n  repositoryDigestMirrors:\n  - mirrors:\n    - example.io/example/ubi-minimal\n    source: registry.access.redhat.com/ubi8/ubi-minimal\n  - mirrors:\n    - example.com/example/ubi-minimal\n    source: registry.access.redhat.com/ubi8/ubi-minimal\n123456789101112\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-hbeyrh8",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20221114180705-hbeyrh8"
			},
			"Children": [
				{
					"ID": "20221114180705-oakiqtl",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20221114180705-oakiqtl"
					},
					"Children": [
						{
							"ID": "20221114180705-s8mnmov",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-s8mnmov"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "创建ImageContentSourcePolicy对象。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221114180705-5njj889",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-5njj889"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "YmFzaA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ oc create -f registryrepomirror.yaml\n1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-aok92dc",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20221114180705-aok92dc"
			},
			"Children": [
				{
					"ID": "20221114180705-mei6joh",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20221114180705-mei6joh"
					},
					"Children": [
						{
							"ID": "20221114180705-0kv6rau",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-0kv6rau"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看Node的状态，确认Node会重启以使得配置生效。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221114180705-c9lgi4s",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-c9lgi4s"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "YmFzaA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ oc get node\nNAME                                              STATUS                       ROLES    AGE  VERSION\nip-10-0-131-190.ap-southeast-1.compute.internal   Ready                        master   13d   v1.18.3+012b3ec\nip-10-0-141-25.ap-southeast-1.compute.internal    Readyy,SchedulingDisabled    worker   13d   v1.18.3+012b3ec\nip-10-0-165-133.ap-southeast-1.compute.internal   Ready                        master   13d   v1.18.3+012b3ec\nip-10-0-174-85.ap-southeast-1.compute.internal    Ready                        worker   13d   v1.18.3+012b3ec\nip-10-0-216-155.ap-southeast-1.compute.internal   Ready                        master   13d   v1.18.3+012b3ec\n1234567\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-13dxo1v",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20221114180705-13dxo1v"
			},
			"Children": [
				{
					"ID": "20221114180705-kt37qz9",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20221114180705-kt37qz9"
					},
					"Children": [
						{
							"ID": "20221114180705-yc4dj0u",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-yc4dj0u"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "确认配置已经更新，有2个registry.mirror的配置。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221114180705-bfje5oh",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-bfje5oh"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ oc debug node \u003cNODE-NAME\u003e\nsh-4.2# chroot /host\nsh-4.4# cat /etc/containers/registries.conf\nunqualified-search-registries = [\"registry.access.redhat.com\", \"docker.io\"]\n\n[[registry]]\n  prefix = \"\"\n  location = \"registry.access.redhat.com/ubi8/ubi-minimal\"\n  mirror-by-digest-only = true\n\n  [[registry.mirror]]\n    location = \"example.com/example/ubi-minimal\"\n\n  [[registry.mirror]]\n    location = \"example.io/example/ubi-minimal\"\n\n[[registry]]\n  prefix = \"\"\n  location = \"ocr.example.com\"\n  insecure = true\n\n[[registry]]\n  prefix = \"\"\n  location = \"untrusted.com\"\n  blocked = true\n12345678910111213141516171819202122232425\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-dukfk33",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20221114180705-dukfk33"
			},
			"Children": [
				{
					"ID": "20221114180705-k44v6i1",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NS4=",
						"Num": 5
					},
					"Properties": {
						"id": "20221114180705-k44v6i1"
					},
					"Children": [
						{
							"ID": "20221114180705-tt0k457",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-tt0k457"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在Node内部发起对远程镜像“registry.access.redhat.com/ubi8/ubi-minimal”的访问，通过日志确认系统是从Mirror中获得该Image的。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221114180705-bf4582h",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221114180705-bf4582h"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "sh-4.2# podman pull --log-level=debug registry.access.redhat.com/ubi8/ubi-minimal\n1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221114180705-f4cm2qi",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221114180705-f4cm2qi"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "参考"
				}
			]
		},
		{
			"ID": "20221114180705-2gl1e5g",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20221114180705-2gl1e5g"
			},
			"Children": [
				{
					"ID": "20221114180705-zu972gb",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20221114180705-zu972gb"
					},
					"Children": [
						{
							"ID": "20221114180705-4oq9kx0",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-4oq9kx0"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://computingforgeeks.com/how-to-setup-red-hat-quay-registry-on-centos-rhel/"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-5a18stc",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20221114180705-5a18stc"
					},
					"Children": [
						{
							"ID": "20221114180705-dzcqrwa",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-dzcqrwa"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.7/html-single/images/index#installation-restricted-network-samples_samples-operator-alt-registry"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-jhxzd2q",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20221114180705-jhxzd2q"
					},
					"Children": [
						{
							"ID": "20221114180705-apc778u",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-apc778u"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.7/html-single/images/index#images-configuration-parameters_image-configuration"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-dugjq5x",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20221114180705-dugjq5x"
					},
					"Children": [
						{
							"ID": "20221114180705-e019w7g",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-e019w7g"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://computingforgeeks.com/allow-insecure-registries-in-openshift-okd-4-cluster/"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-136z4md",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NS4=",
						"Num": 5
					},
					"Properties": {
						"id": "20221114180705-136z4md"
					},
					"Children": [
						{
							"ID": "20221114180705-6cz3p63",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-6cz3p63"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://rhthsa.github.io/openshift-demo/build-with-oc.html"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-ww5n5lu",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Ni4=",
						"Num": 6
					},
					"Properties": {
						"id": "20221114180705-ww5n5lu"
					},
					"Children": [
						{
							"ID": "20221114180705-7v6g25c",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-7v6g25c"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://docs.openshift.com/container-platform/4.7/post_installation_configuration/preparing-for-users.html#images-configuration-shortname_post-install-preparing-for-users"
								}
							]
						}
					]
				},
				{
					"ID": "20221114180705-ehnya3j",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Ny4=",
						"Num": 7
					},
					"Properties": {
						"id": "20221114180705-ehnya3j"
					},
					"Children": [
						{
							"ID": "20221114180705-mkdesc7",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221114180705-mkdesc7"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://www.redhat.com/sysadmin/manage-container-registries"
								}
							]
						}
					]
				}
			]
		}
	]
}