{
	"ID": "20221115135823-0sbdwr4",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20221115135823-0sbdwr4",
		"scroll": "{\u0026quot;startId\u0026quot;:\u0026quot;20221115143459-j4koexn\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20221115145031-jo2kkqn\u0026quot;,\u0026quot;scrollTop\u0026quot;:0,\u0026quot;focusId\u0026quot;:\u0026quot;20221115143459-j4koexn\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0}",
		"title": "CRI-O",
		"updated": "20221115145320"
	},
	"Children": [
		{
			"ID": "20221115143459-j4koexn",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221115143459-j4koexn",
				"updated": "20221115143606"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1. 容器运行时各层级一览图"
				}
			]
		},
		{
			"ID": "20221115143507-dngx2ji",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115143507-dngx2ji",
				"updated": "20221115143509"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image.png"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20221115143509-a3hmgcd.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221115135823-bbsy1cj",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221115135823-bbsy1cj",
				"updated": "20221115143458"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2. Openshift节点运行容器过程"
				}
			]
		},
		{
			"ID": "20221115140035-ciahczw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115140035-ciahczw",
				"updated": "20221115140050"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tOpenShift 4的集群节点使用了基于CRI-O的容器运行环境。每个节点的kubelet通过gRPC调用CRI-O，而CRI-O运行符合OCI规范的容器。"
				}
			]
		},
		{
			"ID": "20221115140546-b9abwql",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115140546-b9abwql",
				"updated": "20221115140547"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image.png"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20221115140547-v6r1zwi.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221115140122-mva6dwh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115140122-mva6dwh",
				"updated": "20221115140125"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image.png"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20221115140125-7v6xoa4.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221115142536-6bu1py9",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20221115142536-6bu1py9",
				"updated": "20221115142548"
			},
			"Children": [
				{
					"ID": "20221115142548-jhdk54a",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20221115142548-jhdk54a"
					},
					"Children": [
						{
							"ID": "20221115142548-90owwp7",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221115142548-90owwp7",
								"updated": "20221115142550"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Kubernetes联系kubelet来启动一个pod。"
								}
							]
						}
					]
				},
				{
					"ID": "20221115142551-kiyfye8",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20221115142551-kiyfye8"
					},
					"Children": [
						{
							"ID": "20221115142551-o57iyul",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221115142551-o57iyul",
								"updated": "20221115142553"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "kubelet将请求通过CRI（Container runtime interface，容器运行时接口）转发给CRI-O守护进程，然后来启动新的POD。"
								}
							]
						}
					]
				},
				{
					"ID": "20221115142554-g4a4ai5",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20221115142554-g4a4ai5"
					},
					"Children": [
						{
							"ID": "20221115142554-8ic6fun",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221115142554-8ic6fun",
								"updated": "20221115142600"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "CRI-O使用从容器注册表中拉取Image。"
								}
							]
						}
					]
				},
				{
					"ID": "20221115142600-421airp",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20221115142600-421airp"
					},
					"Children": [
						{
							"ID": "20221115142600-55vtgs8",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221115142600-55vtgs8",
								"updated": "20221115142606"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "下载的Image会被解压到容器的根文件系统中。"
								}
							]
						}
					]
				},
				{
					"ID": "20221115142607-o0k4emb",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NS4=",
						"Num": 5
					},
					"Properties": {
						"id": "20221115142607-o0k4emb"
					},
					"Children": [
						{
							"ID": "20221115142607-wtg1t4p",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221115142607-wtg1t4p",
								"updated": "20221115142619"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在为容器创建了根文件系统后，CRI-O会生成一个OCI运行时规范json文件，描述如何使用OCI生成工具运行容器"
								}
							]
						}
					]
				},
				{
					"ID": "20221115142620-hof2ofg",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Ni4=",
						"Num": 6
					},
					"Properties": {
						"id": "20221115142620-hof2ofg"
					},
					"Children": [
						{
							"ID": "20221115142620-kv782up",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221115142620-kv782up",
								"updated": "20221115142628"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "CRI-O 使用该规范启动 OCI 兼容运行时以运行容器进程。默认的 OCI Runtime 是 runc。"
								}
							]
						}
					]
				},
				{
					"ID": "20221115142629-macqzzc",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Ny4=",
						"Num": 7
					},
					"Properties": {
						"id": "20221115142629-macqzzc"
					},
					"Children": [
						{
							"ID": "20221115142629-6irm3vz",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221115142629-6irm3vz",
								"updated": "20221115142633"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "每个容器由一个单独的conmon（container monitor）进程监控。它处理容器的日志，并记录容器进程的退出代码"
								}
							]
						}
					]
				},
				{
					"ID": "20221115142635-2r0bxg8",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "OC4=",
						"Num": 8
					},
					"Properties": {
						"id": "20221115142635-2r0bxg8"
					},
					"Children": [
						{
							"ID": "20221115142635-bp2lktj",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221115142635-bp2lktj"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "pod的网络是通过使用CNI来设置的，所以任何CNI插件都可以和CRI-O一起使用。\n"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221115143447-bzgmgdy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115143447-bzgmgdy",
				"updated": "20221115144046"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看配置"
				}
			]
		},
		{
			"ID": "20221115144047-y80yy0d",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221115144047-y80yy0d",
				"updated": "20221115144054"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat /etc/crictl.yaml \nruntime-endpoint: \"unix:///var/run/crio/crio.sock\"\ntimeout: 0\ndebug: true\nimage-endpoint: \"\"\npull-image-on-create: false\ndisable-pull-on-run: false\n\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221115144200-jvhsfbg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115144200-jvhsfbg",
				"updated": "20221115144409"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "根据config文件run pod sandbox"
				}
			]
		},
		{
			"ID": "20221115144253-ctvzbu2",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221115144253-ctvzbu2",
				"updated": "20221115144717"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ cat pod-config.json\n{\n    \"metadata\": {\n        \"name\": \"nginx-sandbox\",\n        \"namespace\": \"default\",\n        \"attempt\": 1,\n        \"uid\": \"hdishd83djaidwnduwk28bcsb\"\n    },\n    \"log_directory\": \"/tmp\",\n    \"linux\": {\n    }\n}\n\n$ crictl runp pod-config.json\nf84dd361f8dc51518ed291fbadd6db537b0496536c1d2d6c05ff943ce8c9a54f\n\n// 可以指定runtime\n$crictl runp --runtime=runsc pod-config.json\nc112976cb6caa43a967293e2c62a2e0d9d8191d5109afef230f403411147548c\n\n$ crictl pods\nPOD ID              CREATED             STATE               NAME                NAMESPACE           ATTEMPT\nf84dd361f8dc5       17 seconds ago      Ready               nginx-sandbox       default             1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221115144237-kh170tf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115144237-kh170tf",
				"updated": "20221115144700"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "根据配置文件在pod sandbox创建容器"
				}
			]
		},
		{
			"ID": "20221115144455-mu24jph",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221115144455-mu24jph",
				"updated": "20221115145320"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ crictl images\nIMAGE               TAG                 IMAGE ID            SIZE\nbusybox             latest              8c811b4aec35f       1.15MB\nk8s.gcr.io/pause    3.1                 da86e6ba6ca19       742kB\n\n$ cat pod-config.json\n{\n    \"metadata\": {\n        \"name\": \"nginx-sandbox\",\n        \"namespace\": \"default\",\n        \"attempt\": 1,\n        \"uid\": \"hdishd83djaidwnduwk28bcsb\"\n    },\n    \"log_directory\": \"/tmp\",\n    \"linux\": {\n    }\n}\n\n$ cat container-config.json\n{\n  \"metadata\": {\n      \"name\": \"busybox\"\n  },\n  \"image\":{\n      \"image\": \"busybox\"\n  },\n  \"command\": [\n      \"top\"\n  ],\n  \"log_path\":\"busybox.0.log\",\n  \"linux\": {\n  }\n}\n\n$ crictl create f84dd361f8dc51518ed291fbadd6db537b0496536c1d2d6c05ff943ce8c9a54f container-config.json pod-config.json\n3e025dd50a72d956c4f14881fbb5b1080c9275674e95fb67f965f6478a957d60\n\n\n$ crictl ps -a\nCONTAINER ID        IMAGE               CREATED             STATE               NAME                ATTEMPT\n3e025dd50a72d       busybox             32 seconds ago      Created             busybox   \n \n$ crictl start 3e025dd50a72d956c4f14881fbb5b1080c9275674e95fb67f965f6478a957d60\n3e025dd50a72d956c4f14881fbb5b1080c9275674e95fb67f965f6478a957d60\n\n$ crictl ps\nCONTAINER ID        IMAGE               CREATED              STATE               NAME                ATTEMPT\n3e025dd50a72d       busybox             About a minute ago   Running             busybox             0\n\n$crictl exec -i -t 3e025dd50a72d956c4f14881fbb5b1080c9275674e95fb67f965f6478a957d60 ls\nbin   dev   etc   home  proc  root  sys   tmp   usr   var\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221115145030-e2qo1x9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115145030-e2qo1x9",
				"updated": "20221115145133"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "一条命令创建和启动容器"
				}
			]
		},
		{
			"ID": "20221115145133-66eqx3i",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221115145133-66eqx3i",
				"updated": "20221115145200"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ cat pod-config.json\n{\n    \"metadata\": {\n        \"name\": \"nginx-sandbox\",\n        \"namespace\": \"default\",\n        \"attempt\": 1,\n        \"uid\": \"hdishd83djaidwnduwk28bcsb\"\n    },\n    \"log_directory\": \"/tmp\",\n    \"linux\": {\n    }\n}\n\n$ cat container-config.json\n{\n  \"metadata\": {\n      \"name\": \"busybox\"\n  },\n  \"image\":{\n      \"image\": \"busybox\"\n  },\n  \"command\": [\n      \"top\"\n  ],\n  \"log_path\":\"busybox.0.log\",\n  \"linux\": {\n  }\n}\n\n$ crictl run container-config.json pod-config.json\nb25b4f26e342969eb40d05e98130eee0846557d667e93deac992471a3b8f1cf4\n\n$ crictl ps\nCONTAINER           IMAGE               CREATED             STATE               NAME                ATTEMPT             POD ID\nb25b4f26e3429       busybox:latest      14 seconds ago      Running             busybox             0                   158d7a6665ff3\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221115145031-jo2kkqn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221115145031-jo2kkqn",
				"updated": "20221115145031"
			}
		}
	]
}