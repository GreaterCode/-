{
	"ID": "20220818151845-eq4gtfk",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20220818151845-eq4gtfk",
		"title": "kubelet配置资源预留",
		"updated": "20220818152628"
	},
	"Children": [
		{
			"ID": "20220818152729-n82cdes",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20220818152729-n82cdes",
				"updated": "20220818152804"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1. 简介"
				}
			]
		},
		{
			"ID": "20220818151845-0dwhqis",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818151845-0dwhqis",
				"updated": "20220818151959"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tKubelet Node Allocatable用来为Kube组件和System进程预留资源，从而保证当节点出现满负荷时也能保证Kube和System进程有足够的资源。目前支持cpu, memory, ephemeral-storage三种资源预留。"
				}
			]
		},
		{
			"ID": "20220818151959-xqua0ks",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818151959-xqua0ks",
				"updated": "20220818152222"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t计算方式："
				}
			]
		},
		{
			"ID": "20220818152004-rwnund8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818152004-rwnund8",
				"updated": "20220818152009"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t\tNode Allocatable Resource "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "="
				},
				{
					"Type": "NodeText",
					"Data": " Node Capacity - Kube-reserved - system-reserved - eviction-threshold"
				}
			]
		},
		{
			"ID": "20220818152017-a8a1ixe",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818152017-a8a1ixe",
				"updated": "20220818152033"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t名词解释："
				}
			]
		},
		{
			"ID": "20220818152146-f8evqbi",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20220818152146-f8evqbi",
				"updated": "20220818152204"
			},
			"Children": [
				{
					"ID": "20220818152146-9i9kbkw",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220818152146-9i9kbkw"
					},
					"Children": [
						{
							"ID": "20220818152146-1y9jpop",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220818152146-1y9jpop",
								"updated": "20220818152151"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Node Capacity：Node的所有硬件资源，kube-reserved是给kube组件预留的资源"
								}
							]
						}
					]
				},
				{
					"ID": "20220818152152-9ien2m3",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220818152152-9ien2m3"
					},
					"Children": [
						{
							"ID": "20220818152152-23tq1yc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220818152152-23tq1yc",
								"updated": "20220818152157"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Kube-reserved：kube 组件预留的资源"
								}
							]
						}
					]
				},
				{
					"ID": "20220818152200-w5hxzcx",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220818152200-w5hxzcx"
					},
					"Children": [
						{
							"ID": "20220818152200-78ukv09",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220818152200-78ukv09",
								"updated": "20220818152200"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "system-reserved：给system进程预留的资源"
								}
							]
						}
					]
				},
				{
					"ID": "20220818152204-bkfchxb",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20220818152204-bkfchxb",
						"updated": "20220818152204"
					},
					"Children": [
						{
							"ID": "20220818152204-1qr38kl",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20220818152204-1qr38kl",
								"updated": "20220818152204"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "eviction-threshold（阈值）：kubelet eviction(收回)的阈值设定"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20220818151929-bmyddn2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818151929-bmyddn2",
				"updated": "20220818190853"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "   "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "只有allocatable才是真正scheduler调度Pod时的参考值（保证Node上所有Pods的request resource不超过Allocatable） ，关系图如下："
				}
			]
		},
		{
			"ID": "20220818152253-jkte9lb",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20220818152253-jkte9lb",
				"updated": "20220818152805"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2. 计算示例："
				}
			]
		},
		{
			"ID": "20220818152355-2p4ozud",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20220818152355-2p4ozud",
				"updated": "20220818152419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "c2hlbGw="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "#kubectl describe nodes  node1\n...\nCapacity:\n  cpu:                8\n  ephemeral-storage:  206292644Ki\n  hugepages-1Gi:      0\n  hugepages-2Mi:      0\n  memory:             15731900Ki\n  pods:               110\nAllocatable:\n  cpu:                7500m\n  ephemeral-storage:  189045558572\n  hugepages-1Gi:      0\n  hugepages-2Mi:      0\n  memory:             13327548Ki\n  pods:               110\n...\n \n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20220818152332-ksaq7u8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818152332-ksaq7u8",
				"updated": "20220818152550"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "tag",
					"TextMarkTextContent": "cat  /var/lib/kubelet/config.yaml"
				}
			]
		},
		{
			"ID": "20220818152551-5saiqqa",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818152551-5saiqqa",
				"updated": "20220818152553"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image.png"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20220818152553-vwxbqt2.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20220818152608-i6akzib",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818152608-i6akzib",
				"updated": "20220818152610"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t内存： 13327548Ki "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "="
				},
				{
					"Type": "NodeText",
					"Data": " 15731900Ki - "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "1"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "em",
					"TextMarkTextContent": "1024"
				},
				{
					"Type": "NodeText",
					"Data": "1024Ki - "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "1"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "em",
					"TextMarkTextContent": "1024"
				},
				{
					"Type": "NodeText",
					"Data": "1024Ki - "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "300"
				},
				{
					"Type": "NodeText",
					"Data": "*1024Ki\n\tCPU： 7500m "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "="
				},
				{
					"Type": "NodeText",
					"Data": " 8000m - 500m （单位为m是以CPU的时间分片计量的，1C为1000m）"
				}
			]
		},
		{
			"ID": "20220818152627-6k7abvy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818152627-6k7abvy",
				"updated": "20220818152628"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t再通过查看 kubepods."
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://so.csdn.net/so/search?q=slice\u0026spm=1001.2101.3001.7020",
					"TextMarkTextContent": "slice"
				},
				{
					"Type": "NodeText",
					"Data": "（systemd 驱动是以 .slice 结尾）cgroup 中对节点上所有 Pod 内存的限制，该值决定了 Node 上所有的 Pod 能使用的资源上限："
				}
			]
		},
		{
			"ID": "20220818152648-vp6n5r1",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20220818152648-vp6n5r1",
				"updated": "20220818152720"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "c2hlbGw="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat /sys/fs/cgroup/memory/kubepods.slice/memory.limit_in_bytes\n13961981952      #单位是byte\n\n也可以通过计算验证我们的配置是正确的：\nkubepods.slice/memory.limit_in_bytes = capacity - kube_reserved - system_reserved\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20220818152637-qyj1g64",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818152637-qyj1g64",
				"updated": "20220818152651"
			}
		},
		{
			"ID": "20220818152613-7zvkdnb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20220818152613-7zvkdnb",
				"updated": "20220818152613"
			}
		}
	]
}