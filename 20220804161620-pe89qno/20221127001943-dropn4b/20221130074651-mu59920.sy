{
	"ID": "20221130074651-mu59920",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20221130074651-mu59920",
		"title": "8-运维操作",
		"updated": "20221205003506"
	},
	"Children": [
		{
			"ID": "20221130074651-98jwrt5",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221130074651-98jwrt5",
				"updated": "20221130074750"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.  插件使用"
				}
			]
		},
		{
			"ID": "20221130074802-6i1kics",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130074802-6i1kics",
				"updated": "20221130074813"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.1 插件安装"
				}
			]
		},
		{
			"ID": "20221130074734-v82bxya",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130074734-v82bxya",
				"updated": "20221130074825"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Kube-OVN 安装时默认会部署插件到每个节点，若执行 kubectl 的机器不在集群内， 或需要重装插件，可参考下面的步骤："
				}
			]
		},
		{
			"ID": "20221130074832-n1pg2ur",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130074832-n1pg2ur",
				"updated": "20221130074832"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "下载 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kubectl-ko"
				},
				{
					"Type": "NodeText",
					"Data": " 文件："
				}
			]
		},
		{
			"ID": "20221130074832-fz1qe1k",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130074832-fz1qe1k",
				"updated": "20221130074850"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "wget https://raw.githubusercontent.com/kubeovn/kube-ovn/release-1.10/dist/images/kubectl-ko\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130074857-zcz4ypm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130074857-zcz4ypm",
				"updated": "20221130074857"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "将该文件移动至 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "$PATH"
				},
				{
					"Type": "NodeText",
					"Data": " 目录下："
				}
			]
		},
		{
			"ID": "20221130074857-u3mja3y",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130074857-u3mja3y",
				"updated": "20221130074857"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "mv kubectl-ko /usr/local/bin/kubectl-ko\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130074857-49kmwgq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130074857-49kmwgq",
				"updated": "20221130074857"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "增加可执行权限："
				}
			]
		},
		{
			"ID": "20221130074857-371jalo",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130074857-371jalo",
				"updated": "20221130074857"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "chmod +x /usr/local/bin/kubectl-ko\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130074906-u3pk1qk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130074906-u3pk1qk",
				"updated": "20221130074906"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "检查插件是否可以正常使用："
				}
			]
		},
		{
			"ID": "20221130074906-sohl7i8",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130074906-sohl7i8",
				"updated": "20221130074906"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl plugin list\nThe following compatible plugins are available:\n\n/usr/local/bin/kubectl-ko\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130074927-thosjm0",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130074927-thosjm0",
				"updated": "20221130074935"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.2 插件使用"
				}
			]
		},
		{
			"ID": "20221130074951-anrgjze",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130074951-anrgjze",
				"updated": "20221130074952"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "运行 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kubectl ko"
				},
				{
					"Type": "NodeText",
					"Data": " 会展示该插件所有可用的命令和用法描述，如下所示："
				}
			]
		},
		{
			"ID": "20221130075002-3g3xxi9",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130075002-3g3xxi9",
				"updated": "20221130075007"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko\nkubectl ko {subcommand} [option...]\nAvailable Subcommands:\n  [nb|sb] [status|kick|backup|dbstatus|restore]     ovn-db operations show cluster status, kick stale server, backup database, get db consistency status or restore ovn nb db when met 'inconsistent data' error\n  nbctl [ovn-nbctl options ...]    invoke ovn-nbctl\n  sbctl [ovn-sbctl options ...]    invoke ovn-sbctl\n  vsctl {nodeName} [ovs-vsctl options ...]   invoke ovs-vsctl on the specified node\n  ofctl {nodeName} [ovs-ofctl options ...]   invoke ovs-ofctl on the specified node\n  dpctl {nodeName} [ovs-dpctl options ...]   invoke ovs-dpctl on the specified node\n  appctl {nodeName} [ovs-appctl options ...]   invoke ovs-appctl on the specified node\n  tcpdump {namespace/podname} [tcpdump options ...]     capture pod traffic\n  trace {namespace/podname} {target ip address} [target mac address] {icmp|tcp|udp} [target tcp or udp port]    trace ovn microflow of specific packet\n  diagnose {all|node} [nodename]    diagnose connectivity of all nodes or a specific node\n  tuning {install-fastpath|local-install-fastpath|remove-fastpath|install-stt|local-install-stt|remove-stt} {centos7|centos8}} [kernel-devel-version]  deploy  kernel optimisation components to the system\n  reload    restart all kube-ovn components\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130075034-iakt135",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130075034-iakt135",
				"updated": "20221130075113"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.3 数据库集群状态查看"
				}
			]
		},
		{
			"ID": "20221130075151-v8bus0h",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130075151-v8bus0h",
				"updated": "20221130075157"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令会在对应 OVN 数据库的 leader 节点执行 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-appctl cluster/status"
				},
				{
					"Type": "NodeText",
					"Data": " 展示集群状态"
				}
			]
		},
		{
			"ID": "20221130075114-mmncdqj",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130075114-mmncdqj",
				"updated": "20221130124846"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "#kubectl ko nb status\neebf\nName: OVN_Northbound\nCluster ID: d655 (d6551430-9015-439f-ad79-d74a8f1c2fea)\nServer ID: eebf (eebfc9fb-6b87-473f-aaed-27e620456273)\nAddress: tcp:[10.255.18.144]:6643\nStatus: cluster member\nRole: leader\nTerm: 3\nLeader: self\nVote: self\n\nLast Election started 781519451 ms ago, reason: timeout\nLast Election won: 781519448 ms ago\nElection timer: 5000\nLog: [1990063, 1991721]\nEntries not yet committed: 0\nEntries not yet applied: 0\nConnections: -\u003e4254 -\u003eea1c \u003c-ea1c \u003c-4254\nDisconnections: 1\nServers:\n    4254 (4254 at tcp:[10.255.19.160]:6643) next_index=1991721 match_index=1991720 last msg 523 ms ago\n    ea1c (ea1c at tcp:[10.255.18.145]:6643) next_index=1991721 match_index=1991720 last msg 523 ms ago\n    eebf (eebf at tcp:[10.255.18.144]:6643) (self) next_index=1771556 match_index=1991720\n\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130075137-gj3auxf",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130075137-gj3auxf",
				"updated": "20221130075228"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.4 节点下线"
				}
			]
		},
		{
			"ID": "20221130075235-w1rduk0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130075235-w1rduk0",
				"updated": "20221130075237"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令会将某个节点从 OVN 数据库中移除，在节点下线或更换节点时需要用到。 下面将以上一条命令所查看到的集群状态为例，下线 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "172.18.0.3"
				},
				{
					"Type": "NodeText",
					"Data": " 节点"
				}
			]
		},
		{
			"ID": "20221130075253-eynjc1e",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130075253-eynjc1e",
				"updated": "20221130124854"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb kick eebf\nstarted removal\n再次查看数据库集群状态确认节点已移除：\n\n\n# kubectl ko nb status\n306b\nName: OVN_Northbound\nCluster ID: 9a87 (9a872522-3e7d-47ca-83a3-d74333e1a7ca)\nServer ID: 306b (306b256b-b5e1-4eb0-be91-4ca96adf6bad)\nAddress: tcp:[172.18.0.2]:6643\nStatus: cluster member\nRole: leader\nTerm: 1\nLeader: self\nVote: self\n\nLast Election started 324356 ms ago, reason: timeout\nLast Election won: 324356 ms ago\nElection timer: 5000\nLog: [140, 140]\nEntries not yet committed: 0\nEntries not yet applied: 0\nConnections: \u003c-85d6 -\u003e85d6\nDisconnections: 2\nServers:\n    85d6 (85d6 at tcp:[172.18.0.4]:6643) next_index=140 match_index=139 last msg 848 ms ago\n    306b (306b at tcp:[172.18.0.2]:6643) (self) next_index=2 match_index=139\nstatus: ok\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130075522-fygl1w2",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130075522-fygl1w2",
				"updated": "20221130075901"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.5 数据库备份"
				}
			]
		},
		{
			"ID": "20221130075908-nhlusbm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130075908-nhlusbm",
				"updated": "20221130075908"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该子命令会备份当前 OVN 数据库至本地，可用于灾备和恢复："
				}
			]
		},
		{
			"ID": "20221130075908-jmqfo7d",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130075908-jmqfo7d",
				"updated": "20221130075908"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb backup\ntar: Removing leading `/' from member names\nbackup ovn-nb db to /root/ovnnb_db.060223191654183154.backup\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130075909-sffbp2f",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130075909-sffbp2f",
				"updated": "20221130075927"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.6 数据库状态查看"
				}
			]
		},
		{
			"ID": "20221130075919-5mpgzd6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130075919-5mpgzd6",
				"updated": "20221130075919"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令用来查看数据库文件是否存在损坏："
				}
			]
		},
		{
			"ID": "20221130075919-lchs3mn",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130075919-lchs3mn",
				"updated": "20221130075919"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb dbstatus\nstatus: ok\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130075919-70ljquo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130075919-70ljquo",
				"updated": "20221130075919"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若异常则显示 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "inconsistent data"
				},
				{
					"Type": "NodeText",
					"Data": " 需要使用下面的命令进行修复。"
				}
			]
		},
		{
			"ID": "20221130075929-lnudbed",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130075929-lnudbed",
				"updated": "20221130075944"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.7 数据库修复"
				}
			]
		},
		{
			"ID": "20221130075957-eqtyl8y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130075957-eqtyl8y",
				"updated": "20221130075957"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若数据库状态进入 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "inconsistent data"
				},
				{
					"Type": "NodeText",
					"Data": " 可使用该命令进行修复："
				}
			]
		},
		{
			"ID": "20221130075957-s1zobcj",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221130075957-s1zobcj",
				"updated": "20221130075957"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb restore\ndeployment.apps/ovn-central scaled\novn-central original replicas is 3\nfirst nodeIP is 172.18.0.5\novs-ovn pod on node 172.18.0.5 is ovs-ovn-8jxv9\novs-ovn pod on node 172.18.0.3 is ovs-ovn-sjzb6\novs-ovn pod on node 172.18.0.4 is ovs-ovn-t87zk\nbackup nb db file\nrestore nb db file, operate in pod ovs-ovn-8jxv9\ndeployment.apps/ovn-central scaled\nfinish restore nb db file and ovn-central replicas\nrecreate ovs-ovn pods\npod \"ovs-ovn-8jxv9\" deleted\npod \"ovs-ovn-sjzb6\" deleted\npod \"ovs-ovn-t87zk\" deleted\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130123859-rrxl7s4",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130123859-rrxl7s4",
				"updated": "20221130125245"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.8 [nbctl | sbctl] [options ...]"
				}
			]
		},
		{
			"ID": "20221130125237-wuy76kl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221130125237-wuy76kl",
				"updated": "20221130125237"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该子命令会直接进入 OVN 北向数据库或南向数据库 的 leader 节点分别执行 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-nbctl"
				},
				{
					"Type": "NodeText",
					"Data": " 和 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-sbctl"
				},
				{
					"Type": "NodeText",
					"Data": " 命令。 更多该命令的详细用法请查询上游 OVN 的官方文档 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://man7.org/linux/man-pages/man8/ovn-nbctl.8.html",
					"TextMarkTextContent": "ovn-nbctl(8)"
				},
				{
					"Type": "NodeText",
					"Data": " 和 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://man7.org/linux/man-pages/man8/ovn-sbctl.8.html",
					"TextMarkTextContent": "ovn-sbctl(8)"
				},
				{
					"Type": "NodeText",
					"Data": "。"
				}
			]
		},
		{
			"ID": "20221201012908-czoohd5",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201012908-czoohd5",
				"updated": "20221201012955"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nbctl show\nswitch c7cd17e8-ceee-4a91-9bb3-e5a313fe1ece (snat)\n    port snat-ovn-cluster\n        type: router\n        router-port: ovn-cluster-snat\nswitch 20e0c6d0-023a-4756-aec5-200e0c60f95d (join)\n    port node-liumengxin-ovn3-192.168.137.178\n        addresses: [\"00:00:00:64:FF:A8 100.64.0.4\"]\n    port node-liumengxin-ovn1-192.168.137.176\n        addresses: [\"00:00:00:AF:98:62 100.64.0.2\"]\n    port node-liumengxin-ovn2-192.168.137.177\n        addresses: [\"00:00:00:D9:58:B8 100.64.0.3\"]\n    port join-ovn-cluster\n        type: router\n        router-port: ovn-cluster-join\nswitch 0191705c-f827-427b-9de3-3c3b7d971ba5 (central)\n    port central-ovn-cluster\n        type: router\n        router-port: ovn-cluster-central\n...\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221130125247-2kt6t13",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221130125247-2kt6t13",
				"updated": "20221201013131"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.9 vsctl {nodeName} [options ...]"
				}
			]
		},
		{
			"ID": "20221201013258-16f1gg8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013258-16f1gg8",
				"updated": "20221201013259"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令会进入对应 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "nodeName"
				},
				{
					"Type": "NodeText",
					"Data": " 上的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 容器，并执行相应的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-vsctl"
				},
				{
					"Type": "NodeText",
					"Data": " 命令，查询并配置 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "vswitchd"
				},
				{
					"Type": "NodeText",
					"Data": "。 更多该命令的详细用法请查询上游 OVS 的官方文档 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://man7.org/linux/man-pages/man8/ovs-vsctl.8.html",
					"TextMarkTextContent": "ovs-vsctl(8)"
				},
				{
					"Type": "NodeText",
					"Data": "。"
				}
			]
		},
		{
			"ID": "20221201013132-agq67vm",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013132-agq67vm",
				"updated": "20221201013156"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko vsctl kube-ovn-01 show\n0d4c4675-c9cc-440a-8c1a-878e17f81b88\n    Bridge br-int\n        fail_mode: secure\n        datapath_type: system\n        Port a2c1a8a8b83a_h\n            Interface a2c1a8a8b83a_h\n        Port \"4fa5c4cbb1a5_h\"\n            Interface \"4fa5c4cbb1a5_h\"\n        Port ovn-eef07d-0\n            Interface ovn-eef07d-0\n                type: stt\n                options: {csum=\"true\", key=flow, remote_ip=\"192.168.137.178\"}\n        Port ovn0\n            Interface ovn0\n                type: internal\n        Port mirror0\n            Interface mirror0\n                type: internal\n        Port ovn-efa253-0\n            Interface ovn-efa253-0\n                type: stt\n                options: {csum=\"true\", key=flow, remote_ip=\"192.168.137.177\"}\n        Port br-int\n            Interface br-int\n                type: internal\n    ovs_version: \"2.17.2\"\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013216-tta6rvz",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201013216-tta6rvz",
				"updated": "20221201013232"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.10 ofctl {nodeName} [options ...]"
				}
			]
		},
		{
			"ID": "20221201013247-37alwg0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013247-37alwg0",
				"updated": "20221201013248"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令会进入对应 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "nodeName"
				},
				{
					"Type": "NodeText",
					"Data": " 上的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 容器，并执行相应的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-ofctl"
				},
				{
					"Type": "NodeText",
					"Data": " 命令，查询或管理 OpenFlow。 更多该命令的详细用法请查询上游 OVS 的官方文档 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://man7.org/linux/man-pages/man8/ovs-ofctl.8.html",
					"TextMarkTextContent": "ovs-ofctl(8)"
				},
				{
					"Type": "NodeText",
					"Data": "。"
				}
			]
		},
		{
			"ID": "20221201013312-69pa2k2",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013312-69pa2k2",
				"updated": "20221201013316"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko ofctl kube-ovn-01 dump-flows br-int\nNXST_FLOW reply (xid=0x4): flags=[more]\n cookie=0xcf3429e6, duration=671791.432s, table=0, n_packets=0, n_bytes=0, idle_age=65534, hard_age=65534, priority=100,in_port=2 actions=load:0x4-\u003eNXM_NX_REG13[],load:0x9-\u003eNXM_NX_REG11[],load:0xb-\u003eNXM_NX_REG12[],load:0x4-\u003eOXM_OF_METADATA[],load:0x1-\u003eNXM_NX_REG14[],resubmit(,8)\n cookie=0xc91413c6, duration=671791.431s, table=0, n_packets=907489, n_bytes=99978275, idle_age=0, hard_age=65534, priority=100,in_port=7 actions=load:0x1-\u003eNXM_NX_REG13[],load:0x9-\u003eNXM_NX_REG11[],load:0xb-\u003eNXM_NX_REG12[],load:0x4-\u003eOXM_OF_METADATA[],load:0x4-\u003eNXM_NX_REG14[],resubmit(,8)\n cookie=0xf180459, duration=671791.431s, table=0, n_packets=17348582, n_bytes=2667811214, idle_age=0, hard_age=65534, priority=100,in_port=6317 actions=load:0xa-\u003eNXM_NX_REG13[],load:0x9-\u003eNXM_NX_REG11[],load:0xb-\u003eNXM_NX_REG12[],load:0x4-\u003eOXM_OF_METADATA[],load:0x9-\u003eNXM_NX_REG14[],resubmit(,8)\n cookie=0x7806dd90, duration=671791.431s, table=0, n_packets=3235428, n_bytes=833821312, idle_age=0, hard_age=65534, priority=100,in_port=1 actions=load:0xd-\u003eNXM_NX_REG13[],load:0x9-\u003eNXM_NX_REG11[],load:0xb-\u003eNXM_NX_REG12[],load:0x4-\u003eOXM_OF_METADATA[],load:0x3-\u003eNXM_NX_REG14[],resubmit(,8)\n...\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013337-or7ke9p",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201013337-or7ke9p",
				"updated": "20221201013434"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.11 dpctl {nodeName} [options ...]"
				}
			]
		},
		{
			"ID": "20221201013337-4tk2lo8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013337-4tk2lo8",
				"updated": "20221201013337"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令会进入对应 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "nodeName"
				},
				{
					"Type": "NodeText",
					"Data": " 上的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 容器，并执行相应的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-dpctl"
				},
				{
					"Type": "NodeText",
					"Data": " 命令，查询或管理 OVS datapath。 更多该命令的详细用法请查询上游 OVS 的官方文档 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://man7.org/linux/man-pages/man8/ovs-dpctl.8.html",
					"TextMarkTextContent": "ovs-dpctl(8)"
				},
				{
					"Type": "NodeText",
					"Data": "。"
				}
			]
		},
		{
			"ID": "20221201013337-cuglwld",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013337-cuglwld",
				"updated": "20221201013337"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko dpctl kube-ovn-01 show\nsystem@ovs-system:\n  lookups: hit:350805055 missed:21983648 lost:73\n  flows: 105\n  masks: hit:1970748791 total:22 hit/pkt:5.29\n  port 0: ovs-system (internal)\n  port 1: ovn0 (internal)\n  port 2: mirror0 (internal)\n  port 3: br-int (internal)\n  port 4: stt_sys_7471 (stt: packet_type=ptap)\n  port 5: eeb4d9e51b5d_h\n  port 6: a2c1a8a8b83a_h\n  port 7: 4fa5c4cbb1a5_h\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013403-l41nmna",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201013403-l41nmna",
				"updated": "20221201013431"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.12 appctl {nodeName} [options ...]"
				}
			]
		},
		{
			"ID": "20221201013403-fptye3z",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013403-fptye3z",
				"updated": "20221201013403"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令会进入对应 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "nodeName"
				},
				{
					"Type": "NodeText",
					"Data": " 上的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 容器，并执行相应的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-appctl"
				},
				{
					"Type": "NodeText",
					"Data": " 命令，来操作相关 daemon 进程。 更多该命令的详细用法请查询上游 OVS 的官方文档 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://man7.org/linux/man-pages/man8/ovs-appctl.8.html",
					"TextMarkTextContent": "ovs-appctl(8)"
				},
				{
					"Type": "NodeText",
					"Data": "。"
				}
			]
		},
		{
			"ID": "20221201013403-ja8c7sh",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013403-ja8c7sh",
				"updated": "20221201013403"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko appctl kube-ovn-01 vlog/list\n                 console    syslog    file\n                 -------    ------    ------\nbacktrace          OFF        ERR       INFO\nbfd                OFF        ERR       INFO\nbond               OFF        ERR       INFO\nbridge             OFF        ERR       INFO\nbundle             OFF        ERR       INFO\nbundles            OFF        ERR       INFO\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013457-8wiywim",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201013457-8wiywim",
				"updated": "20221201013509"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.13 tcpdump {namespace/podname} [tcpdump options ...]"
				}
			]
		},
		{
			"ID": "20221201013457-k7khjww",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013457-k7khjww",
				"updated": "20221201013457"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令会进入 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "namespace/podname"
				},
				{
					"Type": "NodeText",
					"Data": " 所在机器的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-cni"
				},
				{
					"Type": "NodeText",
					"Data": " 容器，并执行 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "tcpdump"
				},
				{
					"Type": "NodeText",
					"Data": " 抓取对应容器 veth 网卡 端的流量，可以方便排查网络相关问题，如下所示："
				}
			]
		},
		{
			"ID": "20221201013457-6752vz0",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013457-6752vz0",
				"updated": "20221201013457"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko tcpdump default/ds1-l6n7p icmp\n+ kubectl exec -it kube-ovn-cni-wlg4s -n kube-ovn -- tcpdump -nn -i d7176fe7b4e0_h icmp\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on d7176fe7b4e0_h, link-type EN10MB (Ethernet), capture size 262144 bytes\n06:52:36.619688 IP 100.64.0.3 \u003e 10.16.0.4: ICMP echo request, id 2, seq 1, length 64\n06:52:36.619746 IP 10.16.0.4 \u003e 100.64.0.3: ICMP echo reply, id 2, seq 1, length 64\n06:52:37.619588 IP 100.64.0.3 \u003e 10.16.0.4: ICMP echo request, id 2, seq 2, length 64\n06:52:37.619630 IP 10.16.0.4 \u003e 100.64.0.3: ICMP echo reply, id 2, seq 2, length 64\n06:52:38.619933 IP 100.64.0.3 \u003e 10.16.0.4: ICMP echo request, id 2, seq 3, length 64\n06:52:38.619973 IP 10.16.0.4 \u003e 100.64.0.3: ICMP echo reply, id 2, seq 3, length 64\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013619-l5ik1cu",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201013619-l5ik1cu",
				"updated": "20221201013809"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.14 trace {namespace/podname} {target ip address} [target mac address] {icmp|tcp|udp} [target tcp or udp port]"
				}
			]
		},
		{
			"ID": "20221201013619-luythic",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013619-luythic",
				"updated": "20221201013619"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令将会打印 Pod 通过特定协议访问某地址时对应的 OVN 逻辑流表和最终的 Openflow 流表， 方便开发或运维时定位流表相关问题。"
				}
			]
		},
		{
			"ID": "20221201013619-8xgel3w",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013619-8xgel3w",
				"updated": "20221201013619"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko trace default/ds1-l6n7p 8.8.8.8 icmp\n+ kubectl exec ovn-central-5bc494cb5-np9hm -n kube-ovn -- ovn-trace --ct=new ovn-default 'inport == \"ds1-l6n7p.default\" \u0026\u0026 ip.ttl == 64 \u0026\u0026 icmp \u0026\u0026 eth.src == 0a:00:00:10:00:05 \u0026\u0026 ip4.src == 10.16.0.4 \u0026\u0026 eth.dst == 00:00:00:B8:CA:43 \u0026\u0026 ip4.dst == 8.8.8.8'\n# icmp,reg14=0xf,vlan_tci=0x0000,dl_src=0a:00:00:10:00:05,dl_dst=00:00:00:b8:ca:43,nw_src=10.16.0.4,nw_dst=8.8.8.8,nw_tos=0,nw_ecn=0,nw_ttl=64,icmp_type=0,icmp_code=0\n\ningress(dp=\"ovn-default\", inport=\"ds1-l6n7p.default\")\n-----------------------------------------------------\n 0. ls_in_port_sec_l2 (ovn-northd.c:4143): inport == \"ds1-l6n7p.default\" \u0026\u0026 eth.src == {0a:00:00:10:00:05}, priority 50, uuid 39453393\n    next;\n 1. ls_in_port_sec_ip (ovn-northd.c:2898): inport == \"ds1-l6n7p.default\" \u0026\u0026 eth.src == 0a:00:00:10:00:05 \u0026\u0026 ip4.src == {10.16.0.4}, priority 90, uuid 81bcd485\n    next;\n 3. ls_in_pre_acl (ovn-northd.c:3269): ip, priority 100, uuid 7b4f4971\n    reg0[0] = 1;\n    next;\n 5. ls_in_pre_stateful (ovn-northd.c:3396): reg0[0] == 1, priority 100, uuid 36cdd577\n    ct_next;\n\nct_next(ct_state=new|trk)\n-------------------------\n 6. ls_in_acl (ovn-northd.c:3759): ip \u0026\u0026 (!ct.est || (ct.est \u0026\u0026 ct_label.blocked == 1)), priority 1, uuid 7608af5b\n    reg0[1] = 1;\n    next;\n10. ls_in_stateful (ovn-northd.c:3995): reg0[1] == 1, priority 100, uuid 2aba1b90\n    ct_commit(ct_label=0/0x1);\n    next;\n16. ls_in_l2_lkup (ovn-northd.c:4470): eth.dst == 00:00:00:b8:ca:43, priority 50, uuid 5c9c3c9f\n    outport = \"ovn-default-ovn-cluster\";\n    output;\n\n...\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013619-cmxw3nh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013619-cmxw3nh",
				"updated": "20221201013619"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若 trace 对象为运行于 Underlay 网络下的虚拟机，需要添加额外参数来指定目的 Mac 地址："
				}
			]
		},
		{
			"ID": "20221201013619-icvr78t",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013619-icvr78t",
				"updated": "20221201013619"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl ko trace default/virt-handler-7lvml 8.8.8.8 82:7c:9f:83:8c:01 icmp\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013706-bbe746r",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201013706-bbe746r",
				"updated": "20221201013715"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.15 diagnose {all|node} [nodename]¶"
				}
			]
		},
		{
			"ID": "20221201013706-xwaq0gc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013706-xwaq0gc",
				"updated": "20221201013706"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "诊断集群网络组件状态，并去对应节点的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-pinger"
				},
				{
					"Type": "NodeText",
					"Data": " 检测当前节点到其他节点和关键服务的连通性和网络延迟："
				}
			]
		},
		{
			"ID": "20221201013706-3d1oibt",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013706-3d1oibt",
				"updated": "20221201013706"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko diagnose all\nswitch c7cd17e8-ceee-4a91-9bb3-e5a313fe1ece (snat)\n    port snat-ovn-cluster\n        type: router\n        router-port: ovn-cluster-snat\nswitch 20e0c6d0-023a-4756-aec5-200e0c60f95d (join)\n    port node-liumengxin-ovn3-192.168.137.178\n        addresses: [\"00:00:00:64:FF:A8 100.64.0.4\"]\n    port node-liumengxin-ovn1-192.168.137.176\n        addresses: [\"00:00:00:AF:98:62 100.64.0.2\"]\n    port join-ovn-cluster\n        type: router\n        router-port: ovn-cluster-join\nswitch 0191705c-f827-427b-9de3-3c3b7d971ba5 (central)\n    port central-ovn-cluster\n        type: router\n        router-port: ovn-cluster-central\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013740-msrhadv",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201013740-msrhadv",
				"updated": "20221201013748"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.16 tuning {install-fastpath|local-install-fastpath|remove-fastpath|install-stt|local-install-stt|remove-stt} {centos7|centos8}} [kernel-devel-version]¶"
				}
			]
		},
		{
			"ID": "20221201013740-cgfn2m0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013740-cgfn2m0",
				"updated": "20221201013740"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令执行性能调优相关操作，具体使用请参考"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/advance/performance-tuning/",
					"TextMarkTextContent": "性能调优"
				},
				{
					"Type": "NodeText",
					"Data": "。"
				}
			]
		},
		{
			"ID": "20221201013752-hzjskn6",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201013752-hzjskn6",
				"updated": "20221201013759"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.17 reload"
				}
			]
		},
		{
			"ID": "20221201013740-x9jq1d4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201013740-x9jq1d4",
				"updated": "20221201013740"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该命令重启所有 Kube-OVN 相关组件："
				}
			]
		},
		{
			"ID": "20221201013740-mexitdl",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201013740-mexitdl",
				"updated": "20221201013740"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko reload\npod \"ovn-central-8684dd94bd-vzgcr\" deleted\nWaiting for deployment \"ovn-central\" rollout to finish: 0 of 1 updated replicas are available...\ndeployment \"ovn-central\" successfully rolled out\npod \"ovs-ovn-bsnvz\" deleted\npod \"ovs-ovn-m9b98\" deleted\npod \"kube-ovn-controller-8459db5ff4-64c62\" d\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201013848-bj7jmbr",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221201013848-bj7jmbr",
				"updated": "20221201020641"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2. 删除工作节点"
				}
			]
		},
		{
			"ID": "20221201020641-sl0jb7g",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201020641-sl0jb7g",
				"updated": "20221201020642"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果只是简单从 Kubernetes 中删除节点，由于节点上 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 中运行的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-controller"
				},
				{
					"Type": "NodeText",
					"Data": " 进程仍在运行会定期连接 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 注册相关网络信息， 会导致额外资源浪费并有潜在的规则冲突风险。 因此在从 Kubernetes 内删除节点时，请按照下面的步骤来保证网络信息可以正常被清理"
				}
			]
		},
		{
			"ID": "20221201020726-e8ha7o3",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201020726-e8ha7o3",
				"updated": "20221201020739"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1 驱逐节点上所有容器"
				}
			]
		},
		{
			"ID": "20221201020744-lk7p83x",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201020744-lk7p83x",
				"updated": "20221201020930"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": " # kubectl drain kube-ovn-worker --ignore-daemonsets --force\n node/kube-ovn-worker cordoned\n WARNING: ignoring DaemonSet-managed Pods: kube-system/kube-ovn-cni-zt74b, kube-system/kube-ovn-pinger-5rxfs, kube-system/kube-proxy-jpmnm, kube-system/ovs-ovn-v2kll\n evicting pod kube-system/coredns-64897985d-qsgpt\n evicting pod local-path-storage/local-path-provisioner-5ddd94ff66-llss6\n evicting pod kube-system/kube-ovn-controller-8459db5ff4-94lxb\n pod/kube-ovn-controller-8459db5ff4-94lxb evicted\n pod/coredns-64897985d-qsgpt evicted\n pod/local-path-provisioner-5ddd94ff66-llss6 evicted\n node/kube-ovn-worker drained\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201020739-lc00ktx",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201020739-lc00ktx",
				"updated": "20221201020756"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.2 停止kubelet和docker"
				}
			]
		},
		{
			"ID": "20221201021257-yyhejjt",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201021257-yyhejjt",
				"updated": "20221201021258"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该步骤会停止 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 容器，以避免向 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 进行信息注册，登录到对应节点执行下列命令："
				}
			]
		},
		{
			"ID": "20221201021241-rphb8xd",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201021241-rphb8xd",
				"updated": "20221201021250"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "systemctl stop kubelet\nsystemctl stop docker\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201020757-g8r8ias",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201020757-g8r8ias",
				"updated": "20221201020818"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.3 清理Node上残留数据"
				}
			]
		},
		{
			"ID": "20221201020818-3xn922w",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201020818-3xn922w",
				"updated": "20221201021115"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "rm -rf /var/run/openvswitch\nrm -rf /var/run/ovn\nrm -rf /etc/origin/openvswitch/\nrm -rf /etc/origin/ovn/\nrm -rf /etc/cni/net.d/00-kube-ovn.conflist\nrm -rf /etc/cni/net.d/01-kube-ovn.conflist\nrm -rf /var/log/openvswitch\nrm -rf /var/log/ovn\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201020819-ru4hyw8",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201020819-ru4hyw8",
				"updated": "20221201020823"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.4 使用 kubectl 删除节点"
				}
			]
		},
		{
			"ID": "20221201020833-cgs3anr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201020833-cgs3anr",
				"updated": "20221201020833"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kubectl delete no kube-ovn-01"
				}
			]
		},
		{
			"ID": "20221201020833-ucrjig4",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201020833-ucrjig4",
				"updated": "20221201020845"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.5 检查对应节点是否从 ovn-sb 中删除"
				}
			]
		},
		{
			"ID": "20221201021036-4b4gplu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201021036-4b4gplu",
				"updated": "20221201021036"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "下面的示例为 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-worker"
				},
				{
					"Type": "NodeText",
					"Data": " 依然未被删除："
				}
			]
		},
		{
			"ID": "20221201021036-nwulqjq",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201021036-nwulqjq",
				"updated": "20221201021036"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko sbctl show\nChassis \"b0564934-5a0d-4804-a4c0-476c93596a17\"\n  hostname: kube-ovn-worker\n  Encap geneve\n      ip: \"172.18.0.2\"\n      options: {csum=\"true\"}\n  Port_Binding kube-ovn-pinger-5rxfs.kube-system\nChassis \"6a29de7e-d731-4eaf-bacd-2f239ee52b28\"\n  hostname: kube-ovn-control-plane\n  Encap geneve\n      ip: \"172.18.0.3\"\n      options: {csum=\"true\"}\n  Port_Binding coredns-64897985d-nbfln.kube-system\n  Port_Binding node-kube-ovn-control-plane\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201020851-5b6lj1e",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201020851-5b6lj1e",
				"updated": "20221201020854"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.6 若节点对应的 chassis 依然存在，手动进行删除"
				}
			]
		},
		{
			"ID": "20221201021055-f46gcln",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201021055-f46gcln",
				"updated": "20221201021055"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "uuid 为之前命令所查出的 Chassis 对应 id："
				}
			]
		},
		{
			"ID": "20221201021055-xz5i25t",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201021055-xz5i25t",
				"updated": "20221201021055"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko sbctl chassis-del b0564934-5a0d-4804-a4c0-476c93596a17\n# kubectl ko sbctl show\nChassis \"6a29de7e-d731-4eaf-bacd-2f239ee52b28\"\n  hostname: kube-ovn-control-plane\n  Encap geneve\n      ip: \"172.18.0.3\"\n      options: {csum=\"true\"}\n  Port_Binding coredns-64897985d-nbfln.kube-system\n  Port_Binding node-kube-ovn-control-plane\n  Port_Binding local-path-provisioner-5ddd94ff66-h4tn9.local-path-storage\n  Port_Binding kube-ovn-pinger-hf2p6.kube-system\n  Port_Binding coredns-64897985d-fhwlw.kube-system\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201021209-m0pivoe",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221201021209-m0pivoe",
				"updated": "20221201021339"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3. 更换 ovn-central 节点"
				}
			]
		},
		{
			"ID": "20221201021344-w43pscp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201021344-w43pscp",
				"updated": "20221201021401"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "由于 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 内的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-nb"
				},
				{
					"Type": "NodeText",
					"Data": " 和 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-sb"
				},
				{
					"Type": "NodeText",
					"Data": " 分别建立了类似 etcd 的 raft 集群，因此更换 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 节点需要额外的操作，保证集群状态的正确和数据的一致。建议每次只对一个节点进行上下线处理，以避免集群进入不可用 状态，影响集群整体网络。"
				}
			]
		},
		{
			"ID": "20221201021431-rvp500n",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201021431-rvp500n",
				"updated": "20221201095926"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.1 ovn-central节点下线"
				}
			]
		},
		{
			"ID": "20221201100022-bcgei0t",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201100022-bcgei0t",
				"updated": "20221201100051"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.1.1 下线ovn-nb集群内对应节点"
				}
			]
		},
		{
			"ID": "20221201100120-lz0z9ox",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201100120-lz0z9ox",
				"updated": "20221201100120"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "首先查看节点在集群内的 ID，以便后续操作。"
				}
			]
		},
		{
			"ID": "20221201100120-4cgrrz6",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201100120-4cgrrz6",
				"updated": "20221201100120"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb status\n1b9a\nName: OVN_Northbound\nCluster ID: 32ca (32ca07fb-739b-4257-b510-12fa18e7cce8)\nServer ID: 1b9a (1b9a5d76-e69b-410c-8085-39943d0cd38c)\nAddress: tcp:[172.18.0.3]:6643\nStatus: cluster member\nRole: leader\nTerm: 1\nLeader: self\nVote: self\n\nLast Election started 2135194 ms ago, reason: timeout\nLast Election won: 2135188 ms ago\nElection timer: 5000\nLog: [135, 135]\nEntries not yet committed: 0\nEntries not yet applied: 0\nConnections: \u003c-d64b -\u003ed64b \u003c-4984 -\u003e4984\nDisconnections: 0\nServers:\n    4984 (4984 at tcp:[172.18.0.4]:6643) next_index=135 match_index=134 last msg 1084 ms ago\n    1b9a (1b9a at tcp:[172.18.0.3]:6643) (self) next_index=2 match_index=134\n    d64b (d64b at tcp:[172.18.0.5]:6643) next_index=135 match_index=134 last msg 1084 ms ago\nstatus: ok\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201100120-nwj0rwf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201100120-nwj0rwf",
				"updated": "20221201100120"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-control-plane2"
				},
				{
					"Type": "NodeText",
					"Data": " 对应节点 IP 为 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "172.18.0.5"
				},
				{
					"Type": "NodeText",
					"Data": "，集群内对应的 ID 为 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "d64b"
				},
				{
					"Type": "NodeText",
					"Data": "。接下来从 ovn-nb 集群中踢出该节点："
				}
			]
		},
		{
			"ID": "20221201100120-caov8hl",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201100120-caov8hl",
				"updated": "20221201100120"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb kick d64b\nstarted removal\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201100120-ylwfkir",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201100120-ylwfkir",
				"updated": "20221201100120"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "确认节点踢出成功："
				}
			]
		},
		{
			"ID": "20221201100120-6vfwe95",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201100120-6vfwe95",
				"updated": "20221201100120"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb status\n1b9a\nName: OVN_Northbound\nCluster ID: 32ca (32ca07fb-739b-4257-b510-12fa18e7cce8)\nServer ID: 1b9a (1b9a5d76-e69b-410c-8085-39943d0cd38c)\nAddress: tcp:[172.18.0.3]:6643\nStatus: cluster member\nRole: leader\nTerm: 1\nLeader: self\nVote: self\n\nLast Election started 2297649 ms ago, reason: timeout\nLast Election won: 2297643 ms ago\nElection timer: 5000\nLog: [136, 136]\nEntries not yet committed: 0\nEntries not yet applied: 0\nConnections: \u003c-4984 -\u003e4984\nDisconnections: 2\nServers:\n    4984 (4984 at tcp:[172.18.0.4]:6643) next_index=136 match_index=135 last msg 1270 ms ago\n    1b9a (1b9a at tcp:[172.18.0.3]:6643) (self) next_index=2 match_index=135\nstatus: ok\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201100208-a5jlv2t",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201100208-a5jlv2t",
				"updated": "20221201100217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.1.2 下线 ovn-sb 集群内对应节点¶"
				}
			]
		},
		{
			"ID": "20221201100233-xzhu6x8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201100233-xzhu6x8",
				"updated": "20221201100234"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "首先查看节点在集群内的 ID，以便后续操作："
				}
			]
		},
		{
			"ID": "20221201100220-lv2pqbb",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201100220-lv2pqbb",
				"updated": "20221201100334"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "\n#kubectl ko sb status\n3722\nName: OVN_Southbound\nCluster ID: d4bd (d4bd37a4-0400-499f-b4df-b4fd389780f0)\nServer ID: 3722 (3722d5ae-2ced-4820-a6b2-8b744d11fb3e)\nAddress: tcp:[172.18.0.3]:6644\nStatus: cluster member\nRole: leader\nTerm: 1\nLeader: self\nVote: self\n\nLast Election started 2395317 ms ago, reason: timeout\nLast Election won: 2395316 ms ago\nElection timer: 5000\nLog: [130, 130]\nEntries not yet committed: 0\nEntries not yet applied: 0\nConnections: \u003c-e9f7 -\u003ee9f7 \u003c-6e84 -\u003e6e84\nDisconnections: 0\nServers:\n    e9f7 (e9f7 at tcp:[172.18.0.5]:6644) next_index=130 match_index=129 last msg 1006 ms ago\n    6e84 (6e84 at tcp:[172.18.0.4]:6644) next_index=130 match_index=129 last msg 1004 ms ago\n    3722 (3722 at tcp:[172.18.0.3]:6644) (self) next_index=2 match_index=129\nstatus: ok\nkube-ovn-control-plane2 对应节点 IP 为 172.18.0.5，集群内对应的 ID 为 e9f7。接下来从 ovn-sb 集群中踢出该节点：\n\n\n# kubectl ko sb kick e9f7\nstarted removal\n确认节点踢出成功：\n\n\n# kubectl ko sb status\n3722\nName: OVN_Southbound\nCluster ID: d4bd (d4bd37a4-0400-499f-b4df-b4fd389780f0)\nServer ID: 3722 (3722d5ae-2ced-4820-a6b2-8b744d11fb3e)\nAddress: tcp:[172.18.0.3]:6644\nStatus: cluster member\nRole: leader\nTerm: 1\nLeader: self\nVote: self\n\nLast Election started 2481636 ms ago, reason: timeout\nLast Election won: 2481635 ms ago\nElection timer: 5000\nLog: [131, 131]\nEntries not yet committed: 0\nEntries not yet applied: 0\nConnections: \u003c-6e84 -\u003e6e84\nDisconnections: 2\nServers:\n    6e84 (6e84 at tcp:[172.18.0.4]:6644) next_index=131 match_index=130 last msg 642 ms ago\n    3722 (3722 at tcp:[172.18.0.3]:6644) (self) next_index=2 match_index=130\nstatus: ok\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201100209-gg2rvd6",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201100209-gg2rvd6",
				"updated": "20221201100357"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.1.3 删除节点标签，并缩容 ovn-central"
				}
			]
		},
		{
			"ID": "20221201100413-vnktonp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201100413-vnktonp",
				"updated": "20221201100413"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "需在 ovn-central 环境变量 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "NODE_IPS"
				},
				{
					"Type": "NodeText",
					"Data": " 的节点地址中删除下线节点。"
				}
			]
		},
		{
			"ID": "20221201100413-6az4i6h",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201100413-6az4i6h",
				"updated": "20221201100413"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl label node kube-ovn-control-plane2 kube-ovn/role-\nkubectl scale deployment -n kube-system ovn-central --replicas=2\nkubectl set env deployment/ovn-central -n kube-system NODE_IPS=\"172.18.0.3,172.18.0.4\"\nkubectl rollout status deployment/ovn-central -n kube-system \n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201100411-is19csb",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201100411-is19csb",
				"updated": "20221201100515"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.1.4 修改 kube-ovn-controller 内连接信息，删除下线节点地址。"
				}
			]
		},
		{
			"ID": "20221201100459-kdrbjfw",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201100459-kdrbjfw",
				"updated": "20221201100513"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl set env deployment/kube-ovn-controller -n kube-system OVN_DB_IPS=\"172.18.0.3,172.18.0.4\"\ndeployment.apps/kube-ovn-controller env updated\n\n# kubectl rollout status deployment/kube-ovn-controller -n kube-system\nWaiting for deployment \"kube-ovn-controller\" rollout to finish: 1 of 3 updated replicas are available...\nWaiting for deployment \"kube-ovn-controller\" rollout to finish: 2 of 3 updated replicas are available...\ndeployment \"kube-ovn-controller\" successfully rolled out\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201100459-3y2wgpv",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201100459-3y2wgpv",
				"updated": "20221201100544"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.1.5 清理节点"
				}
			]
		},
		{
			"ID": "20221201100559-6ehnv22",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201100559-6ehnv22",
				"updated": "20221201100559"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "删除 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-control-plane2"
				},
				{
					"Type": "NodeText",
					"Data": " 节点内的数据库文件，避免重复添加节点时发生异常："
				}
			]
		},
		{
			"ID": "20221201100559-2mvi1zq",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201100559-2mvi1zq",
				"updated": "20221201100559"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "rm -rf /etc/origin/ovn\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201100559-p1k0yxk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201100559-p1k0yxk",
				"updated": "20221201100559"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如需将节点从整个 Kubernetes 集群下线，还需继续参考"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/delete-worker-node/",
					"TextMarkTextContent": "删除工作节点"
				},
				{
					"Type": "NodeText",
					"Data": "进行操作。"
				}
			]
		},
		{
			"ID": "20221201095926-jz6dzvl",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221201095926-jz6dzvl",
				"updated": "20221201095938"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.2 ovn-central节点上线"
				}
			]
		},
		{
			"ID": "20221201100145-8xq2dzp",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201100145-8xq2dzp",
				"updated": "20221201102050"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.2.1 目录检查"
				}
			]
		},
		{
			"ID": "20221201101927-9kjaxaa",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201101927-9kjaxaa",
				"updated": "20221201101927"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "检查新增节点的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "/etc/origin/ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 目录中是否存在 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovnnb_db.db"
				},
				{
					"Type": "NodeText",
					"Data": " 或 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovnsb_db.db"
				},
				{
					"Type": "NodeText",
					"Data": " 文件，若存在需提前删除："
				}
			]
		},
		{
			"ID": "20221201101927-thz7yim",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201101927-thz7yim",
				"updated": "20221201101927"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "rm -rf /etc/origin/ovn\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201101848-qq2wh0x",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201101848-qq2wh0x",
				"updated": "20221201101916"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.2.2 确认当前ovn-central集群状态正常"
				}
			]
		},
		{
			"ID": "20221201101951-emm7cby",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201101951-emm7cby",
				"updated": "20221201101951"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若当前 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 集群状态已经异常，新增节点可能导致投票选举无法过半数，影响后续操作。"
				}
			]
		},
		{
			"ID": "20221201101951-lz6if7c",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201101951-lz6if7c",
				"updated": "20221201101951"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb status\n1b9a\nName: OVN_Northbound\nCluster ID: 32ca (32ca07fb-739b-4257-b510-12fa18e7cce8)\nServer ID: 1b9a (1b9a5d76-e69b-410c-8085-39943d0cd38c)\nAddress: tcp:[172.18.0.3]:6643\nStatus: cluster member\nRole: leader\nTerm: 44\nLeader: self\nVote: self\n\nLast Election started 1855739 ms ago, reason: timeout\nLast Election won: 1855729 ms ago\nElection timer: 5000\nLog: [147, 147]\nEntries not yet committed: 0\nEntries not yet applied: 0\nConnections: -\u003e4984 \u003c-4984\nDisconnections: 0\nServers:\n    4984 (4984 at tcp:[172.18.0.4]:6643) next_index=147 match_index=146 last msg 367 ms ago\n    1b9a (1b9a at tcp:[172.18.0.3]:6643) (self) next_index=140 match_index=146\nstatus: ok\n\n# kubectl ko sb status\n3722\nName: OVN_Southbound\nCluster ID: d4bd (d4bd37a4-0400-499f-b4df-b4fd389780f0)\nServer ID: 3722 (3722d5ae-2ced-4820-a6b2-8b744d11fb3e)\nAddress: tcp:[172.18.0.3]:6644\nStatus: cluster member\nRole: leader\nTerm: 33\nLeader: self\nVote: self\n\nLast Election started 1868589 ms ago, reason: timeout\nLast Election won: 1868579 ms ago\nElection timer: 5000\nLog: [142, 142]\nEntries not yet committed: 0\nEntries not yet applied: 0\nConnections: -\u003e6e84 \u003c-6e84\nDisconnections: 0\nServers:\n    6e84 (6e84 at tcp:[172.18.0.4]:6644) next_index=142 match_index=141 last msg 728 ms ago\n    3722 (3722 at tcp:[172.18.0.3]:6644) (self) next_index=134 match_index=141\nstatus: ok\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201102022-t1t5o5o",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201102022-t1t5o5o",
				"updated": "20221201102118"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.2.3 给节点增加标签并扩容"
				}
			]
		},
		{
			"ID": "20221201102132-c6me97d",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201102132-c6me97d",
				"updated": "20221201102132"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "需在 ovn-central 环境变量 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "NODE_IPS"
				},
				{
					"Type": "NodeText",
					"Data": " 的节点地址中增加上线节点地址。"
				}
			]
		},
		{
			"ID": "20221201102132-gbxuuni",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201102132-gbxuuni",
				"updated": "20221201102132"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl label node kube-ovn-control-plane2 kube-ovn/role=master\nkubectl scale deployment -n kube-system ovn-central --replicas=3\nkubectl set env deployment/ovn-central -n kube-system NODE_IPS=\"172.18.0.3,172.18.0.4,172.18.0.5\"\nkubectl rollout status deployment/ovn-central -n kube-system\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201102147-eun3h48",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221201102147-eun3h48",
				"updated": "20221201102201"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.2.4 修改其他组件连接 ovn-central 地址"
				}
			]
		},
		{
			"ID": "20221201102224-g5e3e5a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201102224-g5e3e5a",
				"updated": "20221201102224"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovs-ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 内连接信息，增加上线节点地址："
				}
			]
		},
		{
			"ID": "20221201102224-u4b6rcj",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201102224-u4b6rcj",
				"updated": "20221201102224"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl set env daemonset/ovs-ovn -n kube-system OVN_DB_IPS=\"172.18.0.3,172.18.0.4,172.18.0.5\"\ndaemonset.apps/ovs-ovn env updated\n# kubectl delete pod -n kube-system -lapp=ovs\npod \"ovs-ovn-4f6jc\" deleted\npod \"ovs-ovn-csn2w\" deleted\npod \"ovs-ovn-mpbmb\" deleted\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221201102343-je9645f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221201102343-je9645f",
				"updated": "20221201102343"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改 kube-ovn-controller 内连接信息，增加上线节点地址："
				}
			]
		},
		{
			"ID": "20221201102249-k69y1ue",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221201102249-k69y1ue",
				"updated": "20221201102249"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl set env deployment/kube-ovn-controller -n kube-system OVN_DB_IPS=\"172.18.0.3,172.18.0.4,172.18.0.5\"\ndeployment.apps/kube-ovn-controller env updated\n\n# kubectl rollout status deployment/kube-ovn-controller -n kube-system\nWaiting for deployment \"kube-ovn-controller\" rollout to finish: 1 of 3 updated replicas are available...\nWaiting for deployment \"kube-ovn-controller\" rollout to finish: 2 of 3 updated replicas are available...\ndeployment \"kube-ovn-controller\" successfully rolled out\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204004257-6zpbs2y",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221204004257-6zpbs2y",
				"updated": "20221204100709"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4. OVN数据库备份和恢复"
				}
			]
		},
		{
			"ID": "20221204100759-ef033ob",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221204100759-ef033ob",
				"updated": "20221204100813"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.1 数据库备份"
				}
			]
		},
		{
			"ID": "20221204100846-tbt4v1i",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204100846-tbt4v1i",
				"updated": "20221204100846"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "利用 kubectl 插件的 backup 命令可以对数据库文件进行备份，以用于故障时恢复："
				}
			]
		},
		{
			"ID": "20221204100846-iuuy2ym",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204100846-iuuy2ym",
				"updated": "20221204100856"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb backup\ntar: Removing leading `/' from member names\nbackup ovn-nb db to /root/ovnnb_db.060223191654183154.backup\n\n# kubectl ko sb backup\ntar: Removing leading `/' from member names\nbackup ovn-nb db to /root/ovnsb_db.060223191654183154.backup\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204100816-9ru9ii8",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221204100816-9ru9ii8",
				"updated": "20221204100831"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.2 集群部分故障恢复"
				}
			]
		},
		{
			"ID": "20221204111730-sd95gft",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204111730-sd95gft",
				"updated": "20221204111749"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若集群中存在部分节点因为断电，文件系统故障或磁盘空间不足导致工作异常， 但是集群仍可正常工作可以通过如下步骤进行恢复"
				}
			]
		},
		{
			"ID": "20221204111715-uzvmeiy",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221204111715-uzvmeiy",
				"updated": "20221204111859"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.2.1 查看日志确认状态异常"
				}
			]
		},
		{
			"ID": "20221204111904-hev3a1f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204111904-hev3a1f",
				"updated": "20221204111904"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看对应节点 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "/var/log/ovn/ovn-northd.log"
				},
				{
					"Type": "NodeText",
					"Data": "，若提示类似错误则可判断数据库存在异常"
				}
			]
		},
		{
			"ID": "20221204111904-5su40t0",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204111904-5su40t0",
				"updated": "20221204111914"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "* ovn-northd is not running\novsdb-server: ovsdb error: error reading record 2739 from OVN_Northbound log: record 2739 advances commit index to 6308 but last log index is 6307\n * Starting ovsdb-nb\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204112011-xaq0xa5",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221204112011-xaq0xa5",
				"updated": "20221204112035"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.2.2 从集群中踢出对应节点"
				}
			]
		},
		{
			"ID": "20221204112036-7pig9d0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204112036-7pig9d0",
				"updated": "20221204112104"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "根据日志提示是 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "OVN_Northbound"
				},
				{
					"Type": "NodeText",
					"Data": " 还是 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "OVN_Southbound"
				},
				{
					"Type": "NodeText",
					"Data": " 选择对应的数据库进行操作。 上述日志提示为 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "OVN_Northbound"
				},
				{
					"Type": "NodeText",
					"Data": " 则对 ovn-nb 进行操作："
				}
			]
		},
		{
			"ID": "20221204112126-4bwsosv",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204112126-4bwsosv",
				"updated": "20221204112130"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl ko nb status\n9182\nName: OVN_Northbound\nCluster ID: e75f (e75fa340-49ed-45ab-990e-26cb865ebc85)\nServer ID: 9182 (9182e8dd-b5b0-4dd8-8518-598cc1e374f3)\nAddress: tcp:[10.0.128.61]:6643\nStatus: cluster member\nRole: leader\nTerm: 1454\nLeader: self\nVote: self\n\nLast Election started 1732603 ms ago, reason: timeout\nLast Election won: 1732587 ms ago\nElection timer: 1000\nLog: [7332, 12512]\nEntries not yet committed: 1\nEntries not yet applied: 1\nConnections: -\u003ef080 \u003c-f080 \u003c-e631 -\u003ee631\nDisconnections: 1\nServers:\n    f080 (f080 at tcp:[10.0.129.139]:6643) next_index=12512 match_index=12510 last msg 63 ms ago\n    9182 (9182 at tcp:[10.0.128.61]:6643) (self) next_index=10394 match_index=12510\n    e631 (e631 at tcp:[10.0.131.173]:6643) next_index=12512 match_index=0\n\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204112147-gpcus5n",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204112147-gpcus5n",
				"updated": "20221204112147"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "从集群中踢出状态异常节点："
				}
			]
		},
		{
			"ID": "20221204112147-l609w2d",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204112147-l609w2d",
				"updated": "20221204112147"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl ko nb kick e631\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204112147-6ixglyi",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204112147-6ixglyi",
				"updated": "20221204112147"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "登录异常节点，删除对应的数据库文件："
				}
			]
		},
		{
			"ID": "20221204112147-32ut9sa",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204112147-32ut9sa",
				"updated": "20221204112147"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "mv /etc/origin/ovn/ovnnb_db.db /tmp\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204112147-8gusibe",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204112147-8gusibe",
				"updated": "20221204112147"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "删除对应节点的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " Pod，等待集群自动恢复："
				}
			]
		},
		{
			"ID": "20221204112147-zaqhdrv",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204112147-zaqhdrv",
				"updated": "20221204112147"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl delete pod -n kube-system ovn-central-xxxx\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204220540-wazf1qk",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221204220540-wazf1qk",
				"updated": "20221204223046"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.3 集群不能正常工作下的恢复"
				}
			]
		},
		{
			"ID": "20221204223111-72w9yst",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204223111-72w9yst",
				"updated": "20221204223112"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若集群多数节点受损无法选举出 leader，请参照下面的步骤进行恢复。"
				}
			]
		},
		{
			"ID": "20221204223119-hxord65",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221204223119-hxord65",
				"updated": "20221204223214"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.3.1 停止 ovn-central"
				}
			]
		},
		{
			"ID": "20221204223230-688m4dg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204223230-688m4dg",
				"updated": "20221204223230"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "记录当前 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 副本数量，并停止 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 避免新的数据库变更影响恢复："
				}
			]
		},
		{
			"ID": "20221204223230-rrcfu4d",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204223230-rrcfu4d",
				"updated": "20221204223240"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl scale deployment -n kube-system ovn-central --replicas=0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204223245-0nsxutd",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221204223245-0nsxutd",
				"updated": "20221204223257"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.3.2 选择备份"
				}
			]
		},
		{
			"ID": "20221204223331-18yhzbk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204223331-18yhzbk",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "由于多数节点受损，需要从某个数据库文件进行恢复重建集群。如果之前备份过数据库 可使用之前的备份文件进行恢复。如果没有进行过备份可以使用下面的步骤从已有的数据库文件 中生成一个备份。"
				}
			]
		},
		{
			"ID": "20221204223331-w1w4dn7",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221204223331-w1w4dn7",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221204223331-289qf5o",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221204223331-289qf5o"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "由于默认文件夹下的数据库文件为集群格式数据库文件，包含当前集群的信息，无法直接 用该文件重建数据库，需要使用 "
						},
						{
							"Type": "NodeTextMark",
							"TextMarkType": "code",
							"TextMarkTextContent": "ovsdb-tool cluster-to-standalone"
						},
						{
							"Type": "NodeText",
							"Data": " 进行格式转换。"
						}
					]
				}
			]
		},
		{
			"ID": "20221204223331-ia6jpvf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204223331-ia6jpvf",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "选择 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 环境变量 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "NODE_IPS"
				},
				{
					"Type": "NodeText",
					"Data": " 中排第一的节点恢复数据库文件， 如果第一个节点数据库文件已损坏，从其他机器 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "/etc/origin/ovn"
				},
				{
					"Type": "NodeText",
					"Data": " 下复制文件到第一台机器 ， 执行下列命令生成数据库文件备份。"
				}
			]
		},
		{
			"ID": "20221204223331-9d7arg0",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204223331-9d7arg0",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "docker run -it -v /etc/origin/ovn:/etc/ovn kubeovn/kube-ovn:v1.10.7 bash\ncd /etc/ovn/\novsdb-tool cluster-to-standalone ovnnb_db_standalone.db ovnnb_db.db\novsdb-tool cluster-to-standalone ovnsb_db_standalone.db ovnsb_db.db\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204223331-1zz3jo2",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221204223331-1zz3jo2",
				"updated": "20221204223625"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.3.3 删除每个 ovn-central 节点上的数据库文件"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/recover-db/#ovn-central_1",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221204223331-tqbp5n7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204223331-tqbp5n7",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "为了避免重建集群时使用到错误的数据，需要对已有数据库文件进行清理："
				}
			]
		},
		{
			"ID": "20221204223331-08ikzle",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204223331-08ikzle",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "mv /etc/origin/ovn/ovnnb_db.db /tmp\nmv /etc/origin/ovn/ovnsb_db.db /tmp\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204223331-8pw5hvt",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221204223331-8pw5hvt",
				"updated": "20221204223631"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.3.4 恢复数据库集群"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/recover-db/#_7",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221204223331-4gcs73w",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204223331-4gcs73w",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "将备份数据库分别重命名为 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovnnb_db.db"
				},
				{
					"Type": "NodeText",
					"Data": " 和 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovnsb_db.db"
				},
				{
					"Type": "NodeText",
					"Data": "，并复制到 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 环境变量 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "NODE_IPS"
				},
				{
					"Type": "NodeText",
					"Data": " 中排第一机器的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "/etc/origin/ovn/"
				},
				{
					"Type": "NodeText",
					"Data": " 目录下："
				}
			]
		},
		{
			"ID": "20221204223331-od736td",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204223331-od736td",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "mv /etc/origin/ovn/ovnnb_db_standalone.db /etc/origin/ovn/ovnnb_db.db\nmv /etc/origin/ovn/ovnsb_db_standalone.db /etc/origin/ovn/ovnsb_db.db\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204223331-s46bjvm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221204223331-s46bjvm",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "恢复 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn-central"
				},
				{
					"Type": "NodeText",
					"Data": " 的副本数："
				}
			]
		},
		{
			"ID": "20221204223331-ou0m0us",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221204223331-ou0m0us",
				"updated": "20221204223331"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl scale deployment -n kube-system ovn-central --replicas=3\nkubectl rollout status deployment/ovn-central -n kube-system\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221204223722-t4oze8f",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221204223722-t4oze8f",
				"updated": "20221205001845"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5. 修改子网CIDR"
				}
			]
		},
		{
			"ID": "20221205001851-c8bp45j",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205001851-c8bp45j",
				"updated": "20221205001919"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果创建的子网 CIDR 冲突或不符合预期，可以通过本文档的步骤进行修改。"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "mark",
					"TextMarkTextContent": "修改子网 CIDR 后之前创建的 Pod 将无法正常访问网络需要进行重建。"
				}
			]
		},
		{
			"ID": "20221205001929-ao0qgfv",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205001929-ao0qgfv",
				"updated": "20221205001943"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.1 编辑子网"
				}
			]
		},
		{
			"ID": "20221205002016-pd4pnvp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002016-pd4pnvp",
				"updated": "20221205002016"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "使用 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kubectl edit"
				},
				{
					"Type": "NodeText",
					"Data": " 修改子网 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "cidrBlock"
				},
				{
					"Type": "NodeText",
					"Data": "，"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "gateway"
				},
				{
					"Type": "NodeText",
					"Data": " 和 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "excludeIps"
				},
				{
					"Type": "NodeText",
					"Data": "。"
				}
			]
		},
		{
			"ID": "20221205002016-1zkt585",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002016-1zkt585",
				"updated": "20221205002016"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl edit subnet test-subnet\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205001943-r3p61y5",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205001943-r3p61y5",
				"updated": "20221205002002"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.2 重建该子网绑定的 Namespace 下所有 Pod"
				}
			]
		},
		{
			"ID": "20221205002029-tkorx9y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002029-tkorx9y",
				"updated": "20221205002029"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "以子网绑定 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "test"
				},
				{
					"Type": "NodeText",
					"Data": " Namespace 为例："
				}
			]
		},
		{
			"ID": "20221205002029-jt7pc2i",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002029-jt7pc2i",
				"updated": "20221205002029"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "for pod in $(kubectl get pod --no-headers -n \"$ns\" --field-selector spec.restartPolicy=Always -o custom-columns=NAME:.metadata.name,HOST:spec.hostNetwork | awk '{if ($2!=\"true\") print $1}'); do\n  kubectl delete pod \"$pod\" -n test --ignore-not-found\ndone\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002107-kcv8pei",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002107-kcv8pei",
				"updated": "20221205002107"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若只使用了默认子网，可以使用下列命令删除所有非 host 网络模式的 Pod："
				}
			]
		},
		{
			"ID": "20221205002107-6djqciw",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002107-6djqciw",
				"updated": "20221205002107"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "for ns in $(kubectl get ns --no-headers -o custom-columns=NAME:.metadata.name); do\n  for pod in $(kubectl get pod --no-headers -n \"$ns\" --field-selector spec.restartPolicy=Always -o custom-columns=NAME:.metadata.name,HOST:spec.hostNetwork | awk '{if ($2!=\"true\") print $1}'); do\n    kubectl delete pod \"$pod\" -n \"$ns\" --ignore-not-found\n  done\ndone\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002159-6a37cse",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205002159-6a37cse",
				"updated": "20221205002217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.3 更改默认子网配置"
				}
			]
		},
		{
			"ID": "20221205002222-nibkpfx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002222-nibkpfx",
				"updated": "20221205002222"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若修改的为默认子网的 CIDR 还需要更改 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-controller"
				},
				{
					"Type": "NodeText",
					"Data": " Deployment 的启动参数："
				}
			]
		},
		{
			"ID": "20221205002222-abjdb0t",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002222-abjdb0t",
				"updated": "20221205002232"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "args:\n- --default-cidr=10.17.0.0/16\n- --default-gateway=10.17.0.1\n- --default-exclude-ips=10.17.0.1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002336-ufhfqo7",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205002336-ufhfqo7",
				"updated": "20221205002354"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "6. 修改Join子网CIDR"
				}
			]
		},
		{
			"ID": "20221205002354-ap4h0ra",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002354-ap4h0ra",
				"updated": "20221205002412"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改 Join 子网 CIDR 后之前创建的 Pod 将无法正常访问外部网络，需要等重建完成, 建议前操作时慎重考虑。"
				}
			]
		},
		{
			"ID": "20221205002405-9po1k6h",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205002405-9po1k6h",
				"updated": "20221205002429"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "6.1 删除Join子网"
				}
			]
		},
		{
			"ID": "20221205002507-vhacouh",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002507-vhacouh",
				"updated": "20221205002520"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "XA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl patch subnet join --type='json' -p '[{\"op\": \"replace\", \"path\": \"/metadata/finalizers\", \"value\": []}]'\nkubectl delete subnet join\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002536-buyhumq",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205002536-buyhumq",
				"updated": "20221205002610"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "6.2 清理相关分配信息"
				}
			]
		},
		{
			"ID": "20221205002536-sfdo240",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002536-sfdo240",
				"updated": "20221205002536"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl annotate node ovn.kubernetes.io/allocated=false --all --overwrite\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002558-ke481cv",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205002558-ke481cv",
				"updated": "20221205002609"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "6.3 删除 Join 子网路由"
				}
			]
		},
		{
			"ID": "20221205002558-tj9zsp2",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002558-tj9zsp2",
				"updated": "20221205002558"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl ko nbctl lr-route-del ovn-cluster 0.0.0.0/0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002558-rtmk9bi",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002558-rtmk9bi",
				"updated": "20221205002558"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "或者进入 ovn-central leader 的 pod 内："
				}
			]
		},
		{
			"ID": "20221205002558-ah628j0",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002558-ah628j0",
				"updated": "20221205002558"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ovn-nbctl lr-route-del ovn-cluster 0.0.0.0/0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002631-tw5hh5n",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205002631-tw5hh5n",
				"updated": "20221205002639"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "6.4 修改 Join 子网相关信息"
				}
			]
		},
		{
			"ID": "20221205002631-lpk7oq7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002631-lpk7oq7",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-controller"
				},
				{
					"Type": "NodeText",
					"Data": " 内 Join 子网相关信息："
				}
			]
		},
		{
			"ID": "20221205002631-ffneedz",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002631-ffneedz",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl edit deployment -n kube-system kube-ovn-controller\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002631-jaokaj3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002631-jaokaj3",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改下列参数："
				}
			]
		},
		{
			"ID": "20221205002631-vbph3hf",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002631-vbph3hf",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "args:\n---node-switch-cidr=100.51.0.0/16\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002631-7k5jhqi",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002631-7k5jhqi",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "重启 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-controller"
				},
				{
					"Type": "NodeText",
					"Data": " 重建 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "join"
				},
				{
					"Type": "NodeText",
					"Data": " 子网："
				}
			]
		},
		{
			"ID": "20221205002631-oxu81s0",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002631-oxu81s0",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl delete pod -n kube-system -lapp=kube-ovn-controller\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002631-t68htlw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002631-t68htlw",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看新的 Join 子网信息："
				}
			]
		},
		{
			"ID": "20221205002631-ksshlim",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002631-ksshlim",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# kubectl get subnet\nNAME          PROVIDER   VPC           PROTOCOL   CIDR            PRIVATE   NAT     DEFAULT   GATEWAYTYPE   V4USED   V4AVAILABLE   V6USED   V6AVAILABLE   EXCLUDEIPS\njoin          ovn        ovn-cluster   IPv4       100.51.0.0/16   false     false   false     distributed   2        65531         0        0             [\"100.51.0.1\"]\novn-default   ovn        ovn-cluster   IPv4       10.17.0.0/16    false     true    true      distributed   5        65528         0        0             [\"10.17.0.1\"]\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205002631-4zc7ly8",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205002631-4zc7ly8",
				"updated": "20221205003030"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "6.5 重新配置 ovn0 网卡地址"
				}
			]
		},
		{
			"ID": "20221205002631-ovn251m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205002631-ovn251m",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "每个节点的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "ovn0"
				},
				{
					"Type": "NodeText",
					"Data": " 网卡信息需要重新更新，可通过重启 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "kube-ovn-cni"
				},
				{
					"Type": "NodeText",
					"Data": " 来完成："
				}
			]
		},
		{
			"ID": "20221205002631-al045op",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205002631-al045op",
				"updated": "20221205002631"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl delete pod -n kube-system -l app=kube-ovn-cni\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003052-bc4m2io",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221205003052-bc4m2io",
				"updated": "20221205003109"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7. 卸载Calico安装Kube-OVN"
				}
			]
		},
		{
			"ID": "20221205003110-5cshby5",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205003110-5cshby5",
				"updated": "20221205003146"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.1准备工作"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/from-calico/#_1",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221205003110-5n4ahhf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003110-5n4ahhf",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "为了保证切换 CNI 过程中集群网络保持畅通，Calico ippool 需要开启 nat outgoing，"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "或"
				},
				{
					"Type": "NodeText",
					"Data": "在所有节点上关闭 rp_filter："
				}
			]
		},
		{
			"ID": "20221205003110-6tdozhd",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-6tdozhd",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "sysctl net.ipv4.conf.all.rp_filter=0\nsysctl net.ipv4.conf.default.rp_filter=0\n# IPIP 模式\nsysctl net.ipv4.conf.tunl0.rp_filter=0\n# VXLAN 模式\nsysctl net.ipv4.conf.vxlan/calico.rp_filter=0\n# 路由模式，eth0 需要修改为实际使用的网卡\nsysctl net.ipv4.conf.eth0.rp_filter=0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-hcmfqs2",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205003110-hcmfqs2",
				"updated": "20221205003155"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.2 部署 Kube-OVN"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/from-calico/#kube-ovn",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221205003110-o9g27la",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221205003110-o9g27la",
				"updated": "20221205003201"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.2.1 下载安装脚本"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/from-calico/#_2",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221205003110-uiy04yn",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-uiy04yn",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "wget https://raw.githubusercontent.com/kubeovn/kube-ovn/release-1.10/dist/images/install.sh\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-apy4xk3",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221205003110-apy4xk3",
				"updated": "20221205003209"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.2.2 修改安装脚本"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/from-calico/#_3",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221205003110-cq5mgv2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003110-cq5mgv2",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "将安装脚本中重建 Pod 的部分删除："
				}
			]
		},
		{
			"ID": "20221205003110-cvpwgij",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-cvpwgij",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "echo \"[Step 4/6] Delete pod that not in host network mode\"\nfor ns in $(kubectl get ns --no-headers -o custom-columns=NAME:.metadata.name); do\n  for pod in $(kubectl get pod --no-headers -n \"$ns\" --field-selector spec.restartPolicy=Always -o custom-columns=NAME:.metadata.name,HOST:spec.hostNetwork | awk '{if ($2!=\"true\") print $1}'); do\n    kubectl delete pod \"$pod\" -n \"$ns\" --ignore-not-found\n  done\ndone\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-hl602wu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003110-hl602wu",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "按需修改以下配置："
				}
			]
		},
		{
			"ID": "20221205003110-lh5mvet",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-lh5mvet",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "REGISTRY=\"kubeovn\"                     # 镜像仓库地址\nVERSION=\"v1.10.7\"                      # 镜像版本/Tag\nPOD_CIDR=\"10.16.0.0/16\"                # 默认子网 CIDR 不要和 SVC/NODE/JOIN CIDR 重叠\nSVC_CIDR=\"10.96.0.0/12\"                # 需要和 apiserver 的 service-cluster-ip-range 保持一致\nJOIN_CIDR=\"100.64.0.0/16\"              # Pod 和主机通信网络 CIDR，不要和 SVC/NODE/POD CIDR 重叠 \nLABEL=\"node-role.kubernetes.io/master\" # 部署 OVN DB 节点的标签\nIFACE=\"\"                               # 容器网络所使用的的宿主机网卡名，如果为空则使用 Kubernetes 中的 Node IP 所在网卡\nTUNNEL_TYPE=\"geneve\"                   # 隧道封装协议，可选 geneve, vxlan 或 stt，stt 需要单独编译 ovs 内核模块\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-uycr8i5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003110-uycr8i5",
				"updated": "20221205003248"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "注意"
				},
				{
					"Type": "NodeText",
					"Data": " ："
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "mark",
					"TextMarkTextContent": "POD_CIDR 及 JOIN_CIDR 不可与 Calico ippool 的 CIDR 冲突，且 POD_CIDR 需要包含足够多的 IP 来容纳集群中已有的 Pod。"
				}
			]
		},
		{
			"ID": "20221205003110-mj6e9b2",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221205003110-mj6e9b2",
				"updated": "20221205003307"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.2.3 执行安装脚本"
				}
			]
		},
		{
			"ID": "20221205003110-qm93142",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-qm93142",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "bash install.sh\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-u6djx3x",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205003110-u6djx3x",
				"updated": "20221205003319"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.3 逐个节点迁移"
				}
			]
		},
		{
			"ID": "20221205003110-ue6j4wl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003110-ue6j4wl",
				"updated": "20221205003326"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "按照以下方法为每个节点逐个进行迁移。  "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "注意"
				},
				{
					"Type": "NodeText",
					"Data": " ：命令中的 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "em",
					"TextMarkTextContent": "\u0026lt;NODE\u0026gt;"
				},
				{
					"Type": "NodeText",
					"Data": " 需要替换为节点名称。"
				}
			]
		},
		{
			"ID": "20221205003110-sd51pvp",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221205003110-sd51pvp",
				"updated": "20221205003332"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.3.1 驱逐节点"
				}
			]
		},
		{
			"ID": "20221205003110-pn1l5nb",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-pn1l5nb",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl drain --ignore-daemonsets \u003cNODE\u003e\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-ognzttf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003110-ognzttf",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "若此命令一直等待 Pod 被驱逐，执行以下命令强制删除被驱逐的 Pod："
				}
			]
		},
		{
			"ID": "20221205003110-kzwhe8l",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-kzwhe8l",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl get pod -A --field-selector=spec.nodeName=\u003cNODE\u003e --no-headers | \\\n    awk '$4==\"Terminating\" {print $1\" \"$2}' | \\\n    while read s; do kubectl delete pod --force -n $s; done\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-pgcpnri",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221205003110-pgcpnri",
				"updated": "20221205003405"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.3.2 重启节点"
				}
			]
		},
		{
			"ID": "20221205003110-33bo0hm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003110-33bo0hm",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在节点中执行："
				}
			]
		},
		{
			"ID": "20221205003110-c4i08kk",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-c4i08kk",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "shutdown -r 0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-qf3khth",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221205003110-qf3khth",
				"updated": "20221205003423"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.3.3 恢复节点"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/from-calico/#_8",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221205003110-sgh8qtu",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-sgh8qtu",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl uncordon \u003cNODE\u003e\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-d0yvbpm",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221205003110-d0yvbpm",
				"updated": "20221205003452"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.4 卸载 Calico"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/from-calico/#calico",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221205003110-548m7sb",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221205003110-548m7sb",
				"updated": "20221205003448"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.4.1 删除 k8s 资源"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://kubeovn.github.io/docs/v1.10.x/ops/from-calico/#k8s",
					"TextMarkATitle": "Permanent link",
					"TextMarkTextContent": "¶"
				}
			]
		},
		{
			"ID": "20221205003110-1bt0pok",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-1bt0pok",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl -n kube-system delete deploy calico-kube-controllers\nkubectl -n kube-system delete ds calico-node\nkubectl -n kube-system delete cm calico-config\n# 删除 CRD 及相关资源\nkubectl get crd -o jsonpath='{range .items[*]}{.metadata.name}{\"\\n\"}{end}' | while read crd; do\n  if ! echo $crd | grep '.crd.projectcalico.org$' \u003e/dev/null; then\n    continue\n  fi\n\n  for name in $(kubectl get $crd -o jsonpath='{.items[*].metadata.name}'); do\n    kubectl delete $crd $name\n  done\n  kubectl delete crd $crd\ndone\n# 其它资源\nkubectl delete --ignore-not-found clusterrolebinding calico-node calico-kube-controllers\nkubectl delete --ignore-not-found clusterrole calico-node calico-kube-controllers\nkubectl delete --ignore-not-found sa -n kube-system calico-kube-controllers calico-node\nkubectl delete --ignore-not-found pdb -n kube-system calico-kube-controllers\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003110-r3n0skv",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221205003110-r3n0skv",
				"updated": "20221205003501"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "7.4.2 清理节点文件"
				}
			]
		},
		{
			"ID": "20221205003110-nkrymxq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003110-nkrymxq",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在每个节点中执行："
				}
			]
		},
		{
			"ID": "20221205003110-7rfabcj",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221205003110-7rfabcj",
				"updated": "20221205003110"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "rm -f /etc/cni/net.d/10-calico.conflist /etc/cni/net.d/calico-kubeconfig\nrm -f /opt/cni/bin/calico /opt/cni/bin/calico-ipam\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221205003506-qcpueub",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221205003506-qcpueub",
				"updated": "20221205003506"
			}
		}
	]
}