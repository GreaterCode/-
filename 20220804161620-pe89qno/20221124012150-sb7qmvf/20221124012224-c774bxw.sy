{
	"ID": "20221124012224-c774bxw",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20221124012224-c774bxw",
		"title": "Kubernetes 网络插件 Calico 完全运维指南",
		"updated": "20221124013612"
	},
	"Children": [
		{
			"ID": "20221124012224-wzzvl7f",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20221124012224-wzzvl7f"
			}
		},
		{
			"ID": "20221124012224-r4n0ka4",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221124012224-r4n0ka4",
				"updated": "20221124012224"
			},
			"Children": [
				{
					"ID": "20221124012224-b9juk24",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-b9juk24"
					},
					"Children": [
						{
							"ID": "20221124012224-q88w87x",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-q88w87x"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://zhuanlan.zhihu.com/p/524772977",
									"TextMarkTextContent": "https://zhuanlan.zhihu.com/p/524772977 - 知乎专栏"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-b0zfigj",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20221124012224-b0zfigj"
			}
		},
		{
			"ID": "20221124012224-tzxwdga",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-tzxwdga"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "适用范围"
				}
			]
		},
		{
			"ID": "20221124012224-k06jxw5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-k06jxw5"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "本文档测试范围："
				}
			]
		},
		{
			"ID": "20221124012224-ugjtul4",
			"Type": "NodeTable",
			"TableAligns": [
				0,
				0
			],
			"Properties": {
				"id": "20221124012224-ugjtul4"
			},
			"Children": [
				{
					"Type": "NodeTableHead",
					"Data": "thead",
					"Children": [
						{
							"Type": "NodeTableRow",
							"Data": "tr",
							"Children": [
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"Children": [
										{
											"Type": "NodeText",
											"Data": "软件"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"Children": [
										{
											"Type": "NodeText",
											"Data": "版本"
										}
									]
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Kubernetes"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "v1.14.x,v1.15.x,v1.16.x"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "calico"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "v3.13.4"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-witi5gc",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-witi5gc"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "概述"
				}
			]
		},
		{
			"ID": "20221124012224-8srahlf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-8srahlf"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Calico 是一种开源网络和网络安全解决方案，适用于容器，虚拟机和基于主机的本机工作负载。Calico 支持广泛的平台，包括 Kubernetes，docker，OpenStack 和裸机服务。Calico 后端支持多种网络模式。"
				}
			]
		},
		{
			"ID": "20221124012224-kdzk4b4",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221124012224-kdzk4b4"
			},
			"Children": [
				{
					"ID": "20221124012224-w6dz4ne",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-w6dz4ne"
					},
					"Children": [
						{
							"ID": "20221124012224-9wsa1xe",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-9wsa1xe"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "BGP 模式：将节点做为虚拟路由器通过 BGP 路由协议来实现集群内容器之间的网络访问。"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-vrzzgei",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-vrzzgei"
					},
					"Children": [
						{
							"ID": "20221124012224-dvn2f7d",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-dvn2f7d"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "IPIP 模式：在原有 IP 报文中封装一个新的 IP 报文，新的 IP 报文中将源地址 IP 和目的地址 IP 都修改为对端宿主机 IP。"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-a1ll1c5",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-a1ll1c5"
					},
					"Children": [
						{
							"ID": "20221124012224-g2fe8ho",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-g2fe8ho"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "cross-subnet：Calico-ipip 模式和 calico-bgp 模式都有对应的局限性，对于一些主机跨子网而又无法使网络设备使用 BGP 的场景可以使用 cross-subnet 模式，实现同子网机器使用 calico-BGP 模式，跨子网机器使用 calico-ipip 模式。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-otdk4h0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-otdk4h0"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-713773bd725f8a169f1e5c4549c08d32_b-20221124012224-tcmvg0w.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-v6ssvj0",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-v6ssvj0"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "calico 切换 BGP 模式"
				}
			]
		},
		{
			"ID": "20221124012224-0o5kdlm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-0o5kdlm"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-1a8114d47bde02e99ef3167705afc153_b-20221124012224-bn81sdt.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-6jraqvs",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-6jraqvs"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "部署完成后默认使用 calico-ipip 的模式，通过在节点的路由即可得知，通往其他节点路由通过 tunl0 网卡出去"
				}
			]
		},
		{
			"ID": "20221124012224-it7veo9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-it7veo9"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-e401026865e8f98653a96bbcc44ac1ab_b-20221124012224-krll03u.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-2ntg1ko",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-2ntg1ko"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改为 BGP 网络模式，在 system 项目中修改 calico-node daemonset"
				}
			]
		},
		{
			"ID": "20221124012224-svnfrws",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-svnfrws"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-306248123d4c063cf9231a6172db71a1_b-20221124012224-glqqd49.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-gdqblbg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-gdqblbg"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-1249078d7b639253674569a666ac1c83_b-20221124012224-brr969r.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-2oql5p1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-2oql5p1"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "CALICO_IPV4POOL_IPIP"
				},
				{
					"Type": "NodeText",
					"Data": "改为 off，添加新环境变量"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "FELIX_IPINIPENABLED"
				},
				{
					"Type": "NodeText",
					"Data": "为 false"
				}
			]
		},
		{
			"ID": "20221124012224-v0d5dq8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-v0d5dq8"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-760b8f3e0f05d8f0b8b3a365ae9111f4_b-20221124012224-9lrlm7e.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-5jxrc4k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-5jxrc4k"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改完成后对节点进行重启，等待恢复后查看主机路由，与 ipip 最大区别在于去往其他节点的路由，由 Tunnel0 走向网络网卡。"
				}
			]
		},
		{
			"ID": "20221124012224-u4swo92",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-u4swo92"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-9903316060c5661716988b1e5ae2f511_b-20221124012224-60th614.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-gh295mw",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-gh295mw"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "calico 切换 cross-subnet 模式"
				}
			]
		},
		{
			"ID": "20221124012224-97yjriq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-97yjriq"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Calico-ipip 模式和 calico-bgp 模式都有对应的局限性，对于一些主机跨子网而又无法使网络设备使用 BGP 的场景可以使用 cross-subnet 模式，实现同子网机器使用 calico-BGP 模式，跨子网机器使用 calico-ipip 模式。"
				}
			]
		},
		{
			"ID": "20221124012224-mjbltgx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-mjbltgx"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "部署集群网络选择 calico 网络插件"
				}
			]
		},
		{
			"ID": "20221124012224-mjgi5k7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-mjgi5k7"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-82d7b1273e0103c9d4e7c330edb5b61b_b-20221124012224-fnksk21.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-apaj30u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-apaj30u"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "默认部署出来是 calico 的 ip-in-ip 的模式 查看宿主机网卡，会发现多了个 tunl0 网卡，这个是建立 ip 隧道的网卡"
				}
			]
		},
		{
			"ID": "20221124012224-42j6zxr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-42j6zxr"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-34e21fc9c2d6e492c3ccfad46150bc52_b-20221124012224-xjw4pws.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-ppk3x2x",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-ppk3x2x"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "去其他主机的路由都是走 tunl0 网卡出去"
				}
			]
		},
		{
			"ID": "20221124012224-nj0ju9m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-nj0ju9m"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-e565d5dd35b390006fea71a60d1a2dc7_b-20221124012224-prnpoe1.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-3v2mx43",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-3v2mx43"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "切换到 cross-subnet 模式"
				}
			]
		},
		{
			"ID": "20221124012224-n1bwcf2",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-n1bwcf2"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl edit ipPool/default-ipv4-ippool\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-2x8fygo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-2x8fygo"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "将 ipipMode 改为 crossSubnet"
				}
			]
		},
		{
			"ID": "20221124012224-h787ylq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-h787ylq"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-7ded546acda6bc2f0da26556d0dae719_b-20221124012224-ef08ov2.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-8tw882f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-8tw882f"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在 UI 将 calico-node 的 POD 删了重建"
				}
			]
		},
		{
			"ID": "20221124012224-c15do4t",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-c15do4t"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-ce96f75162adb0d159bd7c2d9934b36e_b-20221124012224-cj9sn3k.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-q3zqoz3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-q3zqoz3"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "重启检查 calico 网络"
				}
			]
		},
		{
			"ID": "20221124012224-vv00mri",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-vv00mri"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-291ddd83955d517a38232137be23303c_b-20221124012224-ipjfgiq.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-ujdr1nz",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-ujdr1nz"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "可以看见同子网的主机出口走的是 bgp，不同子网主机走的是 tunl0 网卡走 ipip 模式"
				}
			]
		},
		{
			"ID": "20221124012224-e4amo3d",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-e4amo3d"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "创建应用测试跨主机网络，在不同主机上互相 ping 测试，看看跨主机网络是否正常。"
				}
			]
		},
		{
			"ID": "20221124012224-f67v4hz",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-f67v4hz"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "配置 Route reflector"
				}
			]
		},
		{
			"ID": "20221124012224-7avaq48",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221124012224-7avaq48"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "安装 calicoctl"
				}
			]
		},
		{
			"ID": "20221124012224-4pil86n",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-4pil86n"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "安装方式有以下几种"
				}
			]
		},
		{
			"ID": "20221124012224-qrjv29r",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221124012224-qrjv29r"
			},
			"Children": [
				{
					"ID": "20221124012224-z30k16z",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-z30k16z"
					},
					"Children": [
						{
							"ID": "20221124012224-w9ikdli",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-w9ikdli"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Single host 上面 binary 安装"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-dsagha2",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-dsagha2"
					},
					"Children": [
						{
							"ID": "20221124012224-v30xc7v",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-v30xc7v"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Single host 上面 continer 安装"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-aq18hn9",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-aq18hn9"
					},
					"Children": [
						{
							"ID": "20221124012224-775x1py",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-775x1py"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "作为 k8s pod 运行"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-1mf2ao8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-1mf2ao8"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "实际经验："
				}
			]
		},
		{
			"ID": "20221124012224-i4jtm3e",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-i4jtm3e"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Binary 方式在集群里面的一台 worker 节点安装（比如 RR），calicoctl 会检测 bird/felix 的运行状态。在非 calico node 节点运行只能使用部分命令，不能运行 calico node 相关命令。"
				}
			]
		},
		{
			"ID": "20221124012224-l8243ub",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-l8243ub"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "通过配置 calicoctl 来对 calico 进行控制，通常情况下建议将"
				}
			]
		},
		{
			"ID": "20221124012224-ugtzamt",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-ugtzamt"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "curl -O -L  https://github.com/projectcalico/calicoctl/releases/download/v3.13.3/calicoctl\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-eq0l58q",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-eq0l58q"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "配置可执行权限"
				}
			]
		},
		{
			"ID": "20221124012224-9oy3f3u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-9oy3f3u"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "复制的/usr/bin/目录"
				}
			]
		},
		{
			"ID": "20221124012224-opg4h2o",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-opg4h2o"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "配置 calicoctl 连接 Kubernetes 集群"
				}
			]
		},
		{
			"ID": "20221124012224-5vbrcex",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-5vbrcex"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "export CALICO_DATASTORE_TYPE=kubernetes\nexport CALICO_KUBECONFIG=~/.kube/config\ncalicoctl node status\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-ndkuqnf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-ndkuqnf"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-fa249bc19bc37804259955914e83b71e_b-20221124012224-ioqggkm.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-ha6x02w",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221124012224-ha6x02w"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "calico node-to-node mesh"
				}
			]
		},
		{
			"ID": "20221124012224-30yy11k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-30yy11k",
				"updated": "20221124013612"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "默认情况下"
				},
				{
					"Type": "NodeText",
					"Data": " "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "mark",
					"TextMarkTextContent": "calico 采用 node-to-node mesh 方式"
				},
				{
					"Type": "NodeText",
					"Data": " "
				},
				{
					"Type": "NodeText",
					"Data": "，为了防止 BGP 路由环路，BGP 协议规定在一个 AS（自治系统）内部，IBGP 路由器之间只能传一跳路由信息，所以在一个 AS 内部，IBGP 路由器之间为了学习路由信息需要建立全互联的对等体关系，但是当一个 AS 规模很大的时候，这种全互联的对等体关系维护会大量消耗网络和 CPU 资源，所以这种情况下就需要建立路由反射器以减少 IBGP 路由器之间的对等体关系数量。"
				}
			]
		},
		{
			"ID": "20221124012224-it6l75z",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-it6l75z"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-f6f4aeac3f99dbb6262744ebdb46ee33_b-20221124012224-xbtculr.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-hk5z90g",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221124012224-hk5z90g"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "Route reflector 角色介绍"
				}
			]
		},
		{
			"ID": "20221124012224-m20ehp9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-m20ehp9"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "早期 calico 版本提供专门的 route reflector 镜像，在新版本 calico node 内置集成 route reflector 功能。Route reflector 可以是以下角色："
				}
			]
		},
		{
			"ID": "20221124012224-410lx5s",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221124012224-410lx5s"
			},
			"Children": [
				{
					"ID": "20221124012224-k825w8s",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-k825w8s"
					},
					"Children": [
						{
							"ID": "20221124012224-pv3vdzp",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-pv3vdzp"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "集群内部的 node 节点"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-34u70ss",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-34u70ss"
					},
					"Children": [
						{
							"ID": "20221124012224-vjlt4l4",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-vjlt4l4"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "集群外部节点运行 calico node"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-povkp5i",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-povkp5i"
					},
					"Children": [
						{
							"ID": "20221124012224-q7181yc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-q7181yc"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "其他支持 route reflector 的软件或者设备。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-xqnmg3q",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-xqnmg3q"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "这里以一个集群内部的 node 节点为例："
				}
			]
		},
		{
			"ID": "20221124012224-87ukjz9",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221124012224-87ukjz9"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "关闭 node-to-node mesh"
				}
			]
		},
		{
			"ID": "20221124012224-vfqo5jp",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-vfqo5jp"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat \u003c\u003cEOF | calicoctl apply -f -\n\napiVersion: projectcalico.org/v3\nkind: BGPConfiguration\nmetadata:\n name: default\nspec:\n  logSeverityScreen: Info\n  nodeToNodeMeshEnabled: false\n  asNumber: 63400\nEOF\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-fu8mpyv",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221124012224-fu8mpyv"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "设置 Route reflector"
				}
			]
		},
		{
			"ID": "20221124012224-9l9yn7l",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-9l9yn7l"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "配置 Route reflector 支持多种配置方式如：1、支持配置全局 BGP peer，。2、支持针对单个节点进行配置 BGP Peer。也可以将 calico 节点充当 Route reflector 这里以配置 calico 节点充当 Router reflector 为例。"
				}
			]
		},
		{
			"ID": "20221124012224-noid5fy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-noid5fy"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "配置节点充当 BGP Route Reflector"
				}
			]
		},
		{
			"ID": "20221124012224-9ww9er3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-9ww9er3"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "可将 Calico 节点配置为充当路由反射器。为此，要用作路由反射器的每个节点必须具有群集 ID-通常是未使用的 IPv4 地址。"
				}
			]
		},
		{
			"ID": "20221124012224-q3u6wel",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-q3u6wel"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "要将节点配置为集群 ID 为 244.0.0.1 的路由反射器，请运行以下命令。这里将节点名为 rke-node4 的节点配置为 Route Reflector，若一个集群中要配置主备 rr，为了防止 rr 之间的路由环路，需要将集群 ID 配置成一样"
				}
			]
		},
		{
			"ID": "20221124012224-s73q7xt",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-s73q7xt"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "calicoctl patch node rke-node4 -p '{\"spec\": {\"bgp\": {\"routeReflectorClusterID\": \"244.0.0.1\"}}}'\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-yb08w4h",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-yb08w4h"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "给节点打上对应的 label 标记该节点以表明它是 Route Reflector，从而允许 BGPPeer 资源选择它。"
				}
			]
		},
		{
			"ID": "20221124012224-kuz3tly",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-kuz3tly"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl label node rke-node4 route-reflector=true\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-ut0rvk6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-ut0rvk6"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "创建 BGPPeer"
				}
			]
		},
		{
			"ID": "20221124012224-1m78i5k",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-1m78i5k"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "export CALICO_DATASTORE_TYPE=kubernetes\nexport CALICO_KUBECONFIG=~/.kube/config\ncat \u003c\u003cEOF | calicoctl apply -f -\nkind: BGPPeer\napiVersion: projectcalico.org/v3\nmetadata:\n  name: peer-with-route-reflectors\nspec:\n  nodeSelector: all()\n  peerSelector: route-reflector == 'true'\nEOF\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-yl2cuyd",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221124012224-yl2cuyd"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "查看 BGP 节点状态"
				}
			]
		},
		{
			"ID": "20221124012224-t4m55hx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-t4m55hx"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "node 上查看，peer type 由 node-to-node mesh 变为 node specific"
				}
			]
		},
		{
			"ID": "20221124012224-sbut8yx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-sbut8yx"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-2c4454f242271ee060ddb1352ab43237_b-20221124012224-90760mf.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-pnh4dsd",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-pnh4dsd"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Route Reflector 上节点查看，节点已正常建立连接"
				}
			]
		},
		{
			"ID": "20221124012224-gdvs7q2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-gdvs7q2"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-0745fc33f26e10eb274cf8167981023e_b-20221124012224-6uqgmdh.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-qz9lnhg",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-qz9lnhg"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "设置 veth 网卡 mtu"
				}
			]
		},
		{
			"ID": "20221124012224-u6yu0of",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-u6yu0of"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "通常，通过使用最高 MTU 值（不会在路径上引起碎片或丢包）来实现最高性能。对于给定的流量速率，最大带宽增加，CPU 消耗可能下降。对于一些支持 jumbo frames 的网络设备，可以配置 calico 支持使用。"
				}
			]
		},
		{
			"ID": "20221124012224-wj33brw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-wj33brw"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "下表列举了，常见几种 MTU 配置下 calico 对应的网卡 mtu 的配置"
				}
			]
		},
		{
			"ID": "20221124012224-vduk7pf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-vduk7pf"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-0da21c6cf6c4796df042497178408e8e_b-20221124012224-pdiy9rz.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-oqrfwmk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-oqrfwmk"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "IPIP 和 VXLAN 协议中的 IP 中使用的额外报文头，通过头的大小减小了最小 MTU。（IP 中的 IP 使用 20 字节的标头，而 VXLAN 使用 50 字节的标头）。"
				}
			]
		},
		{
			"ID": "20221124012224-8a6bk4i",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-8a6bk4i"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果在 Pod 网络中的任何地方使用 VXLAN，请将 MTU 大小配置为“物理网络 MTU 大小减去 50”。如果仅在 IP 中使用 IP，则将 MTU 大小配置为“物理网络 MTU 大小减去 20” 。"
				}
			]
		},
		{
			"ID": "20221124012224-q5xmlnz",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221124012224-q5xmlnz"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "将工作负载端点 MTU 和隧道 MTU 设置为相同的值"
				}
			]
		},
		{
			"ID": "20221124012224-3a1cfvy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-3a1cfvy"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "配置方法："
				}
			]
		},
		{
			"ID": "20221124012224-sd99yht",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-sd99yht"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "升级集群"
				}
			]
		},
		{
			"ID": "20221124012224-6p4wmcr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-6p4wmcr"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-75f363eaf63c0face1475d15803ae3f8_b-20221124012224-463zbq4.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-al6s6ek",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-al6s6ek"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "配置网卡 MTU，此时通过 system 项目下 calico-config 文件可以看见对应的 mtu 设置"
				}
			]
		},
		{
			"ID": "20221124012224-ldchvrh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-ldchvrh"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-0a5b248b9962dba5a674ae0ac6addec3_b-20221124012224-leeyfgh.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-v3bajo4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-v3bajo4"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "创建 workload 查看 POD 网卡 MTU 为 9001"
				}
			]
		},
		{
			"ID": "20221124012224-okw5ffk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-okw5ffk"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-5ae75ac8a5e6b127431a20849c10af1b_b-20221124012224-o32qao7.jpg"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-13gtdrc",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-13gtdrc"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "设置全局 AS 号"
				}
			]
		},
		{
			"ID": "20221124012224-f3q9g6u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-f3q9g6u"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "默认情况下，除非已为节点指定每个节点的 AS，否则所有 Calico 节点都使用 64512 自治系统。可以通过修改默认的 BGPConfiguration 资源来更改所有节点的全局默认值。以下示例命令将全局默认 AS 编号设置为 64513。"
				}
			]
		},
		{
			"ID": "20221124012224-itk6u2j",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-itk6u2j"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat \u003c\u003cEOF | calicoctl apply -f -\napiVersion: projectcalico.org/v3\nkind: BGPConfiguration\nmetadata:\n  name: default\nspec:\n  logSeverityScreen: Info\n  nodeToNodeMeshEnabled: false\n  asNumber: 64513\nEOF\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-mix7vts",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-mix7vts"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "设置单个主机和 AS 号"
				}
			]
		},
		{
			"ID": "20221124012224-3w89dsj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-3w89dsj"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "例如，以下命令将名为 node-1 的节点更改为属于 AS 64514。"
				}
			]
		},
		{
			"ID": "20221124012224-vqd4ij5",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-vqd4ij5"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "calicoctl patch node node-1 -p '{\"spec\": {\"bgp\": {“asNumber”: “64514”}}}'\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-jsza05g",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-jsza05g"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "修改节点地址范围"
				}
			]
		},
		{
			"ID": "20221124012224-u8z3nvl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-u8z3nvl"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "此操作建议在部署完集群后立刻进行。"
				}
			]
		},
		{
			"ID": "20221124012224-oj6fb00",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-oj6fb00"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "默认情况下 calico 在集群层面分配一个 10.42.0.0/16 的 CIDR 网段，在这基础上在单独为每个主机划分一个单独子网采用 26 位子网掩码对应的集群支持的节点数为 2^10=1024 节点，单个子网最大支持 64 个 POD，当单个子网对应 IP 消耗后，calico 会重新在本机上划分一个新的子网如下，在集群对端主机可以看见对应的多个 CIDR 路由信息。"
				}
			]
		},
		{
			"ID": "20221124012224-fba4kfe",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-fba4kfe"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/v2-8b56a5cfed3922ba91fed2e52902688a_b-20221124012224-rt4vvr7.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-jrqw0y6",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221124012224-jrqw0y6"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221124012224-77odvu8",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221124012224-77odvu8"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "注意：块大小将影响节点 POD 的 IP 地址分配和路由条目数量，如果主机在一个 CIDR 中分配所有地址，则将为其分配一个附加 CIDR。如果没有更多可用的块，则主机可以从分配给其他主机的 CIDR 中获取地址。为借用的地址添加了特定的路由，这会影响路由表的大小。"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-wntp8vv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-wntp8vv"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "将块大小从默认值增加（例如，使用/24 则为每个块提供 256 个地址）意味着每个主机更少的块，会减少路由。但是对应的集群可容纳主机数也对应减少为 2^8。"
				}
			]
		},
		{
			"ID": "20221124012224-yltya3s",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-yltya3s"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "从默认值减小 CIDR 大小（例如，使用/28 为每个块提供 16 个地址）意味着每个主机有更多 CIDR，因此会有更多路由。"
				}
			]
		},
		{
			"ID": "20221124012224-rfusk7u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-rfusk7u"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "calico 允许用户修改对应的 IP 池和集群 CIDR"
				}
			]
		},
		{
			"ID": "20221124012224-fgy05eo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-fgy05eo"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "创建和替换步骤"
				}
			]
		},
		{
			"ID": "20221124012224-yltfwzp",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221124012224-yltfwzp"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221124012224-a646b1e",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221124012224-a646b1e"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "注意：删除 Pod 时，应用程序会出现暂时不可用"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-5330zef",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221124012224-5330zef"
			},
			"Children": [
				{
					"ID": "20221124012224-ay409nz",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-ay409nz"
					},
					"Children": [
						{
							"ID": "20221124012224-sb88byl",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-sb88byl"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "添加一个新的 IP 池。"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-got7uli",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-got7uli"
					},
					"Children": [
						{
							"ID": "20221124012224-6dp6nb4",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-6dp6nb4"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "注意：新 IP 池必须在同一群集 CIDR 中。"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-3h0c4rr",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-3h0c4rr"
					},
					"Children": [
						{
							"ID": "20221124012224-u75qdp1",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-u75qdp1"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "禁用旧的 IP 池（注意：禁用 IP 池只会阻止分配新的 IP 地址。它不会影响现有 POD 的联网）"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-rvub1k0",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-rvub1k0"
					},
					"Children": [
						{
							"ID": "20221124012224-qxz03mv",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-qxz03mv"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "从旧的 IP 池中删除 Pod。"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-ot8s84v",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-ot8s84v"
					},
					"Children": [
						{
							"ID": "20221124012224-olmfurc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-olmfurc"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "验证新的 Pod 是否从新的 IP 池中获取地址。"
								}
							]
						}
					]
				},
				{
					"ID": "20221124012224-u8ev9dr",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221124012224-u8ev9dr"
					},
					"Children": [
						{
							"ID": "20221124012224-ir90stu",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221124012224-ir90stu"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "删除旧的 IP 池。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-ljnf7xa",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-ljnf7xa"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "定义 ippool 资源"
				}
			]
		},
		{
			"ID": "20221124012224-0mtjaqh",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-0mtjaqh"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "apiVersion: projectcalico.org/v3\nkind: IPPool\nmetadata:\n  name: my-ippool\nspec:\n  blockSize: 24\n  cidr: 192.0.0.0/16\n  ipipMode: Always\n  natOutgoing: true\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-2pgkkr5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-2pgkkr5"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "修改对应的 blockSize 号"
				}
			]
		},
		{
			"ID": "20221124012224-eulyw9p",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-eulyw9p"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "创建新的"
				}
			]
		},
		{
			"ID": "20221124012224-p2l8g8w",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-p2l8g8w"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "calicoctl apply -f pool.yaml\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-mvgyp2i",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-mvgyp2i"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "将旧的 ippool 禁用"
				}
			]
		},
		{
			"ID": "20221124012224-sldxkif",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-sldxkif"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "calicoctl patch ippool default-ipv4-ippool -p '{\"spec\": {\"disabled\": “true”}}'\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-b1f98cw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-b1f98cw"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "创建 workload 测试"
				}
			]
		},
		{
			"ID": "20221124012224-iyi9g4s",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-iyi9g4s"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "根据节点标签定义对应的 ippool"
				}
			]
		},
		{
			"ID": "20221124012224-v0n7ad1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-v0n7ad1"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Calico 能够进行配置，为不同拓扑指定 IP 地址池。例如可能希望某些机架、地区、或者区域能够从同一个 IP 池中获取地址。这对于降低路由数量或者配合防火墙策略的要求会很有帮助。"
				}
			]
		},
		{
			"ID": "20221124012224-099q7sy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-099q7sy"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "给节点配置对应 label"
				}
			]
		},
		{
			"ID": "20221124012224-w13dzyt",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-w13dzyt"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl label nodes kube-node-0 rack=0\nkubectl label nodes kube-node-1 rack=1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-hbboyxf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-hbboyxf"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "通过标签定义对应的节点 IPpool"
				}
			]
		},
		{
			"ID": "20221124012224-e3py0qi",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-e3py0qi"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "calicoctl create -f -\u003c\u003cEOF\napiVersion: projectcalico.org/v3\nkind: IPPool\nmetadata:\n  name: rack-0-ippool\nspec:\n  cidr: 192.168.0.0/24\n  ipipMode: Always\n  natOutgoing: true\n  nodeSelector: rack == \"0\"\nEOF\ncalicoctl create -f -\u003c\u003cEOF\napiVersion: projectcalico.org/v3\nkind: IPPool\nmetadata:\n  name: rack-1-ippool\nspec:\n  cidr: 192.168.1.0/24\n  ipipMode: Always\n  natOutgoing: true\n  nodeSelector: rack == \"1\"\nEOF\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-uxptfri",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-uxptfri"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "关闭 SNAT"
				}
			]
		},
		{
			"ID": "20221124012224-f961zqq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-f961zqq"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "默认情况下，calico 访问集群外网络是通过 SNAT 成宿主机 ip 方式，在一些金融客户环境中为了能实现防火墙规则，需要直接针对 POD ip 进行进行规则配置，所以需要关闭 natOutgoing"
				}
			]
		},
		{
			"ID": "20221124012224-o4v4aiy",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-o4v4aiy"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "kubectl edit ippool/default-ipv4-ippool\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-qc2gg77",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-qc2gg77"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "将 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "natOutgoing: true"
				},
				{
					"Type": "NodeText",
					"Data": "修改为"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "natOutgoing: false"
				}
			]
		},
		{
			"ID": "20221124012224-qrvir45",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-qrvir45"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "此时，calico 网络访问集群外的 ip 源 ip 就不会 snat 成 宿主机的 ip 地址。"
				}
			]
		},
		{
			"ID": "20221124012224-x8f9mw9",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221124012224-x8f9mw9"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "固定 POD IP"
				}
			]
		},
		{
			"ID": "20221124012224-udfnltg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-udfnltg"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "固定单个 ip"
				}
			]
		},
		{
			"ID": "20221124012224-qb5bpor",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-qb5bpor"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-test\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 1 # tells deployment to run 1 pods matching the template\n  template:\n    metadata:\n      labels:\n        app: nginx\n      annotations:\n        \"cni.projectcalico.org/ipAddrs\": \"[\\\"10.42.210.135\\\"]\"\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n        ports:\n        - containerPort: 80\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-t7xnm8z",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-t7xnm8z"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "固定多个 ip，只能通过 ippool 的方式"
				}
			]
		},
		{
			"ID": "20221124012224-b28gp25",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221124012224-b28gp25"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "dGV4dA=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat ippool1.yaml\napiVersion: projectcalico.org/v3\nkind: IPPool\nmetadata:\n  name: pool-1\nspec:\n  blockSize: 31\n  cidr: 10.21.0.0/31\n  ipipMode: Never\n  natOutgoing: true\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-test\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 1 # tells deployment to run 1 pods matching the template\n  template:\n    metadata:\n      labels:\n        app: nginx\n      annotations:\n        \"cni.projectcalico.org/ipv4pools\": \"[\\\"pool-1\\\"]\"\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n        ports:\n        - containerPort: 80\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221124012224-exq3mbz",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221124012224-exq3mbz"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221124012224-ysv9vog",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221124012224-ysv9vog"
					},
					"Children": [
						{
							"Type": "NodeTextMark",
							"TextMarkType": "em",
							"TextMarkTextContent": "链接："
						},
						{
							"Type": "NodeTextMark",
							"TextMarkType": "em a",
							"TextMarkAHref": "https://link.zhihu.com/?target=https%3A//www.bladewan.com/2020/11/18/calico_ops/",
							"TextMarkTextContent": "https://www."
						},
						{
							"Type": "NodeTextMark",
							"TextMarkType": "em a strong",
							"TextMarkAHref": "https://link.zhihu.com/?target=https%3A//www.bladewan.com/2020/11/18/calico_ops/",
							"TextMarkTextContent": "bladewan.com/2020/11/18"
						},
						{
							"Type": "NodeTextMark",
							"TextMarkType": "em a",
							"TextMarkAHref": "https://link.zhihu.com/?target=https%3A//www.bladewan.com/2020/11/18/calico_ops/",
							"TextMarkTextContent": "/calico_ops/"
						},
						{
							"Type": "NodeTextMark",
							"TextMarkType": "em",
							"TextMarkTextContent": "（侵删）"
						}
					]
				}
			]
		},
		{
			"ID": "20221124012224-2ex06rw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-2ex06rw"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/520146222",
					"TextMarkTextContent": "运维君莫笑：大规模 K8s 集群 ApiServer/Etcd LIST 请求性能瓶颈和调优实践"
				}
			]
		},
		{
			"ID": "20221124012224-s7xoq52",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-s7xoq52"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/518727401",
					"TextMarkTextContent": "运维君莫笑：轻量级 Kubernetes 集群发行版 K3s 完全进阶指南"
				}
			]
		},
		{
			"ID": "20221124012224-2ypkun7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-2ypkun7"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/516694496",
					"TextMarkTextContent": "运维君莫笑：详解 K8S Pod 高级调度策略"
				}
			]
		},
		{
			"ID": "20221124012224-7u65815",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-7u65815"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/516240617",
					"TextMarkTextContent": "运维君莫笑：5 款强大的 Kubernetes Events 收集与检索工具"
				}
			]
		},
		{
			"ID": "20221124012224-sdgpten",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-sdgpten"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/515566958",
					"TextMarkTextContent": "运维君莫笑：Kubernetes的复杂和高准入门槛，只是暂时的"
				}
			]
		},
		{
			"ID": "20221124012224-vwebr2j",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-vwebr2j"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/510153826",
					"TextMarkTextContent": "运维君莫笑：使用 Thanos 和 Prometheus 打造一个高可用的 Kubernetes 监控系统"
				}
			]
		},
		{
			"ID": "20221124012224-2hzaujg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-2hzaujg"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/494640950",
					"TextMarkTextContent": "运维君莫笑：容器与Pod到底有什么区别和联系？"
				}
			]
		},
		{
			"ID": "20221124012224-qo4cded",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-qo4cded"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/491016048",
					"TextMarkTextContent": "运维君莫笑：Docker+K8s 零基础从入门到进阶"
				}
			]
		},
		{
			"ID": "20221124012224-6ijke5y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-6ijke5y"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/486016590",
					"TextMarkTextContent": "运维君莫笑：几张大图就把 Kubernetes Ingress 来龙去脉搞清楚了，看完后真“香”"
				}
			]
		},
		{
			"ID": "20221124012224-iagchpn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-iagchpn"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/482966677",
					"TextMarkTextContent": "运维君莫笑：Kubernetes 4000 节点运维经验分享"
				}
			]
		},
		{
			"ID": "20221124012224-sx3hw2o",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-sx3hw2o"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/472799586",
					"TextMarkTextContent": "运维君莫笑：K8S Service实战与原理初探"
				}
			]
		},
		{
			"ID": "20221124012224-ox8jlqa",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221124012224-ox8jlqa"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://zhuanlan.zhihu.com/p/480544836",
					"TextMarkTextContent": "运维君莫笑：深度揭秘阿里云 Serverless Kubernetes"
				}
			]
		}
	]
}