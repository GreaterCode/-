{
	"ID": "20230412194953-huueri9",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20230412194953-huueri9",
		"scroll": "{\u0026quot;startId\u0026quot;:\u0026quot;20230412194953-wkw8vr5\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20230412200536-6fyicrn\u0026quot;,\u0026quot;scrollTop\u0026quot;:0,\u0026quot;focusId\u0026quot;:\u0026quot;20230412194953-wkw8vr5\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0}",
		"title": "k8s针对物理机和虚拟机监控的不同",
		"updated": "20230412200831"
	},
	"Children": [
		{
			"ID": "20230412194953-wkw8vr5",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20230412194953-wkw8vr5",
				"updated": "20230412195359"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1. "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "CPU"
				},
				{
					"Type": "NodeText",
					"Data": "负载"
				}
			]
		},
		{
			"ID": "20230412195113-vavfo0f",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412195113-vavfo0f",
				"updated": "20230412195226"
			},
			"Children": [
				{
					"ID": "20230412195125-iosdfhn",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195125-iosdfhn"
					},
					"Children": [
						{
							"ID": "20230412195125-kdza10w",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195125-kdza10w"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在 KVM 场景下，用户需要关注的指标是 CPU 使用率 和 CPU load："
								}
							]
						},
						{
							"ID": "20230412195128-plstpfm",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20230412195128-plstpfm"
							},
							"Children": [
								{
									"ID": "20230412195127-7nmqlao",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20230412195127-7nmqlao"
									},
									"Children": [
										{
											"ID": "20230412195129-7uw9fq2",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20230412195129-7uw9fq2"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "CPU load 高，CPU 使用率低，一般表明性能瓶颈出现在磁盘 I/O 上"
												}
											]
										}
									]
								},
								{
									"ID": "20230412195129-rzeq8rw",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20230412195129-rzeq8rw"
									},
									"Children": [
										{
											"ID": "20230412195129-wx08mkr",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20230412195129-wx08mkr",
												"updated": "20230412195135"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "CPU 使用率高，CPU load 远高于 CPU 核数，表示当前 CPU 资源严重不足"
												}
											]
										}
									]
								}
							]
						}
					]
				},
				{
					"ID": "20230412195201-x8i5jk0",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195201-x8i5jk0",
						"updated": "20230412195226"
					},
					"Children": [
						{
							"ID": "20230412195201-nmml3g8",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195201-nmml3g8",
								"updated": "20230412195215"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在k8s场景下，用户需要关注的指标是 CPU 使用率和 CPU 限流时间"
								}
							]
						},
						{
							"ID": "20230412195216-l42tr5x",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195216-l42tr5x",
								"updated": "20230412195226"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "CPU 使用率高（接近甚至稍微超过 100%），CPU 限流时间大，表示当前 CPU 资源严重不足，需要增加 request 或者 limit"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412195252-lru35qo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412195252-lru35qo",
				"updated": "20230412195252"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "出现这种差异的原因："
				}
			]
		},
		{
			"ID": "20230412195252-f1b0vt0",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412195252-f1b0vt0",
				"updated": "20230412195252"
			},
			"Children": [
				{
					"ID": "20230412195252-fkuofp7",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195252-fkuofp7"
					},
					"Children": [
						{
							"ID": "20230412195252-iym3m9h",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195252-iym3m9h"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Kubernetes 和 KVM 在 CPU 资源隔离机制上存在差别"
								}
							]
						}
					]
				},
				{
					"ID": "20230412195252-mh4itq8",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195252-mh4itq8"
					},
					"Children": [
						{
							"ID": "20230412195252-0ha2wdv",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195252-0ha2wdv"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Linux 指标暴露 和 Kubernetes 指标暴露存在差别"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412195351-jzhjsin",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230412195351-jzhjsin",
				"updated": "20230412195724"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.1 CPU使用率"
				}
			]
		},
		{
			"ID": "20230412195422-lhh49kv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412195422-lhh49kv",
				"updated": "20230412195422"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "对于一个独立的 CPU core，它的时间被分成了三份："
				}
			]
		},
		{
			"ID": "20230412195430-kzhztcf",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412195430-kzhztcf",
				"updated": "20230412195430"
			},
			"Children": [
				{
					"ID": "20230412195430-ugtrgmg",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195430-ugtrgmg"
					},
					"Children": [
						{
							"ID": "20230412195430-vffek5h",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195430-vffek5h"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "执行用户代码时间"
								}
							]
						}
					]
				},
				{
					"ID": "20230412195430-zsuikut",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195430-zsuikut"
					},
					"Children": [
						{
							"ID": "20230412195430-oe2293m",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195430-oe2293m"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "执行内核代码时间"
								}
							]
						}
					]
				},
				{
					"ID": "20230412195430-oliv3kx",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195430-oliv3kx"
					},
					"Children": [
						{
							"ID": "20230412195430-4wx99m0",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195430-4wx99m0"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "空闲时间（对于 x86 体系而言，此时会执行 HLT 指令）"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412195448-rzmuais",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412195448-rzmuais",
				"updated": "20230412195455"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "KVM 环境下计算 CPU 使用率很直接：（执行用户代码时间 + 执行内核代码时间）/ 总时间。"
				}
			]
		},
		{
			"ID": "20230412195504-ad9vfj7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412195504-ad9vfj7",
				"updated": "20230412195514"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " 对Kubernetes Pod ，它不再享有独立的 CPU core，因此这个公式不再成立。在 Kubernetes 语境下，CPU 的资源总量/使用量是通过时间表示的："
				}
			]
		},
		{
			"ID": "20230412195541-1pgrjsh",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412195541-1pgrjsh",
				"updated": "20230412195543"
			},
			"Children": [
				{
					"ID": "20230412195543-yjechfo",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195543-yjechfo"
					},
					"Children": [
						{
							"ID": "20230412195543-fgacf3w",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195543-fgacf3w"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "配置一个 CPU limit 为 4 的 POD，含义是 一秒钟内可以使用 4s 的 CPU 资源，这个当然需要多核/多线程的支持"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412195537-6ljokh2",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412195537-6ljokh2",
				"updated": "20230412195537"
			},
			"Children": [
				{
					"ID": "20230412195537-65amzxd",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195537-65amzxd"
					},
					"Children": [
						{
							"ID": "20230412195537-a8to1w5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195537-a8to1w5"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "一个 POD 每秒使用 0.5s 的 CPU 资源，可以理解为这个 POD 使用了一个 CPU core 的 50%"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412195518-kyqszl8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412195518-kyqszl8",
				"updated": "20230412195652"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "原生的 Kubernetes 并不关注”使用率“这个概念，但是为了降低用户的迁移成本，监控通过 使用量 / Limit 来衡量 POD 的 CPU 使用率。\n由于 Kubernetes 对 CPU Limit 的实现粒度有限，同时考虑到统计的误差，因此在压测等极限场景中 CPU 使用率会出现高于 100% 的”毛刺“。"
				}
			]
		},
		{
			"ID": "20230412195727-zwh1m7a",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230412195727-zwh1m7a",
				"updated": "20230412195742"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.2  CPU负载"
				}
			]
		},
		{
			"ID": "20230412195747-xzwbbwj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412195747-xzwbbwj",
				"updated": "20230412195748"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "CPU load 用于衡量当前系统的负载情况， Linux 系统使用当前处于可运行状态的线程数来标识，包括："
				}
			]
		},
		{
			"ID": "20230412195756-m3v3tu0",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412195756-m3v3tu0",
				"updated": "20230412195756"
			},
			"Children": [
				{
					"ID": "20230412195756-xsyk9w7",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195756-xsyk9w7"
					},
					"Children": [
						{
							"ID": "20230412195756-y1wdpze",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195756-y1wdpze"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "处于 running 状态的线程，这个是最正常的情况，获得 CPU 分片，执行用户态或者内核态代码的线程"
								}
							]
						}
					]
				},
				{
					"ID": "20230412195756-2je3heq",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412195756-2je3heq"
					},
					"Children": [
						{
							"ID": "20230412195756-e4kx5cs",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412195756-e4kx5cs"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "出入 uninterruptible sleep 状态的线程，这个是特殊的情况，表明这个线程在进行 I/O 操作"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412195803-re5cuee",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412195803-re5cuee",
				"updated": "20230412195813"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "因此，当 CPU 使用率很低，但 load 很高时， 我们可以推断大量线程处于 I/O 操作状态，系统的性能瓶颈出现在磁盘或者网络 I/O。"
				}
			]
		},
		{
			"ID": "20230412195822-ubsvhm0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412195822-ubsvhm0",
				"updated": "20230412195823"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Kubernetes 虽然也提供了 cpu_load 指标，却只包含了处于 running 状态的线程，这个指标也失去了判断系统性能瓶颈是否出现在 I/O 的作用。"
				}
			]
		},
		{
			"ID": "20230412200039-s0o649q",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412200039-s0o649q",
				"updated": "20230412200040"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "由于 CPU 使用方式的不同，Kubernetes 提供了“CPU 限制时间”指标，通过这个指标覆盖了 “CPU 使用率和 load 都很高，CPU 资源严重不足” 的情况。"
				}
			]
		},
		{
			"ID": "20230412200058-2x900ct",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412200058-2x900ct",
				"updated": "20230412200058"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "，Kubernetes 通过 Completely Fair Scheduler (CFS) Cgroup bandwidth control 限制 Pod 的 CPU 使用："
				}
			]
		},
		{
			"ID": "20230412200058-3r3tel7",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412200058-3r3tel7",
				"updated": "20230412200058"
			},
			"Children": [
				{
					"ID": "20230412200058-ujtt4zp",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200058-ujtt4zp"
					},
					"Children": [
						{
							"ID": "20230412200058-5a3vedk",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200058-5a3vedk"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "首先，我们将 1s 分成多个 period，每个 period 持续时间为 0.1s"
								}
							]
						}
					]
				},
				{
					"ID": "20230412200058-q1owabj",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200058-q1owabj"
					},
					"Children": [
						{
							"ID": "20230412200058-2hq78j4",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200058-2hq78j4"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在每个 peroid 中，Pod 需要向 CFS 申请时间片，CFS 通过 Limit 参数判断这个申请是否达到这个 Pod 的资源限制"
								}
							]
						}
					]
				},
				{
					"ID": "20230412200058-675t9h5",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200058-675t9h5"
					},
					"Children": [
						{
							"ID": "20230412200058-ozukxy5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200058-ozukxy5"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "如果达到了 Pod 的资源限制，”限流时间“ 指标会记录限流的时间"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412200058-ccs4k10",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412200058-ccs4k10",
				"updated": "20230412200058"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "因此，当一个 Pod 的”限流时间“非常高时，意味着这个 Pod CPU 资源严重不足，需要增加更多的资源了。"
				}
			]
		},
		{
			"ID": "20230412200110-e4emmv3",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20230412200110-e4emmv3",
				"updated": "20230412200127"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2. "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "内存"
				}
			]
		},
		{
			"ID": "20230412200137-x76q4xr",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412200137-x76q4xr",
				"updated": "20230412200137"
			},
			"Children": [
				{
					"ID": "20230412200137-iwuns1k",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200137-iwuns1k"
					},
					"Children": [
						{
							"ID": "20230412200137-svso05b",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200137-svso05b"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在KVM场景中，内存的具体使用量并没有一个非常清晰的标准，cache/buffer/slab 内存对于应用性能的影响和应用本身的特点有关，没有统一的计算方案，综合各种因素，监控使用 total - available 作为内存使用"
								}
							]
						}
					]
				},
				{
					"ID": "20230412200137-xrjy4if",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200137-xrjy4if"
					},
					"Children": [
						{
							"ID": "20230412200137-5eateok",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200137-5eateok"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Kubernetes 没有提供 available 指标，我们主要使用 RSS 内存作为已用内存\n"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412200536-1rzj097",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230412200536-1rzj097",
				"updated": "20230412200545"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1 Linux free 命令一般包含这几列："
				}
			]
		},
		{
			"ID": "20230412200536-6fyicrn",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412200536-6fyicrn",
				"updated": "20230412200536"
			},
			"Children": [
				{
					"ID": "20230412200536-8ou081t",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200536-8ou081t"
					},
					"Children": [
						{
							"ID": "20230412200536-64dqnsl",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200536-64dqnsl"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "used：\n系统使用的内存，包括进程分配使用的内存，也包括系统为了优化性能而针对磁盘缓存分配的部分（即 cache/buffer）"
								}
							]
						}
					]
				},
				{
					"ID": "20230412200536-a2hfcrn",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200536-a2hfcrn"
					},
					"Children": [
						{
							"ID": "20230412200536-a4adhvv",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200536-a4adhvv"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "cache/buffer：\n上述的缓存"
								}
							]
						}
					]
				},
				{
					"ID": "20230412200536-8624t37",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200536-8624t37"
					},
					"Children": [
						{
							"ID": "20230412200536-kwmhwgi",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200536-kwmhwgi"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "available：\n估算的系统可用内存，考虑的 cache/buffer 以及不可回收的 slab 等"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412200536-idlmihj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412200536-idlmihj",
				"updated": "20230412200721"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "不能简单地将实际使用内存等价位used - cache/buffer，对于不同的应用，cache/buffer内存很可能是影响性能的重要部分（特别是依赖大量磁盘写操作的应用，如 Kafka、ElasticSearch 等）。监控系统当前使用 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "mark",
					"TextMarkTextContent": "total - available 作为已用内存"
				},
				{
					"Type": "NodeText",
					"Data": "，并基于此计算内存使用率。"
				}
			]
		},
		{
			"ID": "20230412200730-kmye2aj",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230412200730-kmye2aj",
				"updated": "20230412200741"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.2 k8s对于内存使用暴露了不同的值："
				}
			]
		},
		{
			"ID": "20230412200735-s0llt0r",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412200735-s0llt0r",
				"updated": "20230412200735"
			},
			"Children": [
				{
					"ID": "20230412200735-0c3rkds",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200735-0c3rkds"
					},
					"Children": [
						{
							"ID": "20230412200735-2nmxm5m",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200735-2nmxm5m"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "MemUsed：\n和 Linux 的 used 一样，包含了 cache 值"
								}
							]
						}
					]
				},
				{
					"ID": "20230412200735-q94j0et",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200735-q94j0et"
					},
					"Children": [
						{
							"ID": "20230412200735-0elzyfg",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200735-0elzyfg"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "WorkingSet：\n比 memUsed 小一些，移除了一些“冷数据”，即长期没有访问的 cache 内存"
								}
							]
						}
					]
				},
				{
					"ID": "20230412200735-1iuuurl",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200735-1iuuurl"
					},
					"Children": [
						{
							"ID": "20230412200735-9bpai0y",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200735-9bpai0y"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "RSS：\n移除了 cache 的内存"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412200816-67c3llo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412200816-67c3llo",
				"updated": "20230412200831"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "一般情况下，我们认为 WorkingSet 是比较合理的内存使用量指标，但是实践中发现，WorkingSet的值一般比较高，常规应用内存使用率基本在 90%，和 KVM 下相同应用差别较大。\n考虑到常规 Web 应用一般不依赖磁盘 I/O，cache 内存基本用于日志系统，对系统性能影响不大，因此最终在监控系统中选择使用 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "mark",
					"TextMarkTextContent": "RSS 衡量内存"
				},
				{
					"Type": "NodeText",
					"Data": "使用。但是，我们依然建议当用户发现系统出现性能瓶颈时，使用不同的内存指标辅助判断，更好地理解当前系统的状态。"
				}
			]
		},
		{
			"ID": "20230412200144-ie8jhxm",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20230412200144-ie8jhxm",
				"updated": "20230412200238"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3. 磁盘和网络"
				}
			]
		},
		{
			"ID": "20230412200245-3no26n2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412200245-3no26n2",
				"updated": "20230412200301"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "基于 LInux Cgroup 隔离机制，磁盘/网络相关指标 Kubernetes 和 KVM 区别不大。Web 应用一般只关注磁盘用量，但是 Kubernetes 环境默认是无盘系统（除非使用持久卷），因此并没有分配磁盘空间这一概念，用户也不需要再关心磁盘可用空间。"
				}
			]
		},
		{
			"ID": "20230412200310-ogp0qab",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230412200310-ogp0qab",
				"updated": "20230412200421"
			},
			"Children": [
				{
					"ID": "20230412200320-ufruag5",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200320-ufruag5",
						"updated": "20230412200421"
					},
					"Children": [
						{
							"ID": "20230412200320-axrohtv",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200320-axrohtv",
								"updated": "20230412200320"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "对于磁盘，我们主要关心磁盘写入性能相关指标："
								}
							]
						},
						{
							"ID": "20230412200419-qdx9htb",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200419-qdx9htb",
								"updated": "20230412200421"
							},
							"Children": [
								{
									"Type": "NodeImage",
									"Data": "span",
									"Children": [
										{
											"Type": "NodeBang"
										},
										{
											"Type": "NodeOpenBracket"
										},
										{
											"Type": "NodeLinkText",
											"Data": "image.png"
										},
										{
											"Type": "NodeCloseBracket"
										},
										{
											"Type": "NodeOpenParen"
										},
										{
											"Type": "NodeLinkDest",
											"Data": "assets/image-20230412200421-39cb7aa.png"
										},
										{
											"Type": "NodeCloseParen"
										}
									]
								}
							]
						}
					]
				},
				{
					"ID": "20230412200326-17ypve1",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230412200326-17ypve1"
					},
					"Children": [
						{
							"ID": "20230412200326-7kuaafu",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200326-7kuaafu",
								"updated": "20230412200326"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "对于网络，和KVM场景类似，主要关注流量、丢包率等指标："
								}
							]
						},
						{
							"ID": "20230412200401-fd00v1h",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230412200401-fd00v1h",
								"updated": "20230412200402"
							},
							"Children": [
								{
									"Type": "NodeImage",
									"Data": "span",
									"Children": [
										{
											"Type": "NodeBang"
										},
										{
											"Type": "NodeOpenBracket"
										},
										{
											"Type": "NodeLinkText",
											"Data": "image.png"
										},
										{
											"Type": "NodeCloseBracket"
										},
										{
											"Type": "NodeOpenParen"
										},
										{
											"Type": "NodeLinkDest",
											"Data": "assets/image-20230412200402-u3tn77b.png"
										},
										{
											"Type": "NodeCloseParen"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230412200311-yl7rsk9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230412200311-yl7rsk9",
				"updated": "20230412200311"
			}
		}
	]
}