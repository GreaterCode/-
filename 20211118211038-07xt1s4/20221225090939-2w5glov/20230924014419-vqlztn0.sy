{
	"ID": "20230924014419-vqlztn0",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20230924014419-vqlztn0",
		"scroll": "{\u0026quot;startId\u0026quot;:\u0026quot;20230924014419-reftmfp\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20240122162315-3cbwckj\u0026quot;,\u0026quot;scrollTop\u0026quot;:6347,\u0026quot;focusId\u0026quot;:\u0026quot;20240122162315-fuv3f63\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0}",
		"title": "干货！网络丢包故障定位全景指南",
		"updated": "20240122162333"
	},
	"Children": [
		{
			"ID": "20230924014419-mvlhqw5",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-mvlhqw5",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-23gbjq8",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-23gbjq8",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014419-crncupm",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014419-crncupm",
						"updated": "20230924014419"
					},
					"Children": [
						{
							"ID": "20230924014419-9ehw4e1",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-9ehw4e1",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://mp.weixin.qq.com/s/qAMAHRMXqXFiqxpNHsmLuw?poc_token=HOghD2Wjonay9oxh95zyUyewyb_ebCgz6as245uX",
									"TextMarkTextContent": "https://mp.weixin.qq.com/s/qAMAHRMXqXFiqxpNHsmLuw?poc_token=HOghD2Wjonay9oxh95zyUyewyb_ebCgz6as245uX - 微信公众平台"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014419-d4v4094",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014419-d4v4094",
						"updated": "20230924014419"
					},
					"Children": [
						{
							"ID": "20230924014419-0pqoczf",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-0pqoczf",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "如何更高效定位网络丢包问题？"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014419-7t32px6",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014419-7t32px6",
						"updated": "20230924014419"
					},
					"Children": [
						{
							"ID": "20230924014419-g0n4t7b",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-g0n4t7b",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "2023-09-24 01:44:19"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-uj0ihrb",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-uj0ihrb",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014456-xvcplqb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014456-xvcplqb",
				"updated": "20230924014458"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20230924014458-wc3vqok.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20230924014545-z9q09kd",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014545-z9q09kd"
			}
		},
		{
			"ID": "20230924014545-yvx89rv",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20230924014545-yvx89rv",
				"updated": "20230924014703"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "引言"
				}
			]
		},
		{
			"ID": "20230924014704-ea0c9me",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014704-ea0c9me"
			}
		},
		{
			"ID": "20230924014712-z1sf1ut",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014712-z1sf1ut",
				"updated": "20230924014721"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "本期分享一个比较常见的⽹络问题--丢包。例如我们去ping⼀个⽹站，如果能ping通，且⽹站返回信息全⾯，则说明与⽹站服务器的通信是畅通的，如果ping不通，或者⽹站返回的信息不全等，则很可能是数据被丢包了，类似情况想必⼤家都不陌⽣。针对⽹络丢包，本⽂提供⼀些常见的丢包故障定位⽅法，希望能够帮助⼤家对⽹络丢包有更多的认识，遇到丢包莫要慌，且跟着⼀起来涨姿(知)势(识)···"
				}
			]
		},
		{
			"ID": "20230924014804-h3k6d75",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014804-h3k6d75",
				"updated": "20230924014826"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.1 什么是丢包"
				}
			]
		},
		{
			"ID": "20230924014743-117vura",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014743-117vura",
				"updated": "20230924014743"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "数据在Internet上是以数据包为单位传输的，单位为字节，数据在⽹络上传输，受⽹络设备，⽹络质量等原因的影响，使得接收到的数据⼩于发送出去的数据，造成丢包。"
				}
			]
		},
		{
			"ID": "20230924014818-dffluf8",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014818-dffluf8",
				"updated": "20230924014853"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.2 数据包接收、发送原理"
				}
			]
		},
		{
			"ID": "20230924014712-qzlikpq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014712-qzlikpq",
				"updated": "20230924014849"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20230924014849-7ezbpp6.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014908-36rqtlk",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014908-36rqtlk",
				"updated": "20230924015049"
			},
			"Children": [
				{
					"ID": "20230924015049-fzc24wz",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924015049-fzc24wz",
						"updated": "20230924015049"
					},
					"Children": [
						{
							"ID": "20230924015049-pagl3m5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924015049-pagl3m5",
								"updated": "20230924015049"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "发送数据包："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-cmtm9tw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-cmtm9tw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-eihiggi"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-3a00kvg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-3a00kvg",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.应⽤程序的数据包，在TCP层增加TCP报⽂头，形成可传输的数据包。\n2.在IP层增加IP报头，形成IP报⽂。\n3.经过数据⽹卡驱动程序将IP包再添加14字节的MAC头，构成frame（暂⽆CRC），frame（暂⽆CRC）中含有发送端和接收端的MAC地址。\n4.驱动程序将frame（暂⽆CRC）拷贝到⽹卡的缓冲区，由⽹卡处理。\n5.⽹卡为frame（暂⽆CRC）添加头部同步信息和CRC校验，将其封装为可以发送的packet，然后再发送到⽹线上，这样说就完成了⼀个IP报⽂的发送了，所有连接到这个⽹线上的⽹卡都可以看到该packet。"
				}
			]
		},
		{
			"ID": "20230924014419-ppjcpr7",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-ppjcpr7",
				"updated": "20230924015054"
			},
			"Children": [
				{
					"ID": "20230924015054-64tjgs2",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924015054-64tjgs2",
						"updated": "20230924015054"
					},
					"Children": [
						{
							"ID": "20230924015054-u1i9b7k",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924015054-u1i9b7k",
								"updated": "20230924015054"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "接收数据包："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-6a1fmg3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-6a1fmg3",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014418-g374xn2"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-lo8rp4u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-lo8rp4u",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.⽹卡收到⽹线上的packet，⾸先检查packet的CRC校验，保证完整性，然后将packet头去掉，得到frame。（⽹卡会检查MAC包内的⽬的MAC地址是否和本⽹卡的MAC地址⼀样，不⼀样则会丢弃。）\n2.⽹卡将frame拷贝到预分配的ring buffer缓冲。\n3.⽹卡驱动程序通知内核处理，经过TCP/IP协议栈层层解码处理。\n4.应⽤程序从socket buffer 中读取数据。"
				}
			]
		},
		{
			"ID": "20230924014419-e4jp5o0",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014419-e4jp5o0",
				"updated": "20230924015208"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.3 核心思路"
				}
			]
		},
		{
			"ID": "20230924015210-k4cst3m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924015210-k4cst3m",
				"updated": "20230924015210"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "了解了收发包的原理，可以了解到丢包原因主要会涉及⽹卡设备、⽹卡驱动、内核协议栈三⼤类。以下我们将遵循“从下到上分层分析（各层可能性出现的丢包场景），然后查看关键信息，最终得出分析结果”的原则展开介绍。"
				}
			]
		},
		{
			"ID": "20230924014419-7tvk5la",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20230924014419-7tvk5la",
				"updated": "20230924021831"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2. "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "目录--网络丢包情形概览"
				}
			]
		},
		{
			"ID": "20230924014419-hhiw0mj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hhiw0mj",
				"updated": "20230924021838"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "\u0026gt;  硬件网卡丢包"
				}
			]
		},
		{
			"ID": "20230924014419-knpkcdj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-knpkcdj",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "\u0026gt; 网卡驱动丢包"
				}
			]
		},
		{
			"ID": "20230924014419-jrfier3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jrfier3",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "\u0026gt; 以太网链路层丢包"
				}
			]
		},
		{
			"ID": "20230924014419-r9gpmzb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-r9gpmzb",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "\u0026gt; 网络IP层丢包"
				}
			]
		},
		{
			"ID": "20230924014419-y42bh22",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-y42bh22",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "\u0026gt; 传输层UDP/TCP丢包"
				}
			]
		},
		{
			"ID": "20230924014419-l9w9cke",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-l9w9cke",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "\u0026gt; 应用层socket丢包"
				}
			]
		},
		{
			"ID": "20230924014419-tr5fyve",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tr5fyve",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "针对以上6种情形，分别作出如下详述~"
				}
			]
		},
		{
			"ID": "20230924014419-x505xt7",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014419-x505xt7",
				"updated": "20230924022421"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "硬件网卡丢包"
				}
			]
		},
		{
			"ID": "20230924022422-v8bvmbl",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924022422-v8bvmbl",
				"updated": "20230924022429"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.1 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "Ring Buffer溢出 "
				}
			]
		},
		{
			"ID": "20230924014419-brshrzj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-brshrzj",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-1pkqiid"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-w8ibrqt",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-w8ibrqt",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如图所示，物理介质上的数据帧到达后首先由NIC（网络适配器）读取，写入设备内部缓冲区Ring Buffer中，再由中断处理程序触发Softirq从中消费，Ring Buffer的大小因网卡设备而异。当网络数据包到达（生产）的速率快于内核处理（消费）的速率时，Ring Buffer很快会被填满，新来的数据包将被丢弃；"
				}
			]
		},
		{
			"ID": "20230924014419-xwq0mi7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xwq0mi7",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-v1ow4a5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-v1ow4a5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "通过ethtool或/proc/net/dev可以查看因Ring Buffer满而丢弃的包统计，在统计项中以fifo标识："
				}
			]
		},
		{
			"ID": "20230924014419-mazx6ev",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-mazx6ev",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ ethtool -S eth0|grep rx_fifo\nrx_fifo_errors: 0\n$ cat /proc/net/dev\nInter-|Receive | Transmitface |bytes packets errs drop fifo frame compressed \nmulticast|bytes packets errs drop fifo colls carrier compressed\neth0: 17253386680731 42839525880 0 0 0 0 0 244182022 14879545018057 41657801805 0 0 0 0 0 0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-7v331ny",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-7v331ny",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看eth0网卡Ring Buffer最大值和当前设置"
				}
			]
		},
		{
			"ID": "20230924014419-0lbkhre",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-0lbkhre",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ ethtool -g eth0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-0qi1hp5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-0qi1hp5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：修改网卡eth0接收与发送硬件缓存区大小"
				}
			]
		},
		{
			"ID": "20230924014419-btx5uo7",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-btx5uo7",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ ethtool -G eth0 rx 4096 tx 4096\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-mfq9mi5",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-mfq9mi5",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-eradcnb",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-eradcnb",
				"updated": "20230924022452"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.2 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "网卡端口协商丢包"
				}
			]
		},
		{
			"ID": "20230924014419-f7dnwgp",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-f7dnwgp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-sws61fb",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20230924014418-sws61fb",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-skjrcxi",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-skjrcxi",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看网卡丢包统计：ethtool -S eth1/eth0"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-chrx91m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-chrx91m",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-0wcjbs2"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-idxmzln",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-idxmzln",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-qmuenes",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20230924014418-qmuenes",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-u0cpnzb",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-u0cpnzb",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看网卡配置状态：ethtool eth1/eth0"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-tyhcsj7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tyhcsj7",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-efbr6vu"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-aw5l5gw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-aw5l5gw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "主要查看网卡和上游网络设备协商速率和模式是否符合预期；"
				}
			]
		},
		{
			"ID": "20230924014419-8fwdzoi",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-8fwdzoi",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-41z69eo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-41z69eo",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1  重新自协商：  ethtool -r  eth1/eth0;"
				}
			]
		},
		{
			"ID": "20230924014419-jcm2qun",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jcm2qun",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2  如果上游不支持自协商，可以强制设置端口速率："
				}
			]
		},
		{
			"ID": "20230924014419-d3iaxs9",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-d3iaxs9",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ethtool -s eth1 speed 1000 duplex full autoneg off\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-2wq0330",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-2wq0330",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-j03h880",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-j03h880",
				"updated": "20230924022515"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.3 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "网卡流控丢包"
				}
			]
		},
		{
			"ID": "20230924014419-e3a63yw",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-e3a63yw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-wjlae5k",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20230924014418-wjlae5k",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-w78m009",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-w78m009",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看流控统计："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-kfos44e",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-kfos44e",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ethtool -S eth1 | grep control\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-1is8260",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-1is8260",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014418-2r0gob2"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-vxpckc8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-vxpckc8",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "rx_flow_control_xon是在网卡的RX Buffer满或其他网卡内部的资源受限时，给交换机端口发送的开启流控的pause帧计数。对应的，tx_flow_control_xoff是在资源可用之后发送的关闭流控的pause帧计数。"
				}
			]
		},
		{
			"ID": "20230924014419-41pg4c5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-41pg4c5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2 .查看网络流控配置：ethtool -a eth1"
				}
			]
		},
		{
			"ID": "20230924014419-sx4taxp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-sx4taxp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-tgqvv3x"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-v272acp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-v272acp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：关闭网卡流控"
				}
			]
		},
		{
			"ID": "20230924014419-b5ktcok",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-b5ktcok",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ethtool -A ethx autoneg off //自协商关闭\nethtool -A ethx tx off //发送模块关闭\nethtool -A ethx rx off //接收模块关闭\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-rbaab5x",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-rbaab5x",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-lo1qls5",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-lo1qls5",
				"updated": "20230924022542"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.4 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "报文mac地址丢包"
				}
			]
		},
		{
			"ID": "20230924014419-3k5ngjb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-3k5ngjb",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "一般计算机网卡都工作在非混杂模式下，此时网卡只接受来自网络端口的目的地址指向自己的数据，如果报文的目的mac地址不是对端的接口的mac地址，一般都会丢包，一般这种情况很有可能是源端设置静态arp表项或者动态学习的arp表项没有及时更新，但目的端mac地址已发生变化（换了网卡），没有更新通知到源端（比如更新报文被丢失，中间交换机异常等情况）；"
				}
			]
		},
		{
			"ID": "20230924014419-2b0vb2p",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2b0vb2p",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-p8l820s",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-p8l820s",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.目的端抓包，tcpdump可以开启混杂模式，可以抓到对应的报文，然后查看mac地址；"
				}
			]
		},
		{
			"ID": "20230924014419-xx8f97c",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xx8f97c",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.源端查看arp表或者抓包（上一跳设备），看发送的mac地址是否和下一跳目的端的mac地址一致；"
				}
			]
		},
		{
			"ID": "20230924014419-hdqvej4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hdqvej4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-tyisprr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tyisprr",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.刷新arp表然后发包触发arp重新学习（可能影响其他报文，增加延时，需要小心操作）；"
				}
			]
		},
		{
			"ID": "20230924014419-y5jybue",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-y5jybue",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.可以在源端手动设置正确的静态的arp表项；"
				}
			]
		},
		{
			"ID": "20230924014419-2xgqgmx",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-2xgqgmx",
				"updated": "20230924022655"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.5 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong strong",
					"TextMarkTextContent": "其他网卡异常丢包"
				}
			]
		},
		{
			"ID": "20230924014419-2omtjj2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2omtjj2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "这类异常比少见，但如果都不是上面哪些情况，但网卡统计里面任然有丢包计数，可以试着排查一下："
				}
			]
		},
		{
			"ID": "20230924014419-5i25xa6",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-5i25xa6",
				"updated": "20230924022743"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.6 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "网卡firmware版本:"
				}
			]
		},
		{
			"ID": "20230924014419-avg9a5a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-avg9a5a",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "排查一下网卡phy芯片firmware是不是有bug，安装的版本是不是符合预期，查看 ethtool -i eth1:"
				}
			]
		},
		{
			"ID": "20230924014419-1r272nf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-1r272nf",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-enwclmh"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-mxq3qtt",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-mxq3qtt",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "和厂家提case询问是不是已知问题，有没有新版本等；"
				}
			]
		},
		{
			"ID": "20230924014419-yc7j2xm",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-yc7j2xm",
				"updated": "20230924022748"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.7 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "网线接触不良："
				}
			]
		},
		{
			"ID": "20230924014419-elwwl3k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-elwwl3k",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果网卡统计里面存在crc error 计数增长，很可能是网线接触不良，可以通知网管排查一下："
				}
			]
		},
		{
			"ID": "20230924014419-9wzlhnn",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-9wzlhnn",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ethtool -S eth0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-rrgln89",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-rrgln89",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-xtbp0qo"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-zrcw1br",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-zrcw1br",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：一般试着重新插拔一下网线，或者换一根网线，排查插口是否符合端口规格等;"
				}
			]
		},
		{
			"ID": "20230924014419-j3dwmpg",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-j3dwmpg",
				"updated": "20230924022822"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.8 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "报文长度丢包"
				}
			]
		},
		{
			"ID": "20230924014419-0l0b1xv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-0l0b1xv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "网卡有接收正确报文长度范围，一般正常以太网报文长度范围：64-1518，发送端正常情况会填充或者分片来适配，偶尔会发生一些异常情况导致发送报文不正常丢包；"
				}
			]
		},
		{
			"ID": "20230924014419-s8od414",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-s8od414",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-nepgikr",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-nepgikr",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ethtool -S eth1|grep length_errors\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-9pmta2h",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-9pmta2h",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-lma1go6"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-xaua5xl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xaua5xl",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-7ipy779",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-7ipy779",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1  调整接口MTU配置，是否开启支持以太网巨帧；"
				}
			]
		},
		{
			"ID": "20230924014419-oafd903",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-oafd903",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2  发送端开启PATH MTU进行合理分片；"
				}
			]
		},
		{
			"ID": "20230924014419-pyfgh2k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-pyfgh2k",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "简单总结一下网卡丢包："
				}
			]
		},
		{
			"ID": "20230924014419-r3y20zw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-r3y20zw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-gxzw32k"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-axsbo52",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014419-axsbo52",
				"updated": "20230924022915"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.2 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "网卡驱动丢包"
				}
			]
		},
		{
			"ID": "20230924014419-bnvalfw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-bnvalfw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看：ifconfig eth1/eth0 等接口"
				}
			]
		},
		{
			"ID": "20230924014419-fmrh58d",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-fmrh58d",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-c2q8ulv"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-fa5w7m8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-fa5w7m8",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.RX errors: 表示总的收包的错误数量，还包括too-long-frames错误，Ring Buffer 溢出错误，crc 校验错误，帧同步错误，fifo overruns 以及 missed pkg 等等。"
				}
			]
		},
		{
			"ID": "20230924014419-b80hbr1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-b80hbr1",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.RX dropped: 表示数据包已经进入了 Ring Buffer，但是由于内存不够等系统原因，导致在拷贝到内存的过程中被丢弃。"
				}
			]
		},
		{
			"ID": "20230924014419-hfjq8u5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hfjq8u5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.RX overruns: 表示了 fifo 的 overruns，这是由于 Ring Buffer(aka Driver Queue) 传输的  IO 大于 kernel 能够处理的 IO 导致的，而 Ring Buffer 则是指在发起 IRQ 请求之前的那块 buffer。很明显，overruns  的增大意味着数据包没到 Ring Buffer 就被网卡物理层给丢弃了，而 CPU 无法即使的处理中断是造成 Ring Buffer  满的原因之一，上面那台有问题的机器就是因为 interruprs 分布的不均匀(都压在 core0)，没有做 affinity 而造成的丢包。"
				}
			]
		},
		{
			"ID": "20230924014419-mojojok",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-mojojok",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-whiua7g",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20230924014418-whiua7g",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-p2g3c8e",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-p2g3c8e",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "RX frame: 表示 misaligned 的 frames。"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-nphja5x",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NS4=",
						"Num": 5
					},
					"Properties": {
						"id": "20230924014418-nphja5x",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-066oh9x",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-066oh9x",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "对于 TX 的来说，出现上述 counter 增大的原因主要包括 aborted transmission, errors due to  carrirer, fifo error, heartbeat erros 以及 windown error，而 collisions  则表示由于 CSMA/CD 造成的传输中断。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-x3hivl7",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-x3hivl7",
				"updated": "20230924023417"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.1 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "驱动溢出丢包"
				}
			]
		},
		{
			"ID": "20230924014419-35m6zwb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-35m6zwb",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "netdev_max_backlog是内核从NIC收到包后，交由协议栈（如IP、TCP）处理之前的缓冲队列。每个CPU核都有一个backlog队列，与Ring Buffer同理，当接收包的速率大于内核协议栈处理的速率时，CPU的backlog队列不断增长，当达到设定的netdev_max_backlog值时，数据包将被丢弃。"
				}
			]
		},
		{
			"ID": "20230924014419-4lw7bx7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-4lw7bx7",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看:"
				}
			]
		},
		{
			"ID": "20230924014419-cupgy8f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-cupgy8f",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "通过查看/proc/net/softnet_stat可以确定是否发生了netdev backlog队列溢出："
				}
			]
		},
		{
			"ID": "20230924014419-m0e7jy5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-m0e7jy5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-rjt39g7"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-xn8yosl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xn8yosl",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "其中：每一行代表每个CPU核的状态统计，从CPU0依次往下；每一列代表一个CPU核的各项统计：第一列代表中断处理程序收到的包总数；第二列即代表由于netdev_max_backlog队列溢出而被丢弃的包总数。从上面的输出可以看出，这台服务器统计中，并没有因为netdev_max_backlog导致的丢包。"
				}
			]
		},
		{
			"ID": "20230924014419-ym39j8r",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ym39j8r",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-51w4cz8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-51w4cz8",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "netdev_max_backlog的默认值是1000，在高速链路上，可能会出现上述第二统计不为0的情况，可以通过修改内核参数net.core.netdev_max_backlog来解决："
				}
			]
		},
		{
			"ID": "20230924014419-az3z8xd",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-az3z8xd",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ sysctl -w net.core.netdev_max_backlog=2000\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-oo4kn3z",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-oo4kn3z",
				"updated": "20230924023435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.1.2 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "单核负载高导致丢包"
				}
			]
		},
		{
			"ID": "20230924014419-1o661dh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-1o661dh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "单核CPU软中断占有高, 导致应用没有机会收发或者收包比较慢，即使调整netdev_max_backlog队列大小仍然会一段时间后丢包，处理速度跟不上网卡接收的速度;"
				}
			]
		},
		{
			"ID": "20230924014419-grjsnds",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-grjsnds",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看：mpstat -P ALL 1"
				}
			]
		},
		{
			"ID": "20230924014419-uhhdzlq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-uhhdzlq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-vmji467"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-86irwbr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-86irwbr",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "单核软中断占有100%，导致应用没有机会收发或者收包比较慢而丢包；"
				}
			]
		},
		{
			"ID": "20230924014419-xj4pr00",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xj4pr00",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "解决方案"
				},
				{
					"Type": "NodeText",
					"Data": "​："
				}
			]
		},
		{
			"ID": "20230924014419-22dcl77",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-22dcl77",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.调整网卡RSS队列配置："
				}
			]
		},
		{
			"ID": "20230924014419-q2cav8v",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-q2cav8v",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看：ethtool -x ethx；"
				}
			]
		},
		{
			"ID": "20230924014419-6ta2zkq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-6ta2zkq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "调整：ethtool -X ethx xxxx；"
				}
			]
		},
		{
			"ID": "20230924014419-5v80m9t",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-5v80m9t",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.看一下网卡中断配置是否均衡 cat /proc/interrupts"
				}
			]
		},
		{
			"ID": "20230924014419-tdlaqf8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tdlaqf8",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "调整："
				}
			]
		},
		{
			"ID": "20230924014419-1c8tm3b",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-1c8tm3b",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "1） irqbalance 调整；\n# 查看当前运行情况\nservice irqbalance status\n# 终止服务\nservice irqbalance stop\n2） 中断绑CPU核 echo mask \u003e /proc/irq/xxx/smp_affinity\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-hfw8z34",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hfw8z34",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.根据CPU和网卡队列个数调整网卡多队列和RPS配置"
				}
			]
		},
		{
			"ID": "20230924014419-raqvwcc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-raqvwcc",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "-CPU大于网卡队列个数："
				}
			]
		},
		{
			"ID": "20230924014419-ppfh6ne",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ppfh6ne",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看网卡队列 ethtool -x ethx；"
				}
			]
		},
		{
			"ID": "20230924014419-ytdnmiy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ytdnmiy",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "协议栈开启RPS并设置RPS；"
				}
			]
		},
		{
			"ID": "20230924014419-rcskn5z",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-rcskn5z",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "echo $mask（CPU配置）\u003e /sys/class/net/$eth/queues/rx-$i/rps_cpus\necho 4096（网卡buff）\u003e /sys/class/net/$eth/queues/rx-$i/rps_flow_cnt\n2）CPU小于网卡队列个数，绑中断就可以，可以试着关闭RPS看一下效果：\necho 0 \u003e /sys/class/net/\u003cdev\u003e/queues/rx-\u003cn\u003e/rps_cpus\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-d8x0x3a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-d8x0x3a",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.numa CPU调整，对齐网卡位置，可以提高内核处理速度，从而给更多CPU给应用收包，减缓丢包概率；"
				}
			]
		},
		{
			"ID": "20230924014419-61fnur3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-61fnur3",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看网卡numa位置："
				}
			]
		},
		{
			"ID": "20230924014419-uf3ttjm",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-uf3ttjm",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ethtool -i eth1|grep bus-info\nlspci -s bus-info -vv|grep node\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-tdl1p4q",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tdl1p4q",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "上面中断和RPS设置里面mask需要重新按numa CPU分配重新设置;"
				}
			]
		},
		{
			"ID": "20230924014419-xlq9v1l",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xlq9v1l",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.可以试着开启中断聚合（看网卡是否支持）"
				}
			]
		},
		{
			"ID": "20230924014419-merx8th",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-merx8th",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看 :"
				}
			]
		},
		{
			"ID": "20230924014419-2qwct2l",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-2qwct2l",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": " ethtool -c ethx\nCoalesce parameters for eth1:\nAdaptive RX: on  TX: on\nstats-block-usecs: 0\nsample-interval: 0\npkt-rate-low: 0\npkt-rate-high: 0\n\n\nrx-usecs: 25\nrx-frames: 0\nrx-usecs-irq: 0\nrx-frames-irq: 256\n\n\ntx-usecs: 25\ntx-frames: 0\ntx-usecs-irq: 0\ntx-frames-irq: 256\n\n\nrx-usecs-low: 0\nrx-frame-low: 0\ntx-usecs-low: 0\ntx-frame-low: 0\n\n\nrx-usecs-high: 0\nrx-frame-high: 0\ntx-usecs-high: 0\ntx-frame-high: 0\n\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-k6kh2va",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-k6kh2va",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "调整："
				}
			]
		},
		{
			"ID": "20230924014419-4gx2oau",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-4gx2oau",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ethtool -C ethx adaptive-rx on\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-qgnp8ms",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-qgnp8ms",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "简单总结一下网卡驱动丢包处理："
				}
			]
		},
		{
			"ID": "20230924014419-jutipda",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jutipda",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-subbljz"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-jqf22co",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-jqf22co",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-hjzd4ba",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hjzd4ba",
				"updated": "20230924023559"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​​"
				}
			]
		},
		{
			"ID": "20230924014419-vfn9uvc",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014419-vfn9uvc",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "内核协议栈丢包"
				}
			]
		},
		{
			"ID": "20230924014419-hnxgj4k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hnxgj4k",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "以太网链路层丢包"
				}
			]
		},
		{
			"ID": "20230924014419-n0o3ija",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-n0o3ija",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "neighbor系统arp丢包"
				}
			]
		},
		{
			"ID": "20230924014419-8x0zc26",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-8x0zc26",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "arp_ignore配置丢包"
				}
			]
		},
		{
			"ID": "20230924014419-2m9aug9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2m9aug9",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "arp_ignore参数的作用是控制系统在收到外部的arp请求时，是否要返回arp响应。arp_ignore参数常用的取值主要有0，1，2，3~8较少用到；"
				}
			]
		},
		{
			"ID": "20230924014419-rn9m3tu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-rn9m3tu",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看：sysctl -a|grep arp_ignore"
				}
			]
		},
		{
			"ID": "20230924014419-bu3sfq2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-bu3sfq2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014418-yek7476"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-g0yi3gq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-g0yi3gq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "解决方案"
				},
				{
					"Type": "NodeText",
					"Data": "​：根据实际场景设置对应值；"
				}
			]
		},
		{
			"ID": "20230924014419-bz4ac97",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-bz4ac97",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "0：响应任意网卡上接收到的对本机IP地址的arp请求（包括环回网卡上的地址），而不管该目的IP是否在接收网卡上。"
				}
			]
		},
		{
			"ID": "20230924014419-vkf3jca",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-vkf3jca",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1：只响应目的IP地址为接收网卡上的本地地址的arp请求。"
				}
			]
		},
		{
			"ID": "20230924014419-c1dwj6z",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-c1dwj6z",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2：只响应目的IP地址为接收网卡上的本地地址的arp请求，并且arp请求的源IP必须和接收网卡同网段。"
				}
			]
		},
		{
			"ID": "20230924014419-7dklj97",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-7dklj97",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3：如果ARP请求数据包所请求的IP地址对应的本地地址其作用域（scope）为主机（host），则不回应ARP响应数据包，如果作用域为全局（global）或链路（link），则回应ARP响应数据包。"
				}
			]
		},
		{
			"ID": "20230924014419-5wa4xpd",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-5wa4xpd",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-htrxigp"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014418-s3hvy64"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-6si5eja",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-6si5eja",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong strong",
					"TextMarkTextContent": "arp_filter配置丢包"
				}
			]
		},
		{
			"ID": "20230924014419-tl9ymj4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tl9ymj4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在多接口系统里面（比如腾讯云的弹性网卡场景），这些接口都可以回应arp请求，导致对端有可能学到不同的mac地址，后续报文发送可能由于mac地址和接收报文接口mac地址不一样而导致丢包，arp_filter主要是用来适配这种场景；"
				}
			]
		},
		{
			"ID": "20230924014419-blt9iv2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-blt9iv2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-z7tafhj",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-z7tafhj",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "sysctl -a | grep arp_filter\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-sawfmck",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-sawfmck",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-pwc0vo6"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-xehpul1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xehpul1",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-288q3vu",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-288q3vu",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "根据实际场景设置对应的值，一般默认是关掉此过滤规则，特殊情况可以打开；\n0：默认值，表示回应arp请求的时候不检查接口情况；\n1：表示回应arp请求时会检查接口是否和接收请求接口一致，不一致就不回应；\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-obo42u9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-obo42u9",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "arp表满导致丢包"
				}
			]
		},
		{
			"ID": "20230924014419-qso2lv8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-qso2lv8",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "比如下面这种情况，由于突发arp表项很多 超过协议栈默认配置，发送报文的时候部分arp创建失败，导致发送失败，从而丢包："
				}
			]
		},
		{
			"ID": "20230924014419-847uv1f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-847uv1f",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-vox5ax1"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-3eo5y75",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-3eo5y75",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-lgphxik",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-lgphxik",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-hswxbkr",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-hswxbkr",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-gofyhmw",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-gofyhmw",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看arp状态：cat /proc/net/stat/arp_cache ，table_fulls统计："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-zzbzc98",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-zzbzc98",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-7qr1qmu"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-onmps0d",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-onmps0d",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-p3ihmrf",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-p3ihmrf",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-e2wo09e",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-e2wo09e",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看dmesg消息（内核打印）："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-jud4qn5",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-jud4qn5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "dmesg|grep neighbour\nneighbour: arp_cache: neighbor table overflow!\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-b4kg6f6",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-b4kg6f6",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-db6vbmp",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-db6vbmp",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-1lfn5tx",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-1lfn5tx",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看当前arp表大小：ip n|wc -l"
								}
							]
						},
						{
							"ID": "20230924014419-vqx416l",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-vqx416l",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看系统配额："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-5nwlttz",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-5nwlttz",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "sysctl -a |grep net.ipv4.neigh.default.gc_thresh\ngc_thresh1：存在于ARP高速缓存中的最少层数，如果少于这个数，垃圾收集器将不会运行。缺省值是128。\n\n\ngc_thresh2 ：保存在 ARP 高速缓存中的最多的记录软限制。垃圾收集器在开始收集前，允许记录数超过这个数字 5 秒。缺省值是 512。\ngc_thresh3 ：保存在 ARP 高速缓存中的最多记录的硬限制，一旦高速缓存中的数目高于此，垃圾收集器将马上运行。缺省值是1024。\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-j5uf3pb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-j5uf3pb",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "一般在内存足够情况下，可以认为gc_thresh3 值是arp 表总大小；"
				}
			]
		},
		{
			"ID": "20230924014419-vjmfhhw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-vjmfhhw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-r3qg00t"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-pg1r0u4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-pg1r0u4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "解决方案"
				},
				{
					"Type": "NodeText",
					"Data": "​：根据实际arp最大值情况（比如访问其他子机最大个数），调整arp表大小"
				}
			]
		},
		{
			"ID": "20230924014419-nilr5tc",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-nilr5tc",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ sudo sysctl -w net.ipv4.neigh.default.gc_thresh1=1024\n$ sudo sysctl -w net.ipv4.neigh.default.gc_thresh2=2048\n$ sudo sysctl -w net.ipv4.neigh.default.gc_thresh3=4096\n$ sudo sysctl  -p\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-f0upwqj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-f0upwqj",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "arp请求缓存队列溢出丢包"
				}
			]
		},
		{
			"ID": "20230924014419-u5w1jw6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-u5w1jw6",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-33926aw",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-33926aw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat /proc/net/stat/arp_cache ，unresolved_discards是否有新增计数\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-k70il4a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-k70il4a",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：根据客户需求调整缓存队列大小unres_qlen_bytes："
				}
			]
		},
		{
			"ID": "20230924014419-3jdbqj5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-3jdbqj5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-lfnsq73"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-8tq7l4f",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-8tq7l4f",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-g386z6o",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014419-g386z6o",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "网络IP层丢包"
				}
			]
		},
		{
			"ID": "20230924014419-1ptmp5b",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-1ptmp5b",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "接口ip地址配置丢包"
				}
			]
		},
		{
			"ID": "20230924014419-nugg8m2",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-nugg8m2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-fgqa0fx",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20230924014418-fgqa0fx",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-ous9fc0",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-ous9fc0",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "本机服务不通，检查lo接口有没有配置地址是127.0.0.1；"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-2t1ex55",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2t1ex55",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2 .本机接收失败， 查看local路由表：ip r show table local|grep 子机ip地址；这种丢包一般会出现在多IP场景，子机底层配置多ip失败，导致对应ip收不到包而丢包；"
				}
			]
		},
		{
			"ID": "20230924014419-5d3zl0r",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-5d3zl0r",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-rjvs042"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-9a1pwbs",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-9a1pwbs",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-l2ei21j",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-l2ei21j",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.配置正确接口ip地址；比如ip a add 1.1.1.1 dev eth0"
				}
			]
		},
		{
			"ID": "20230924014419-rq7tqm4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-rq7tqm4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.如果发现接口有地址还丢包，可能是local路由表没有对应条目，紧急情况下，可以用手工补上："
				}
			]
		},
		{
			"ID": "20230924014419-s9nxdox",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-s9nxdox",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "比如ip r add local 本机ip地址 dev eth0 table local ；"
				}
			]
		},
		{
			"ID": "20230924014419-l0j8grt",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-l0j8grt",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-21cgexp",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-21cgexp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "路由丢包"
				}
			]
		},
		{
			"ID": "20230924014419-mfb357e",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-mfb357e",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong strong",
					"TextMarkTextContent": "路由配置丢包"
				}
			]
		},
		{
			"ID": "20230924014419-sovjkcf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-sovjkcf",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-y5fubib",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-y5fubib",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.查看配置 路由是否设置正确（是否可达），是否配置策略路由（在弹性网卡场景会出现此配置）ip rule："
				}
			]
		},
		{
			"ID": "20230924014419-xuholug",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xuholug",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014418-4j03ltc"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-xwut1u5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xwut1u5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "然后找到对应路由表。查看路由表："
				}
			]
		},
		{
			"ID": "20230924014419-w2tvt44",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-w2tvt44",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-4bv6l45"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-xa5cp0y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xa5cp0y",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "或者直接用 ip r get x.x.x.x，让系统帮你查找是否存在可达路由，接口是否符合预期；"
				}
			]
		},
		{
			"ID": "20230924014419-ozguaet",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ozguaet",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.查看系统统计信息："
				}
			]
		},
		{
			"ID": "20230924014419-y4hd3zg",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-y4hd3zg",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s|grep \"dropped because of missing route\"\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-0s1984t",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-0s1984t",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：重新配置正确的路由；"
				}
			]
		},
		{
			"ID": "20230924014419-muf4b0h",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-muf4b0h",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-pid9yhg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-pid9yhg",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "反向路由过滤丢包"
				}
			]
		},
		{
			"ID": "20230924014419-hu5xsbq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hu5xsbq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "反向路由过滤机制是Linux通过反向路由查询，检查收到的数据包源IP是否可路由（Loose mode）、是否最佳路由（Strict mode），如果没有通过验证，则丢弃数据包，设计的目的是防范IP地址欺骗攻击。"
				}
			]
		},
		{
			"ID": "20230924014419-xjqq0c7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xjqq0c7",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-ymhp88t",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ymhp88t",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "rp_filter提供三种模式供配置："
				}
			]
		},
		{
			"ID": "20230924014419-1x9y5a4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-1x9y5a4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "0 - 不验证"
				}
			]
		},
		{
			"ID": "20230924014419-919thq1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-919thq1",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1 - RFC3704定义的严格模式：对每个收到的数据包，查询反向路由，如果数据包入口和反向路由出口不一致，则不通过"
				}
			]
		},
		{
			"ID": "20230924014419-hgoa889",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hgoa889",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2 - RFC3704定义的松散模式：对每个收到的数据包，查询反向路由，如果任何接口都不可达，则不通过"
				}
			]
		},
		{
			"ID": "20230924014419-jqp9idn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jqp9idn",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看当前rp_filter策略配置："
				}
			]
		},
		{
			"ID": "20230924014419-aa18uvq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-aa18uvq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "$cat /proc/sys/net/ipv4/conf/eth0/rp_filter"
				}
			]
		},
		{
			"ID": "20230924014419-xi5ghcf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xi5ghcf",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果这里设置为1，就需要查看主机的网络环境和路由策略是否可能会导致客户端的入包无法通过反向路由验证了。"
				}
			]
		},
		{
			"ID": "20230924014419-r79jdeu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-r79jdeu",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "从原理来看这个机制工作在网络层，因此，如果客户端能够Ping通服务器，就能够排除这个因素了。"
				}
			]
		},
		{
			"ID": "20230924014419-akhsa8a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-akhsa8a",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-1qnmuit",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-1qnmuit",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "根据实际网络环境将rp_filter设置为0或2："
				}
			]
		},
		{
			"ID": "20230924014419-npkqwfn",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-npkqwfn",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ sysctl -w net.ipv4.conf.all.rp_filter=2或\n$ sysctl -w net.ipv4.conf.eth0.rp_filter=2\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-e75x7dr",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-e75x7dr",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "防火墙丢包"
				}
			]
		},
		{
			"ID": "20230924014419-v1k8ml2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-v1k8ml2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "客户设置规则导致丢包"
				}
			]
		},
		{
			"ID": "20230924014419-ti6yxvo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ti6yxvo",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-lx9p6vr",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-lx9p6vr",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "  iptables -nvL |grep DROP ;\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-839zm9r",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-839zm9r",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：  修改防火墙规则；"
				}
			]
		},
		{
			"ID": "20230924014419-tembgem",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-tembgem",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-g910ftz",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-g910ftz",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "连接跟踪导致丢包"
				}
			]
		},
		{
			"ID": "20230924014419-s0ctvth",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-s0ctvth",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong strong",
					"TextMarkTextContent": "连接跟踪表溢出丢包"
				}
			]
		},
		{
			"ID": "20230924014419-ok9ewaf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ok9ewaf",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "kernel  用 ip_conntrack 模块来记录 iptables 网络包的状态，并把每条记录保存到 table 里（这个 table  在内存里，可以通过/proc/net/ip_conntrack  查看当前已经记录的总数），如果网络状况繁忙，比如高连接，高并发连接等会导致逐步占用这个 table 可用空间，一般这个 table  很大不容易占满并且可以自己清理，table 的记录会一直呆在 table 里占用空间直到源 IP 发一个 RST  包，但是如果出现被攻击、错误的网络配置、有问题的路由/路由器、有问题的网卡等情况的时候，就会导致源 IP 发的这个 RST  包收不到，这样就积累在 table 里，越积累越多直到占满。无论，哪种情况导致table变满，满了以后就会丢包，出现外部无法连接服务器的情况。内核会报如下错误信息：kernel: ip_conntrack: table full, dropping packet；"
				}
			]
		},
		{
			"ID": "20230924014419-r7xqztw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-r7xqztw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看当前连接跟踪数 :"
				}
			]
		},
		{
			"ID": "20230924014419-qqsgqjh",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-qqsgqjh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat /proc/sys/net/netfilter/nf_conntrack_max\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-s1ghdqi",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-s1ghdqi",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-vzoo9d0",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-vzoo9d0",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "增大跟踪的最大条数\nnet.netfilter.nf_conntrack_max  = 3276800\n减少跟踪连接的最大有效时间\nnet.netfilter.nf_conntrack_tcp_timeout_established = 1200\nnet.netfilter.nf_conntrack_udp_timeout_stream = 180\nnet.netfilter.nf_conntrack_icmp_timeout = 30\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-6p52aze",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-6p52aze",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-ggdi38p",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ggdi38p",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "ct创建冲突失导致丢包"
				}
			]
		},
		{
			"ID": "20230924014419-eill1vm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-eill1vm",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看：当前连接跟踪统计：cat /proc/net/stat/nf_conntrack，可以查各种ct异常丢包统计"
				}
			]
		},
		{
			"ID": "20230924014419-2sprggv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2sprggv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-p65s82c"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-olq3z6i",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-olq3z6i",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：内核热补丁修复或者更新内核版本（合入补丁修改）；"
				}
			]
		},
		{
			"ID": "20230924014419-e6h8lr3",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-e6h8lr3",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-4ddlunf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-4ddlunf",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "传输层UDP/TCP丢包"
				}
			]
		},
		{
			"ID": "20230924014419-xyyljip",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xyyljip",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "tcp 连接跟踪安全检查丢包"
				}
			]
		},
		{
			"ID": "20230924014419-ozpg3k6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ozpg3k6",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "丢包原因：由于连接没有断开，但服务端或者client之前出现过发包异常等情况（报文没有经过连接跟踪模块更新窗口计数），没有更新合法的window范围，导致后续报文安全检查被丢包；协议栈用nf_conntrack_tcp_be_liberal 来控制这个选项："
				}
			]
		},
		{
			"ID": "20230924014419-i4m0shx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-i4m0shx",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1：关闭，只有不在tcp窗口内的rst包被标志为无效；"
				}
			]
		},
		{
			"ID": "20230924014419-2dtsjsy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2dtsjsy",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "0：开启;   所有不在tcp窗口中的包都被标志为无效；"
				}
			]
		},
		{
			"ID": "20230924014419-aa0f3sg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-aa0f3sg",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-nz6vzbh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-nz6vzbh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看配置 ："
				}
			]
		},
		{
			"ID": "20230924014419-b4xy7r9",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-b4xy7r9",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "sysctl -a|grep nf_conntrack_tcp_be_liberal \nnet.netfilter.nf_conntrack_tcp_be_liberal = 1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-cr1czrh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-cr1czrh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看log："
				}
			]
		},
		{
			"ID": "20230924014419-v6jwthd",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-v6jwthd",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "一般情况下netfiler模块默认没有加载log，需要手动加载;"
				}
			]
		},
		{
			"ID": "20230924014419-f9yw1lb",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-f9yw1lb",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "modprobe ipt_LOG11\nsysctl -w net.netfilter.nf_log.2=ipt_LOG\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-4oci7wv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-4oci7wv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "然后发包后在查看syslog；"
				}
			]
		},
		{
			"ID": "20230924014419-3kwnvyz",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-3kwnvyz",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：根据实际抓包分析情况判断是不是此机制导致的丢包，可以试着关闭试一下；"
				}
			]
		},
		{
			"ID": "20230924014419-1vs8hsh",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-1vs8hsh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "分片重组丢包"
				}
			]
		},
		{
			"ID": "20230924014419-npkfyzy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-npkfyzy",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "情况总结："
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "超时"
				}
			]
		},
		{
			"ID": "20230924014419-jxbw1mg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jxbw1mg",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-uiqcof4",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-uiqcof4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s|grep timeout\n601 fragments dropped after timeout\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-lrde7g1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-lrde7g1",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方法：调整超时时间"
				}
			]
		},
		{
			"ID": "20230924014419-n4z5h49",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-n4z5h49",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "net.ipv4.ipfrag_time = 30\nsysctl -w net.ipv4.ipfrag_time=60\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-a0r38q0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-a0r38q0",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "frag_high_thresh, 分片的内存超过一定阈值会导致系统安全检查丢包"
				}
			]
		},
		{
			"ID": "20230924014419-gy5ww2m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-gy5ww2m",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-w7u3nmc",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-w7u3nmc",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s|grep reassembles\n8094 packet reassembles failed\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-m4e6kav",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-m4e6kav",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：调整大小"
				}
			]
		},
		{
			"ID": "20230924014419-cvzq0og",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-cvzq0og",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "net.ipv4.ipfrag_high_thresh \nnet.ipv4.ipfrag_low_thresh\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-k0ly4fy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-k0ly4fy",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "分片安全距检查离丢包"
				}
			]
		},
		{
			"ID": "20230924014419-dtpspyh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-dtpspyh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-i0qncnt",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-i0qncnt",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s|grep reassembles\n8094 packet reassembles failed\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-7to9y4u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-7to9y4u",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案： 把ipfrag_max_dist设置为0，就关掉此安全检查"
				}
			]
		},
		{
			"ID": "20230924014419-e819cj4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-e819cj4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-s5vwoer"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-v9eza7g",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-v9eza7g",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "pfrag_max_dist特性，在一些场景下其实并不适用："
				}
			]
		},
		{
			"ID": "20230924014419-nojbbqr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-nojbbqr",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.有大量的网络报文交互"
				}
			]
		},
		{
			"ID": "20230924014419-relt7ix",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-relt7ix",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.发送端的并发度很高，同时SMP架构，导致很容易造成这种乱序情况；"
				}
			]
		},
		{
			"ID": "20230924014419-ebk0aql",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ebk0aql",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "分片hash bucket冲突链太长超过系统默认值128"
				}
			]
		},
		{
			"ID": "20230924014419-dcjfidf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-dcjfidf",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-fgjl909",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-fgjl909",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "dmesg|grep “Dropping fragment”\ninet_frag_find: Fragment hash bucket 128 list length grew over limit. Dropping fragment.\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-l28wxr6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-l28wxr6",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：热补丁调整hash大小；"
				}
			]
		},
		{
			"ID": "20230924014419-bh0xxfc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-bh0xxfc",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "系统内存不足，创建新分片队列失败"
				}
			]
		},
		{
			"ID": "20230924014419-g1d5hhq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-g1d5hhq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看方法："
				}
			]
		},
		{
			"ID": "20230924014419-yfazv8j",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-yfazv8j",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s|grep reassembles\n8094 packet reassembles failed\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-idudo6f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-idudo6f",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "dropwatch查看丢包位置 ："
				}
			]
		},
		{
			"ID": "20230924014419-a2hg6tw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-a2hg6tw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014418-uka02jw"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-xxbd2cy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xxbd2cy",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-ka6o7t3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ka6o7t3",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "a.增大系统网络内存："
				}
			]
		},
		{
			"ID": "20230924014419-3n55oqt",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-3n55oqt",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "net.core.rmem_default \nnet.core.rmem_max \nnet.core.wmem_default\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-czryoxs",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-czryoxs",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "b.系统回收内存："
				}
			]
		},
		{
			"ID": "20230924014419-tknkhz2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tknkhz2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "紧急情况下，可以用 /proc/sys/vm/drop_caches, 去释放一下虚拟内存；"
				}
			]
		},
		{
			"ID": "20230924014419-jj9idvb",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-jj9idvb",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "To free pagecache:\n# echo 1 \u003e /proc/sys/vm/drop_caches\nTo free dentries and inodes:\n# echo 2 \u003e /proc/sys/vm/drop_caches\nTo free pagecache, dentries and inodes:\necho 3 \u003e /proc/sys/vm/drop_caches\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-wa9wadp",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-wa9wadp",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-v82ro5d",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-v82ro5d",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "MTU丢包"
				}
			]
		},
		{
			"ID": "20230924014419-rbd36g0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-rbd36g0",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-7it55uu"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-r9smq1p",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-r9smq1p",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-an5si4x",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-an5si4x",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.检查接口MTU配置，ifconfig eth1/eth0，默认是1500；"
				}
			]
		},
		{
			"ID": "20230924014419-8vr20k2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-8vr20k2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.进行MTU探测，然后设置接口对应的MTU值；"
				}
			]
		},
		{
			"ID": "20230924014419-90l55e7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-90l55e7",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-mwfj890",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-mwfj890",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-vznxrvq",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20230924014418-vznxrvq",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-q6od4jt",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-q6od4jt",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "根据实际情况，设置正确MTU值；"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-msvezp9",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20230924014418-msvezp9",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-i7khk4u",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-i7khk4u",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "设置合理的tcp mss，启用TCP MTU Probe:"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-a0xk0bd",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-a0xk0bd",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat /proc/sys/net/ipv4/tcp_mtu_probing:\ntcp_mtu_probing - INTEGER Controls TCP Packetization-Layer Path MTU Discovery.\nTakes three values:\n0 - Disabled \n1 - Disabled by default, enabled when an ICMP black hole detected\n2 - Always enabled, use initial MSS of tcp_base_mss.\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-ao33j68",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014419-ao33j68",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "tcp层丢包"
				}
			]
		},
		{
			"ID": "20230924014419-vicdoas",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-vicdoas",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong strong",
					"TextMarkTextContent": "TIME_WAIT过多丢包"
				}
			]
		},
		{
			"ID": "20230924014419-a7t22b8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-a7t22b8",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "大量TIMEWAIT出现，并且需要解决的场景，在高并发短连接的TCP服务器上，当服务器处理完请求后立刻按照主动正常关闭连接。。。这个场景下，会出现大量socket处于TIMEWAIT状态。如果客户端的并发量持续很高，此时部分客户端就会显示连接不上；"
				}
			]
		},
		{
			"ID": "20230924014419-132qxrv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-132qxrv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-jt0bxcp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jt0bxcp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看系统log ："
				}
			]
		},
		{
			"ID": "20230924014419-v781qxw",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-v781qxw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "dmsg\nTCP: time wait bucket table overflow；\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-d28wqfs",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-d28wqfs",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看系统配置："
				}
			]
		},
		{
			"ID": "20230924014419-5jr1sua",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-5jr1sua",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "sysctl -a|grep tcp_max_tw_buckets\nnet.ipv4.tcp_max_tw_buckets = 16384\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-168ixi9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-168ixi9",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-4pou54i",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-4pou54i",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-n2qyocm",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20230924014418-n2qyocm",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-7wb2st8",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-7wb2st8",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "tw_reuse，tw_recycle 必须在客户端和服务端timestamps 开启时才管用（默认打开）"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-vwuau88",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20230924014418-vwuau88",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-y2v23qf",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-y2v23qf",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "tw_reuse 只对客户端起作用，开启后客户端在1s内回收；"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-79twf8k",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20230924014418-79twf8k",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-33pfmt1",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-33pfmt1",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "tw_recycle对客户端和服务器同时起作用，开启后在3.5*RTO 内回收，RTO 200ms~ 120s具体时间视网络状况。内网状况比tw_reuse稍快，公网尤其移动网络大多要比tw_reuse 慢，优点就是能够回收服务端的TIME_WAIT数量；"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-e7gl8pe",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-e7gl8pe",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在服务端，如果网络路径会经过NAT节点，不要启用net.ipv4.tcp_tw_recycle，会导致时间戳混乱，引起其他丢包问题；"
				}
			]
		},
		{
			"ID": "20230924014419-thcf0dj",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-thcf0dj",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-o0un1qw",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20230924014418-o0un1qw",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-8hp51no",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-8hp51no",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "调整tcp_max_tw_buckets大小，如果内存足够："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-dtug29d",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-dtug29d",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "sysctl -w net.ipv4.tcp_max_tw_buckets=163840；\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-ug2hk9m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ug2hk9m",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "时间戳异常丢包"
				}
			]
		},
		{
			"ID": "20230924014419-g5zlmeo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-g5zlmeo",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "当多个客户端处于同一个NAT环境时，同时访问服务器，不同客户端的时间可能不一致，此时服务端接收到同一个NAT发送的请求，就会出现时间戳错乱的现象，于是后面的数据包就被丢弃了，具体的表现通常是是客户端明明发送的SYN，但服务端就是不响应ACK。在服务器借助下面的命令可以来确认数据包是否有不断被丢弃的现象。"
				}
			]
		},
		{
			"ID": "20230924014419-mvgzh5g",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-mvgzh5g",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "\u0026lt;span\u0026gt;检查：\u0026lt;/span\u0026gt;"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-0jqncon",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-0jqncon",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s | grep rejects\n\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-w91wvel",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-w91wvel",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-ssagt9u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ssagt9u",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果网络路径会经过NAT节点，不要启用net.ipv4.tcp_tw_recycle；"
				}
			]
		},
		{
			"ID": "20230924014419-g37tsgp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-g37tsgp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "TCP队列问题导致丢包"
				}
			]
		},
		{
			"ID": "20230924014419-7ve43uh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-7ve43uh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "原理："
				}
			]
		},
		{
			"ID": "20230924014419-nrizhqa",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-nrizhqa",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "tcp状态机（三次握手）"
				}
			]
		},
		{
			"ID": "20230924014419-9huq2tt",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-9huq2tt",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-6iftxr9"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-0cef2f8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-0cef2f8",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": " 协议处理："
				}
			]
		},
		{
			"ID": "20230924014419-k8kt4ot",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-k8kt4ot",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-3se2di2"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-yz3ktsi",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-yz3ktsi",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "一个是半连接队列（syn queue）："
				}
			]
		},
		{
			"ID": "20230924014419-f3mblbq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-f3mblbq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在三次握手协议中，服务器维护一个半连接队列，该队列为每个客户端的SYN包开设一个条目(服务端在接收到SYN包的时候，就已经创建了request_sock结构，存储在半连接队列中)，该条目表明服务器已收到SYN包，并向客户发出确认，正在等待客户的确认包（会进行第二次握手发送SYN＋ACK的包加以确认）。这些条目所标识的连接在服务器处于Syn_RECV状态，当服务器收到客户的确认包时，删除该条目，服务器进入ESTABLISHED状态。该队列为SYN队列，长度为max(64,/proc/sys/net/ipv4/tcp_max_syn_backlog),  机器的tcp_max_syn_backlog值在/proc/sys/net/ipv4/tcp_max_syn_backlog下配置;"
				}
			]
		},
		{
			"ID": "20230924014419-nv1xn9k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-nv1xn9k",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "一个是全连接队列（accept queue）："
				}
			]
		},
		{
			"ID": "20230924014419-3e30lx1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-3e30lx1",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "第三次握手时，当server接收到ACK  报之后， 会进入一个新的叫 accept 的队列，该队列的长度为 min(backlog,  somaxconn)，默认情况下，somaxconn 的值为 128，表示最多有 129 的 ESTAB 的连接等待 accept()，而  backlog 的值则应该是由 int listen(int sockfd, int backlog) 中的第二个参数指定，listen 里面的  backlog 可以有我们的应用程序去定义的;"
				}
			]
		},
		{
			"ID": "20230924014419-8ug05k2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-8ug05k2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-f5v4s8w",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-f5v4s8w",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "连接建立失败,syn丢包："
				}
			]
		},
		{
			"ID": "20230924014419-zy4lfrv",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-zy4lfrv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s |grep -i listen\nSYNs to LISTEN sockets dropped\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-ealb42b",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ealb42b",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "也会受到连接满丢包影响"
				}
			]
		},
		{
			"ID": "20230924014419-99pysqr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-99pysqr",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案： 增加大小 tcp_max_syn_backlog"
				}
			]
		},
		{
			"ID": "20230924014419-knhskhd",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-knhskhd",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "连接满丢包"
				}
			]
		},
		{
			"ID": "20230924014419-yravk1m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-yravk1m",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "-xxx times the listen queue of a socket overflowed"
				}
			]
		},
		{
			"ID": "20230924014419-xqqf9jj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xqqf9jj",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-c0ur8ju",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-c0ur8ju",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-eq9jf7l",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-eq9jf7l",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-0ipo5lr",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-0ipo5lr",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看accept队列大小 ：net.core.somaxconn"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-51l88jf",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-51l88jf",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-teohlls",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-teohlls",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "ss -lnt查询socket队列 ：LISTEN  状态: Recv-Q 表示的当前等待服务端调用 accept 完成三次握手的 listen backlog 数值，也就是说，当客户端通过  connect() 去连接正在 listen() 的服务端时，这些连接会一直处于这个 queue 里面直到被服务端 accept()；Send-Q 表示的则是最大的 listen backlog 数值，这就就是上面提到的 min(backlog, somaxconn) 的值，"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-spdo7pc",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-spdo7pc",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-x90uwy4",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-x90uwy4",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "看一下是不是应用程序设置限制， int listen(int sockfd, int backlog)；"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-95nil7p",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-95nil7p",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-8n4o07k",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-8n4o07k",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-ifgkcoh",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-ifgkcoh",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-riwtxyz",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-riwtxyz",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Linux内核参进行优化，可以缓解压力 tcp_abort_on_overflow=1"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-ncdxe75",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-ncdxe75",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-1y2rca6",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-1y2rca6",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "调整net.core.somaxconn大小;"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-asc5l5b",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-asc5l5b",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-2zevlvl",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-2zevlvl",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "应用程序设置问题，通知客户程序修改；"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-iwpul2a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-iwpul2a",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong strong",
					"TextMarkTextContent": "syn flood攻击丢包"
				}
			]
		},
		{
			"ID": "20230924014419-ofzvnbm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ofzvnbm",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "目前，Linux下默认会进行5次重发SYN-ACK包，重试的间隔时间从1s开始，下次的重试间隔时间是前一次的双倍，5次的重试时间间隔为1s,  2s, 4s, 8s, 16s，总共31s，第5次发出后还要等32s都知道第5次也超时了，所以，总共需要 1s + 2s + 4s+ 8s+  16s + 32s = 63s，TCP才会把断开这个连接。由于，SYN超时需要63秒，那么就给攻击者一个攻击服务器的机会，攻击者在短时间内发送大量的SYN包给Server(俗称 SYN flood 攻击)，用于耗尽Server的SYN队列。对于应对SYN 过多的问题;"
				}
			]
		},
		{
			"ID": "20230924014419-jnn0ffl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jnn0ffl",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看：  查看syslog：  kernel: [3649830.269068] TCP: Possible SYN flooding on port xxx. Sending cookies. Check SNMP counters."
				}
			]
		},
		{
			"ID": "20230924014419-4660ph2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-4660ph2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-o0lupbf",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-o0lupbf",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-4ugilbs",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-4ugilbs",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-tmw9mnd",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-tmw9mnd",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "增大tcp_max_syn_backlog"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-ri5tw3t",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-ri5tw3t",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-8g6s5ul",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-8g6s5ul",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "减少tcp_synack_retries"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-kq14wyp",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-kq14wyp",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-7libxg3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-7libxg3",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "启用tcp_syncookies"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-flvxomk",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-flvxomk",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-6lxd3za",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-6lxd3za",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "启用tcp_abort_on_overflow， tcp_abort_on_overflow修改成 1，1表示第三步的时候如果全连接队列满了，server发送一个reset包给client，表示废掉这个握手过程和这个连接（本来在server端这个连接就还没建立起来）；"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-907ktlr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-907ktlr",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong strong strong",
					"TextMarkTextContent": "PAWS机制丢包"
				}
			]
		},
		{
			"ID": "20230924014419-osz4yin",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-osz4yin",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "原理：PAWS(Protect Against Wrapped Sequence numbers)，高带宽下，TCP序列号可能在较短的时间内就被重复使用(recycle/wrapped)\n就可能导致同一条TCP流在短时间内出现序号一样的两个合法的数据包及其确认包。"
				}
			]
		},
		{
			"ID": "20230924014419-2jrdlcw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2jrdlcw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-qogddmv",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-qogddmv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$netstat -s |grep -e \"passive connections rejected because of time \nstamp\" -e \"packets rejects in established connections because of \ntimestamp” \n387158 passive connections rejected because of time stamp\n825313 packets rejects in established connections because of timestamp\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-wmubj6a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-wmubj6a",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "通过sysctl查看是否启用了tcp_tw_recycle及tcp_timestamp:"
				}
			]
		},
		{
			"ID": "20230924014419-2dmhurx",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-2dmhurx",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "$ sysctl net.ipv4.tcp_tw_recycle\nnet.ipv4.tcp_tw_recycle = 1 \n$ sysctl net.ipv4.tcp_timestamps\nnet.ipv4.tcp_timestamps = 1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-glxc4zk",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-glxc4zk",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-ji1brel",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20230924014418-ji1brel",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-3om2y4d",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-3om2y4d",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "tcp_tw_recycle参数。它用来快速回收TIME_WAIT连接，不过如果在NAT环境下会引发问题;"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-cnfqum8",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20230924014418-cnfqum8",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-kel8uww",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-kel8uww",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "当多个客户端通过NAT方式联网并与服务端交互时，服务端看到的是同一个IP，也就是说对服务端而言这些客户端实际上等同于一个，可惜由于这些客户端的时间戳可能存在差异，于是乎从服务端的视角看，便可能出现时间戳错乱的现象，进而直接导致时间戳小的数据包被丢弃。如果发生了此类问题，具体的表现通常是是客户端明明发送的SYN，但服务端就是不响应ACK。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-z3xhf9a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-z3xhf9a",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-39zu8yu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-39zu8yu",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在NAT环境下，清除tcp时间戳选项，或者不开启tcp_tw_recycle参数；"
				}
			]
		},
		{
			"ID": "20230924014419-oyuzsj0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-oyuzsj0",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "TLP问题丢包"
				}
			]
		},
		{
			"ID": "20230924014419-08hkuqf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-08hkuqf",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "TLP主要是为了解决尾丢包重传效率的问题，TLP能够有效的避免较长的RTO超时，进而提高TCP性能，详细参考文章："
				}
			]
		},
		{
			"ID": "20230924014419-jqvh4ms",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jqvh4ms",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "http://perthcharles.github.io/2015/10/31/wiki-network-tcp-tlp/；"
				}
			]
		},
		{
			"ID": "20230924014419-xaara7m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xaara7m",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "但在低时延场景下（短连接小包量），TLP与延迟ACK组合可能会造成无效重传，导致客户端感发现大量假重传包，加大了响应延迟；"
				}
			]
		},
		{
			"ID": "20230924014419-t9rqn0k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-t9rqn0k",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-tj5cl4b",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tj5cl4b",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看协议栈统计："
				}
			]
		},
		{
			"ID": "20230924014419-9c6h8b6",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-9c6h8b6",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s |grep TCPLossProbes\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-tkbooef",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tkbooef",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看系统配置："
				}
			]
		},
		{
			"ID": "20230924014419-hk6ibim",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-hk6ibim",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": " sysctl -a | grep tcp_early_retrans\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-wjn74kx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-wjn74kx",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-oh3xdbl"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-ojj2wxv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ojj2wxv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-xrwfdkh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-xrwfdkh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.关掉延迟ack，打开快速ack；"
				}
			]
		},
		{
			"ID": "20230924014419-lp02jef",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-lp02jef",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.linux实现nodelay语意不是快速ack，只是关闭nagle算法；"
				}
			]
		},
		{
			"ID": "20230924014419-ijy93eh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ijy93eh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3.打开快速ack选项，socket里面有个 TCP_QUICKACK 选项， 需要每次recv后再设置一次。"
				}
			]
		},
		{
			"ID": "20230924014419-4pyr4fn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-4pyr4fn",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "内存不足导致丢包"
				}
			]
		},
		{
			"ID": "20230924014419-zaejl8a",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-zaejl8a",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-vs3u1eu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-vs3u1eu",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看log："
				}
			]
		},
		{
			"ID": "20230924014419-ussnawv",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-ussnawv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "dmesg|grep “out of memory”\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-li8bkwy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-li8bkwy",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看系统配置："
				}
			]
		},
		{
			"ID": "20230924014419-hoiwkak",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-hoiwkak",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "cat /proc/sys/net/ipv4/tcp_mem\ncat /proc/sys/net/ipv4/tcp_rmem\ncat /proc/sys/net/ipv4/tcp_wmem\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-gc3dplm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-gc3dplm",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-apaia1y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-apaia1y",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "根据TCP业务并发流量，调整系统参数，一般试着增大2倍或者其他倍数来看是否缓解；"
				}
			]
		},
		{
			"ID": "20230924014419-3enor0b",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-3enor0b",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "sysclt -w net.ipv4.tcp_mem=\nsysclt -w net.ipv4.tcp_wmem=\nsysclt -w net.ipv4.tcp_rmem=\nsysctl -p\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-322gn74",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-322gn74",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-reftmfp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-reftmfp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "TCP超时丢包"
				}
			]
		},
		{
			"ID": "20230924014419-n5uglog",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-n5uglog",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-2me55tq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2me55tq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "抓包分析一下网络RTT："
				}
			]
		},
		{
			"ID": "20230924014419-8evchn3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-8evchn3",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-vb5rwc2"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-b9h0ff0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-b9h0ff0",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "用其他工具测试一下当前端到端网络质量（hping等）；"
				}
			]
		},
		{
			"ID": "20230924014419-4dr3q2k",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-4dr3q2k",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "# hping -S 9.199.10.104 -A\nHPING 9.199.10.104 (bond1 9.199.10.104): SA set, 40 headers + 0 data bytes\nlen=46 ip=9.199.10.104 ttl=53 DF id=47617 sport=0 flags=R seq=0 win=0 rtt=38.3 ms\nlen=46 ip=9.199.10.104 ttl=53 DF id=47658 sport=0 flags=R seq=1 win=0 rtt=38.3 ms\nlen=46 ip=9.199.10.104 ttl=53 DF id=47739 sport=0 flags=R seq=2 win=0 rtt=30.4 ms\nlen=46 ip=9.199.10.104 ttl=53 DF id=47842 sport=0 flags=R seq=3 win=0 rtt=30.4 ms\nlen=46 ip=9.199.10.104 ttl=53 DF id=48485 sport=0 flags=R seq=4 win=0 rtt=38.7 ms\nlen=46 ip=9.199.10.104 ttl=53 DF id=49274 sport=0 flags=R seq=5 win=0 rtt=34.1 ms\nlen=46 ip=9.199.10.104 ttl=53 DF id=49491 sport=0 flags=R seq=6 win=0 rtt=30.3 ms\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-9a586w3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-9a586w3",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-s9mhnlj",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-s9mhnlj",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-2eonrnp",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-2eonrnp",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-sim4x9t",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-sim4x9t",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "关闭Nagle算法，减少小包延迟；"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-up6u4zu",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-up6u4zu",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-mzfxxbk",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-mzfxxbk",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "关闭延迟ack:"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-8t8cxlw",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-8t8cxlw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "  sysctl -w net.ipv4.tcp_no_delay_ack=1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-8fentgz",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-8fentgz",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "TCP乱序丢包"
				}
			]
		},
		{
			"ID": "20230924014419-rj830mm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-rj830mm",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "此时TCP会无法判断是数据包丢失还是乱序，因为丢包和乱序都会导致接收端收到次序混乱的数据包，造成接收端的数据空洞。TCP会将这种情况暂定为数据包的乱序，因为乱序是时间问题（可能是数据包的迟到），而丢包则意味着重传。当TCP意识到包出现乱序的情况时，会立即ACK，该ACK的TSER部分包含的TSEV值会记录当前接收端收到有序报文段的时刻。这会使得数据包的RTT样本值增大，进一步导致RTO时间延长。这对TCP来说无疑是有益的，因为TCP有充分的时间判断数据包到底是失序还是丢了来防止不必要的数据重传。当然严重的乱序则会让发送端以为是丢包一旦重复的ACK超过TCP的阈值，便会触发超时重传机制，以及时解决这种问题；详细请参考博客："
				}
			]
		},
		{
			"ID": "20230924014419-vw0cscq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-vw0cscq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "https://blog.csdn.net/dog250/article/details/78692585"
				}
			]
		},
		{
			"ID": "20230924014419-uckekhs",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-uckekhs",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看：抓包分析是否存在很多乱序报文："
				}
			]
		},
		{
			"ID": "20230924014419-5luys69",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-5luys69",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014418-ug44m6z"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-dsg7a4g",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-dsg7a4g",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案：如果在多径传输场景或者网络质量不好，可以通过修改下面值来提供系统对TCP无序传送的容错率："
				}
			]
		},
		{
			"ID": "20230924014419-olp2bgp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-olp2bgp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-xdgmqow"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-60xnr6u",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-60xnr6u",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-d6kan63",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20230924014419-d6kan63",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "拥塞控制丢包"
				}
			]
		},
		{
			"ID": "20230924014419-y4dhkfq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-y4dhkfq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在互联网发展的过程当中，TCP算法也做出了一定改变，先后演进了"
				}
			]
		},
		{
			"ID": "20230924014419-zv1w7gw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-zv1w7gw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Reno、NewReno、Cubic和Vegas，这些改进算法大体可以分为基于丢包和基于延时的拥塞控制算法。基于丢包的拥塞控制算法以Reno、NewReno为代表，它的主要问题有Buffer bloat和长肥管道两种，基于丢包的协议拥塞控制机制是被动式的，其依据网络中的丢包事件来做网络拥塞判断。即使网络中的负载很高，只要没有产生拥塞丢包，协议就不会主动降低自己的发送速度。最初路由器转发出口的Buffer   是比较小的，TCP在利用时容易造成全局同步，降低带宽利用率，随后路由器厂家由于硬件成本下降不断地增加Buffer，基于丢包反馈的协议在不丢包的情况下持续占用路由器buffer，虽然提高了网络带宽的利用率，但同时也意味着发生拥塞丢包后，网络抖动性加大。另外对于带宽和RTT都很高的长肥管道问题来说，管道中随机丢包的可能性很大，TCP的默认buffer设置比较小加上随机丢包造成的cwnd经常下折，导致带宽利用率依旧很低；  BBR（Bottleneck Bandwidth and Round-trip propagation time）是一种基于带宽和延迟反馈的拥塞控制算法。目前已经演化到第二版，是一个典型的封闭反馈系统，发送多少报文和用多快的速度发送这些报文都是在每次反馈中不断调节。在BBR提出之前，拥塞控制都是基于事件的算法，需要通过丢包或延时事件驱动；BBR提出之后，拥塞控制是基于反馈的自主自动控制算法，对于速率的控制是由算法决定，而不由网络事件决定，BBR算法的核心是找到最大带宽（Max  BW）和最小延时（Min RTT）这两个参数，最大带宽和最小延时的乘积可以得到BDP(Bandwidth Delay Product),  而BDP就是网络链路中可以存放数据的最大容量。BDP驱动Probing State Machine得到Rate quantum和cwnd，分别设置到发送引擎中就可以解决发送速度和数据量的问题。"
				}
			]
		},
		{
			"ID": "20230924014419-mvvndko",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-mvvndko",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Linux 4.9内核首次采用BBR拥塞控制算法第一个版本，BBR抗丢包能力比其他算法要强，但这个版本在某些场景下面有问题（缺点），BBR在实时音视频领域存在的问题，深队列竞争不过Cubic。"
				}
			]
		},
		{
			"ID": "20230924014419-u1yj7b7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-u1yj7b7",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "问题现象就是：在深队列场景，BBR的ProbeRTT阶段只发4个包，发送速率下降太多会引发延迟加大和卡顿问题。"
				}
			]
		},
		{
			"ID": "20230924014419-o61meth",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-o61meth",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-x9up4vg",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-x9up4vg",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "ss -sti //在源端 ss -sti|grep 10.125.42.49:47699 -A 3 （ 10.125.42.49:47699 是目的端地址和端口号）\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-3i7q6qt",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-3i7q6qt",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-hr74i5g"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-6jj06kj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-6jj06kj",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-r58b7iv"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-tbkqoyh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-tbkqoyh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-w68zlf3",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-w68zlf3",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-85pacz4",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-85pacz4",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-eydgiy4",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-eydgiy4",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "ProbeRTT并不适用实时音视频领域，因此可以选择直接去除，或者像BBRV2把probe RTT缩短到2.5s一次，使用0.5xBDP发送；"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-z48dsmn",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-z48dsmn",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-ird2k3b",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-ird2k3b",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "如果没有特殊需求，切换成稳定的cubic算法；"
								}
							]
						},
						{
							"ID": "20230924014419-bd2vn0r",
							"Type": "NodeThematicBreak",
							"Properties": {
								"id": "20230924014419-bd2vn0r",
								"updated": "20230924014419"
							}
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-1onluep",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014419-1onluep",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "UDP层丢包"
				}
			]
		},
		{
			"ID": "20230924014419-2mw5k0s",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-2mw5k0s",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "收发包失败丢包"
				}
			]
		},
		{
			"ID": "20230924014419-c7fonlq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-c7fonlq",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看：netstat 统计"
				}
			]
		},
		{
			"ID": "20230924014419-5dmus4y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-5dmus4y",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果有持续的 receive buffer errors/send buffer errors 计数；"
				}
			]
		},
		{
			"ID": "20230924014419-uyqc2gm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-uyqc2gm",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-8ncyyjj"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-wrtd3mh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-wrtd3mh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-1s67cwx",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-1s67cwx",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-ubmw03z",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20230924014418-ubmw03z",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-9ox5qg5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-9ox5qg5",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "CPU负载（多核绑核配置），网络负载（软中断优化，调整驱动队列netdev_max_backlog），内存配置（协议栈内存）；"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-atyucls",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20230924014418-atyucls",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-b3gl2lw",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-b3gl2lw",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "按峰值在来，增大buffer缓存区大小："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-sf7xtcp",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-sf7xtcp",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "net.ipv4.udp_mem = xxx\nnet.ipv4.udp_rmem_min = xxx\nnet.ipv4.udp_wmem_min = xxx\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-7tt9wtm",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-7tt9wtm",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014419-c6xfcpq",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20230924014419-c6xfcpq",
						"updated": "20230924014419"
					},
					"Children": [
						{
							"ID": "20230924014419-9zlljse",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-9zlljse",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "调整应用设计："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-2hrdhqg",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-2hrdhqg",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-mlll8vo",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-mlll8vo",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-p01owfq",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-p01owfq",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "UDP本身就是无连接不可靠的协议，适用于报文偶尔丢失也不影响程序状态的场景，比如视频、音频、游戏、监控等。对报文可靠性要求比较高的应用不要使用 UDP，推荐直接使用 TCP。当然，也可以在应用层做重试、去重保证可靠性"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-vwjk4wb",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-vwjk4wb",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-3i16j95",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-3i16j95",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "如果发现服务器丢包，首先通过监控查看系统负载是否过高，先想办法把负载降低再看丢包问题是否消失"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-psm0952",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-psm0952",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-pfra0qr",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-pfra0qr",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "如果系统负载过高，UDP丢包是没有有效解决方案的。如果是应用异常导致CPU、memory、IO 过高，请及时定位异常应用并修复；如果是资源不够，监控应该能及时发现并快速扩容"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-swunj4w",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-swunj4w",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-4r4woz7",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-4r4woz7",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "对于系统大量接收或者发送UDP报文的，可以通过调节系统和程序的 socket buffer size 来降低丢包的概率"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-c18zw4c",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-c18zw4c",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-hg2tndr",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-hg2tndr",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "应用程序在处理UDP报文时，要采用异步方式，在两次接收报文之间不要有太多的处理逻辑"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-un2s02d",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-un2s02d",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-t6zn9qo",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230924014419-t6zn9qo",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "应用层socket丢包"
				}
			]
		},
		{
			"ID": "20230924014419-jm93dph",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jm93dph",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong strong",
					"TextMarkTextContent": "socket缓存区接收丢包"
				}
			]
		},
		{
			"ID": "20230924014419-molhem4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-molhem4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-zckjbqt",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-zckjbqt",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-a0rmj6y",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20230924014418-a0rmj6y",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-8meysot",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-8meysot",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "抓包分析是否存在丢包情况；"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-62dw9if",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20230924014418-62dw9if",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-inhlfsl",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-inhlfsl",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看统计："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-08ugefh",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-08ugefh",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "netstat -s|grep \"packet receive errors\"\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-qd2cnqa",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-qd2cnqa",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-qt1iul5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-qt1iul5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "调整socket缓冲区大小："
				}
			]
		},
		{
			"ID": "20230924014419-9202ut4",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-9202ut4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "socket配置（所有协议socket）：\n# Default Socket Receive Buffer\nnet.core.rmem_default = 31457280\n# Maximum Socket Receive Buffer\nnet.core.rmem_max = 67108864\n\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-02xo8qb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-02xo8qb",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "具体大小调整原理："
				}
			]
		},
		{
			"ID": "20230924014419-pwzwlkg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-pwzwlkg",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "缓冲区大小没有任何设置值是最佳的，因为最佳大小随具体情况而不同"
				}
			]
		},
		{
			"ID": "20230924014419-5zvmp5d",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-5zvmp5d",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "缓冲区估算原理：在数据通信中，带宽时延乘积（英语：bandwidth-delay product；或称带宽延时乘积、带宽延时积等）指的是一个数据链路的能力（每秒比特）与来回通信延迟（单位秒）的乘积。[1][2]其结果是以比特（或字节）为单位的一个数据总量，等同在任何特定时间该网络线路上的最大数据量——已发送但尚未确认的数据。"
				}
			]
		},
		{
			"ID": "20230924014419-p52j5da",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-p52j5da",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "BDP =  带宽 * RTT"
				}
			]
		},
		{
			"ID": "20230924014419-7hkxj3j",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-7hkxj3j",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "可以通过计算当面节点带宽和统计平均时延来估算BDP，即缓冲区的大小，可以参考下面常见场景估计："
				}
			]
		},
		{
			"ID": "20230924014419-brexey7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-brexey7",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-a2lshd3"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-78kunu5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-78kunu5",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "参考：https://docs.oracle.com/cd/E56344_01/html/E53803/gnkor.html"
				}
			]
		},
		{
			"ID": "20230924014419-b6rxehe",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-b6rxehe",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "应用设置tcp连接数大小丢包"
				}
			]
		},
		{
			"ID": "20230924014419-jl8n5q2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-jl8n5q2",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看："
				}
			]
		},
		{
			"ID": "20230924014419-8mkjfm0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-8mkjfm0",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "请参考上面TCP连接队列分析；"
				}
			]
		},
		{
			"ID": "20230924014419-f1ibhse",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-f1ibhse",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-suit639",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-suit639",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "设置合理的连接队列大小，当第三次握手时，当server接收到ACK  报之后， 会进入一个新的叫 accept 的队列，该队列的长度为 min(backlog,  somaxconn)，默认情况下，somaxconn 的值为 128，表示最多有 129 的 ESTAB 的连接等待 accept()，而  backlog 的值则应该是由 int listen(int sockfd, int backlog) 中的第二个参数指定，listen 里面的  backlog 可以有我们的应用程序去定义的；"
				}
			]
		},
		{
			"ID": "20230924014419-zdiyuw6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-zdiyuw6",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "应用发送太快导致丢包"
				}
			]
		},
		{
			"ID": "20230924014419-b5bfddn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-b5bfddn",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "查看统计："
				}
			]
		},
		{
			"ID": "20230924014419-zejw9b1",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-zejw9b1",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": " netstat -s|grep \"send buffer errors\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-ko3jwby",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-ko3jwby",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "解决方案："
				}
			]
		},
		{
			"ID": "20230924014419-6ixldiw",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-6ixldiw",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-kykzvt1",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-kykzvt1",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-39pabh3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-39pabh3",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "ICMP/UDP没有流控机制，需要应用设计合理发送方式和速度，照顾到底层buff大小和CPU负载以及网络带宽质量；"
								}
							]
						}
					]
				},
				{
					"ID": "20230924014418-d57km29",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-d57km29",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-thh8nc5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-thh8nc5",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "设置合理的sock缓冲区大小："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-rhxjyzk",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-rhxjyzk",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "   setsockopt(s,SOL_SOCKET,SO_SNDBUF,  i(const char*)\u0026nSendBuf,sizeof(int));\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-vgja6go",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230924014419-vgja6go",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-ip38lz0",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230924014418-ip38lz0",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-321cb9a",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-321cb9a",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "调整系统socket缓冲区大小："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-3prk50k",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230924014419-3prk50k",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "   # Default Socket Send Buffer\n   net.core.wmem_default = 31457280\n   # Maximum Socket Send Buffer\n   net.core.wmem_max = 33554432\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230924014419-iezfx8i",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230924014419-iezfx8i",
				"updated": "20230924014419"
			}
		},
		{
			"ID": "20230924014419-vof4d6p",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-vof4d6p",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "附：简单总结一下内核协议栈丢包"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "："
				}
			]
		},
		{
			"ID": "20230924014419-azjwg3m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-azjwg3m",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014418-7o74ugq"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-5yvrb8j",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-5yvrb8j",
				"updated": "20230926110049"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​​"
				}
			]
		},
		{
			"ID": "20230924014419-1byc3rv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-1byc3rv",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "相关工具介绍"
				}
			]
		},
		{
			"ID": "20230924014419-gpqm9ks",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-gpqm9ks",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.dropwatch工具"
				}
			]
		},
		{
			"ID": "20230924014419-gd5t01s",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-gd5t01s",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "原理：  监听 kfree_skb（把网络报文丢弃时会调用该函数）函数或者事件吗，然后打印对应调用堆栈；想要详细了解 linux 系统在执行哪个函数时丢包的话，可以使用 dropwatch 工具，它监听系统丢包信息，并打印出丢包发生的函数："
				}
			]
		},
		{
			"ID": "20230924014419-hg6w44i",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-hg6w44i",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-slw487j"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20230924014419-y2ijol4",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20230924014419-y2ijol4",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"ID": "20230924014418-1ntnq6j",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20230924014418-1ntnq6j",
						"updated": "20230924014418"
					},
					"Children": [
						{
							"ID": "20230924014419-cjdbloh",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-cjdbloh",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "linux perf 工具监听 kfree_skb："
								}
							]
						},
						{
							"ID": "20230924014419-1x2er1z",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230924014419-1x2er1z",
								"updated": "20230924014419"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "sudo perf record -g -a -e skb:kfree_skb\nsudo perf script"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230924014419-oa525rl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20230924014419-oa525rl",
				"updated": "20230924014419"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "图片"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/640-20230924014419-h36uhdj"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20240122161757-nehpj3t",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20240122161757-nehpj3t",
				"updated": "20240122161758"
			},
			"Children": [
				{
					"ID": "20240122161758-u4ehgki",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20240122161758-u4ehgki",
						"updated": "20240122161758"
					},
					"Children": [
						{
							"ID": "20240122161758-tmkhlx0",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122161758-tmkhlx0",
								"updated": "20240122161808"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "tcpdump工具"
								}
							]
						},
						{
							"ID": "20240122161914-bdh7rh8",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122161914-bdh7rh8",
								"updated": "20240122161916"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "原理: tcpdump 是一个Unix下一个功能强大的网络抓包工具，它允许用户拦截和显示发送或收到过网络连接到该计算机的TCP/IP和其他数据包"
								}
							]
						},
						{
							"ID": "20240122161948-01j4fcc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122161948-01j4fcc",
								"updated": "20240122162101"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "​"
								},
								{
									"Type": "NodeImage",
									"Data": "span",
									"Children": [
										{
											"Type": "NodeBang"
										},
										{
											"Type": "NodeOpenBracket"
										},
										{
											"Type": "NodeLinkText",
											"Data": "image"
										},
										{
											"Type": "NodeCloseBracket"
										},
										{
											"Type": "NodeOpenParen"
										},
										{
											"Type": "NodeLinkDest",
											"Data": "assets/image-20240122162101-8vf25oh.png"
										},
										{
											"Type": "NodeCloseParen"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "​"
								}
							]
						},
						{
							"ID": "20240122162136-x9fobx3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162136-x9fobx3",
								"updated": "20240122162137"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "​"
								},
								{
									"Type": "NodeImage",
									"Data": "span",
									"Children": [
										{
											"Type": "NodeBang"
										},
										{
											"Type": "NodeOpenBracket"
										},
										{
											"Type": "NodeLinkText",
											"Data": "image"
										},
										{
											"Type": "NodeCloseBracket"
										},
										{
											"Type": "NodeOpenParen"
										},
										{
											"Type": "NodeLinkDest",
											"Data": "assets/image-20240122162137-cribpnz.png"
										},
										{
											"Type": "NodeCloseParen"
										}
									]
								}
							]
						},
						{
							"ID": "20240122162149-j3sh9r5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162149-j3sh9r5",
								"updated": "20240122162149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "抓包命令参考："
								}
							]
						},
						{
							"ID": "20240122162149-fp8nx3c",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162149-fp8nx3c",
								"updated": "20240122162149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://www.tcpdump.org/manpages/tcpdump.1.html"
								}
							]
						},
						{
							"ID": "20240122162149-1wh46oi",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162149-1wh46oi",
								"updated": "20240122162149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "数据包分析："
								}
							]
						},
						{
							"ID": "20240122162149-725d29z",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162149-725d29z",
								"updated": "20240122162149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "1.用wireshark工具分析  参考：Wireshark数据包分析实战.pdf"
								}
							]
						},
						{
							"ID": "20240122162149-9m60a16",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162149-9m60a16",
								"updated": "20240122162149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "2.可以转化生成CSV数据，用Excel或者shell去分析特定场景报文；"
								}
							]
						},
						{
							"ID": "20240122162149-ghaer87",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162149-ghaer87",
								"updated": "20240122162149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "3.可以在linux上用tshark命令行工具进行分析:"
								}
							]
						},
						{
							"ID": "20240122162149-yh1tmyd",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162149-yh1tmyd",
								"updated": "20240122162149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "https://www.wireshark.org/docs/man-pages/tshark.html"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20240122162157-3zcvfat",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20240122162157-3zcvfat",
				"updated": "20240122162223"
			},
			"Children": [
				{
					"ID": "20240122162200-vndhuiy",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20240122162200-vndhuiy",
						"updated": "20240122162223"
					},
					"Children": [
						{
							"ID": "20240122162200-poiq5de",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162200-poiq5de",
								"updated": "20240122162209"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "报文重放复现"
								}
							]
						},
						{
							"ID": "20240122162223-wmh49w3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162223-wmh49w3",
								"updated": "20240122162223"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "有些时候需要通过报文重放去复现丢包的场景（或者其他问题的场景）"
								}
							]
						},
						{
							"ID": "20240122162223-nxupxxa",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162223-nxupxxa",
								"updated": "20240122162223"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "修改报文为正确地址："
								}
							]
						},
						{
							"ID": "20240122162223-6xuf29v",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162223-6xuf29v",
								"updated": "20240122162223"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "tcpprep --port --pcap=eth1.pcap --cachefile=in.cache"
								}
							]
						},
						{
							"ID": "20240122162223-6vvs398",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162223-6vvs398",
								"updated": "20240122162223"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "tcprewrite --cachefile=in.cache -e 10.53.72.134:9.30.231.31 --enet-dmac=50:6b:4b:b4:9c:e7,88:df:9e:62:4c:4c --infile=eth1.pcap --outfile=out.pcap"
								}
							]
						},
						{
							"ID": "20240122162223-f0w7c8u",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162223-f0w7c8u",
								"updated": "20240122162223"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "重放："
								}
							]
						},
						{
							"ID": "20240122162223-9lzk5cy",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162223-9lzk5cy",
								"updated": "20240122162223"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "tcpreplay -i eth1 -t out.pcap"
								}
							]
						},
						{
							"ID": "20240122162223-2pt2zu9",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162223-2pt2zu9",
								"updated": "20240122162223"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "使用参考：https://linux.die.net/man/1/tcpprep"
								}
							]
						},
						{
							"ID": "20240122162223-0zv0ues",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240122162223-0zv0ues",
								"updated": "20240122162223"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "这个时候方便在测试母机上再进一步分析，对现网影响比较小；"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20240122162315-fuv3f63",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20240122162315-fuv3f63",
				"updated": "20240122162333"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "总结"
				}
			]
		},
		{
			"ID": "20240122162315-3cbwckj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240122162315-3cbwckj",
				"updated": "20240122162315"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "本文只是分析大部分可能会丢包节点，提供了单个节点丢包排查和相关的解决方案, 丢包问题牵扯网络链路各个组件，尤其是在云网络时代，网络拓扑复杂多变，涉及运营商网络，IDC网络，专线等underlay网络，边界网关，VPC网络，CLB负载均衡等云上overlay网络，各种丢包问题排障起来非常复杂且困难，但掌握网络通信基本原理后，可以分解网络拓扑，对通信节点进行逐一排查，也可以找到丢包位置，后续会更加深入介绍云计算时代，云上网络丢包排查方法，网络架构解析等，达到任何丢包问题都可以快速排查和定位解决，帮助客户快速恢复业务，下期再会。"
				}
			]
		}
	]
}