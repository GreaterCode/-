{
	"ID": "20230209151524-p9lr9in",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20230209151524-p9lr9in",
		"title": "EXT3-fs error和EXT4-fs error小总结",
		"updated": "20230602185921"
	},
	"Children": [
		{
			"ID": "20230209151524-kn6n9py",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230209151524-kn6n9py"
			}
		},
		{
			"ID": "20230209151524-ft3ez0j",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230209151524-ft3ez0j"
			},
			"Children": [
				{
					"ID": "20230209151524-7woi74q",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230209151524-7woi74q"
					},
					"Children": [
						{
							"ID": "20230209151524-9xe730c",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230209151524-9xe730c"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://blog.csdn.net/u011436427/article/details/113699010",
									"TextMarkTextContent": "https://blog.csdn.net/u011436427/article/details/113699010"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230209151524-c6xwal2",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20230209151524-c6xwal2"
			}
		},
		{
			"ID": "20230209151524-xcxtc9v",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230209151524-xcxtc9v"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.出现问题时的解决办法"
				}
			]
		},
		{
			"ID": "20230209151524-q894wfx",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230209151524-q894wfx"
			},
			"Children": [
				{
					"ID": "20230209151524-6fj5kt6",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230209151524-6fj5kt6"
					},
					"Children": [
						{
							"ID": "20230209151524-r8nzmit",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230209151524-r8nzmit"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "查看OS的日志/var/log/messages，应该会有相关的报错信息"
								}
							]
						}
					]
				},
				{
					"ID": "20230209151524-bzpdnyx",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230209151524-bzpdnyx"
					},
					"Children": [
						{
							"ID": "20230209151524-2rf8445",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230209151524-2rf8445"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "对于ext3类型的文件系统，可以使用tune2fs 查看"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230209151524-1nau54h",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230209151524-1nau54h",
				"updated": "20230209151608"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "tune2fs -l /dev/sdf|grep stat\nFilesystem state:         clean\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230209151524-43wxdv9",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230209151524-43wxdv9"
			},
			"Children": [
				{
					"ID": "20230209151524-ndsg7bu",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230209151524-ndsg7bu"
					},
					"Children": [
						{
							"ID": "20230209151524-npmn9df",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230209151524-npmn9df"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "使用fsck命令来检测和修复文件系统，FSCK 全称为 File System Consistency Check\n作用：\n它可以进行三种模式的操作，\n查错并在发现错误时由用户决定如何处理，\n查错并自动修复，\n查错但在发现错误时只显示错误而不进行修复。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230209151524-murubql",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230209151524-murubql",
				"updated": "20230209151604"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "手工执行 FSCK 的语法为，\n$ fsck options drives\nfsck 支持的选项有，\n\n-p 自动修复（不询问）\n-n 不对文件系统做出改动\n-y 对所有问题都回答 \"yes\"\n-c 检查所有的坏块并将之添加到坏块列表中\n-f 即使文件系统标记为 clean 也强制进行检查\n-v 输出详细信息\n-b superblock 使用替代的超级块\n-B blocksize 指定超级块的块大小\n-j external_journal 指定外部日志的位置\n-l bad_blocks_file 添加到指定的坏块列表（文件）\n-L bad_blocks_file 指定坏块列表（文件）\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230209151524-qlxmxet",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230209151524-qlxmxet"
			},
			"Children": [
				{
					"ID": "20230209151524-004ft2c",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230209151524-004ft2c"
					},
					"Children": [
						{
							"ID": "20230209151524-ramslo3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230209151524-ramslo3"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Fsck 命令的案例"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230209151524-ap02hk5",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230209151524-ap02hk5",
				"updated": "20230209151558"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "（1）我们不应该用 fsck 检查已挂载的磁盘，这很可能会对磁盘造成永久性的伤害。首先先卸载硬盘\n$ umount drivename\n$ umount/dev/sdb1\n可以通过下面命令来查看分区编号，\n$ fdisk-l\n另外，在运行 fsck 时，可能出错并返回一些错误码。下面是一些常见的错误及其意义的列表，\n0 - 没有错误\n1 - 修复了一些文件系统错误\n2 - 系统需要被重启\n4 - 文件系统错误未被修复\n8 - 操作错\n16 - 使用或语法错\n32 - fsck 被用户取消\n128 - 共享库出错\n\n（2）在单个分区上进行错误检查\n在终端运行下面过命令来对单个分区进行检查，\n$ umount/dev/sdb1\n$ fsck/dev/sdb1\n\n（3）检查文件系统错误并自动修复\n使用选项 -a 进行一致性检查并自动修复这些错误。也可以用 -y 替代 -a 选项。\n$ fsck-a /dev/sdb1\n\n（4）检查文件系统错误但并不进行修复\n若我们只想知道文件系统上有哪些错误而不想修复这些错误，那么可以使用选项 -n，\n$ fsck-n /dev/sdb1\n\n（5）检查所有分区中的错误\n-A 选项一次性检查所有分区上的文件系统错误，\n$ fsck-A\n若要禁止对根文件系统进行检查可以使用选项 -R，\n$ fsck-AR\n\n（6）只检查指定文件系统类型的分区\n使用选项 -t 及文件系统类型，可以让 fsck 只检查指定文件系统类型的分区，比如指定文件系统类型为 “ext4”，\n$ fsck-t ext4 /dev/sdb1\n或者，\n$ fsck-t -A ext4\n\n（7）只在卸载的磁盘上进行一致性检查\n要保证 fsck 只在卸载的磁盘上操作，可以使用选项 -M，\n$ fsck-AM\n\n（8）使用fsck.ext3对文件系统进行扫描、修复\nileserver:~# fsck.ext3  -y /dev/sdb1  ---开始进入扫描、修正文件系统\nfsck -t  ext4 /dev/sda1\n-t参数是指明文件系统是什么。/dev/sda1则是指定分区。\n这个命令还有另外一种输入法，这就是：\nfsck.ext4 /dev/sda1\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230209151524-wcjysxc",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20230209151524-wcjysxc"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2.问题：Read-only filesystem after ‘ext3_free_blocks_sb: bit already cleared for block’ errors"
				}
			]
		},
		{
			"ID": "20230209151524-w0xyqjs",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230209151524-w0xyqjs"
			},
			"Children": [
				{
					"ID": "20230209151524-77zeckk",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230209151524-77zeckk"
					},
					"Children": [
						{
							"ID": "20230209151524-f8d3ek6",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230209151524-f8d3ek6"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://bugzilla.redhat.com/show_bug.cgi?id=494927",
									"TextMarkTextContent": "链接"
								},
								{
									"Type": "NodeText",
									"Data": "，问题："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230209151524-gign088",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230209151524-gign088",
				"updated": "20230209151641"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "EXT3-fs error (device sdh1): ext3_free_blocks_sb: bit already cleared for block 43055512\nAborting journal on device sdh1.\nEXT3-fs error (device sdh1) in ext3_reserve_inode_write: Journal has aborted\nEXT3-fs error (device sdh1) in ext3_truncate: Journal has aborted\nEXT3-fs error (device sdh1) in ext3_reserve_inode_write: Journal has aborted\nEXT3-fs error (device sdh1) in ext3_orphan_del: Journal has aborted\nEXT3-fs error (device sdh1) in ext3_reserve_inode_write: Journal has aborted\nEXT3-fs error (device sdh1) in ext3_delete_inode: Journal has aborted\n__journal_remove_journal_head: freeing b_committed_data\n__journal_remove_journal_head: freeing b_committed_data\n__journal_remove_journal_head: freeing b_committed_data\n__journal_remove_journal_head: freeing b_committed_data\n__journal_remove_journal_head: freeing b_committed_data\n__journal_remove_journal_head: freeing b_committed_data\n__journal_remove_journal_head: freeing b_committed_data\n__journal_remove_journal_head: freeing b_committed_data\n__journal_remove_journal_head: freeing b_committed_data\next3_abort called.\nEXT3-fs error (device sdh1): ext3_journal_start_sb: Detected aborted journal\nRemounting filesystem read-only\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230209151524-hu4n80r",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230209151524-hu4n80r"
			},
			"Children": [
				{
					"ID": "20230209151524-azagl4g",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230209151524-azagl4g"
					},
					"Children": [
						{
							"ID": "20230209151524-z36arcx",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230209151524-z36arcx"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "解决办法："
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230209151524-es6qsfl",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20230209151524-es6qsfl",
				"updated": "20230209151638"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "\n1. Unmounting the file system (/dev/sdc14)\n\n2. Nuke the ext3 journal   \n\ttune2fs -O ^has_journal /dev/sdc14\n\n3. check disk\n        nohup e2fsck -fy -C 0  /dev/sdc14 \u0026\n\n4. Rebuild the journal\n\ttune2fs -j /dev/sdc14\n\n5. Mounting the file system (/dev/sdc14)\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20230209151524-7k1hqpv",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230209151524-7k1hqpv"
			},
			"Children": [
				{
					"ID": "20230209151524-eitfmew",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230209151524-eitfmew"
					},
					"Children": [
						{
							"ID": "20230209151524-8ucjrox",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230209151524-8ucjrox"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "参考："
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://bbs.csdn.net/topics/392080083",
									"TextMarkTextContent": "存储的文件系统EXT4-fs error"
								},
								{
									"Type": "NodeText",
									"Data": "，"
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://blog.csdn.net/fangrn/article/details/83560372",
									"TextMarkTextContent": "解决挂载盘柜出现“EXT3-fs error filesystem read-only”"
								},
								{
									"Type": "NodeText",
									"Data": "，"
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://www.linuxprobe.com/linux-fsck-command.html",
									"TextMarkTextContent": "使用fsck命令检查文件系统错误"
								},
								{
									"Type": "NodeText",
									"Data": "，"
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://blog.csdn.net/hfhhgfv/article/details/83895878",
									"TextMarkTextContent": "linux命令–使用fsck修复文件系统"
								},
								{
									"Type": "NodeText",
									"Data": "，"
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://www.cnblogs.com/sunfie/p/5978901.html",
									"TextMarkTextContent": "Linux学习之fsck命令"
								},
								{
									"Type": "NodeText",
									"Data": "，"
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://bugzilla.redhat.com/show_bug.cgi?id=494927",
									"TextMarkTextContent": "Read-only filesystem after ‘ext3_free_blocks_sb: bit already cleared for block’ errors"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230602185700-15rxj35",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20230602185700-15rxj35",
				"updated": "20230602185723"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3. sdx xfs错误进入紧急模式"
				}
			]
		},
		{
			"ID": "20230602185723-0blhics",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230602185723-0blhics",
				"updated": "20230602185747"
			},
			"Children": [
				{
					"ID": "20230602185741-c9z6u3k",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230602185741-c9z6u3k",
						"updated": "20230602185747"
					},
					"Children": [
						{
							"ID": "20230602185741-5x2ho47",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230602185741-5x2ho47",
								"updated": "20230602185741"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "错误信息"
								}
							]
						},
						{
							"ID": "20230602185742-7vz52hf",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20230602185742-7vz52hf",
								"updated": "20230602185747"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker"
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "XFS (sda3): Metadata corruption detected at xfs_agi_verify+0x148/0x1d0 [xfs]\nXFS (sda3): Unmount and run xfs repair\nXFS (sda3): First 128 bytes of corrupted metadata buffer:\n00000000: 58 41 47 49 00 00 00 01 00 00 00 00 00 6f 91 c0    XAGI....\n00000010:\n00000020:\n00000030:\n00000040:\n00000050:\n00000060:\n00000070: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff\nXFS (sda3): metadata I/O error in \"xfs_read_agi+0x9c/0x160 [xfs]\" at daddr 0x10 len 8 error 117\nXFS (sda3): Unmount and run xfs repair\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20230602185754-jphli51",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20230602185754-jphli51",
				"updated": "20230602185921"
			},
			"Children": [
				{
					"ID": "20230602185755-x2cch0m",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20230602185755-x2cch0m",
						"updated": "20230602185921"
					},
					"Children": [
						{
							"ID": "20230602185755-nrzo62c",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20230602185755-nrzo62c",
								"updated": "20230602185800"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "修复办法"
								}
							]
						},
						{
							"ID": "20230602185801-6donzf8",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20230602185801-6donzf8",
								"updated": "20230602185921"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker"
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "1. xfs_repair /dev/sda3\n 修复成功，reboot\n\n2. 重启后，系统工作一切正常。journalctl -b没有XFS相关的告警。\n\n3. 检查磁盘sda3，没有发现什么问题。\n\tsmartctl -i /dev/sda\n\tsmartctl -H /dev/sda\n\tsmartctl --scan\n\tsmartctl -H /dev/bus/8 -d megaraid,9\n\tsmartctl -H /dev/bus/8 -d megaraid,10\n\tsmartctl -H /dev/bus/8 -d megaraid,11\n\tsmartctl -H /dev/bus/8 -d megaraid,12\n\tsmartctl -H /dev/bus/8 -d megaraid,13\n\tsmartctl -H /dev/bus/8 -d megaraid,14\n\tsmartctl -H /dev/bus/8 -d megaraid,15\n\tsmartctl -H /dev/bus/8 -d megaraid,16\n\tsmartctl -H /dev/bus/8 -d megaraid,17\n\tsmartctl -H /dev/bus/8 -d megaraid,18\n\tsmartctl -H /dev/bus/8 -d megaraid,19\n\tsmartctl -H /dev/bus/8 -d megaraid,20\n\n4. ipmictl sel list没有什么异常。\n\n\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				}
			]
		}
	]
}